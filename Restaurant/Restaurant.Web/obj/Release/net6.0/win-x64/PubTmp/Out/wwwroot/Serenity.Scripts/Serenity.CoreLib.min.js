var __extends,__assign,__rest,__decorate,__param,__metadata,__awaiter,__generator,__exportStar,__values,__read,__spread,__spreadArrays,__spreadArray,__await,__asyncGenerator,__asyncDelegator,__asyncValues,__makeTemplateObject,__importStar,__importDefault,__classPrivateFieldGet,__classPrivateFieldSet,__classPrivateFieldIn,__createBinding;!function(t){var e="object"==typeof global?global:"object"==typeof self?self:"object"==typeof this?this:{};function n(t,n){return t!==e&&("function"==typeof Object.create?Object.defineProperty(t,"__esModule",{value:!0}):t.__esModule=!0),function(e,i){return t[e]=n?n(e,i):i}}"function"==typeof define&&define.amd?define("tslib",["exports"],(function(i){t(n(e,n(i)))})):"object"==typeof module&&"object"==typeof module.exports?t(n(e,n(module.exports))):t(n(e))}((function(t){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}
;__extends=function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)},__assign=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},__rest=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n},__decorate=function(t,e,n,i){var r,o=arguments.length,a=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i
;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,i);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(a=(o<3?r(a):o>3?r(e,n,a):r(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},__param=function(t,e){return function(n,i){e(n,i,t)}},__metadata=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__awaiter=function(t,e,n,i){return new(n||(n=Promise))((function(r,o){function a(t){try{s(i.next(t))}catch(t){o(t)}}function l(t){try{s(i.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,l)}s((i=i.apply(t,e||[])).next())}))},__generator=function(t,e){var n,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(l){return function(s){return function(l){
if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(a=0)),a;)try{if(n=1,i&&(r=2&l[0]?i.return:l[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,l[1])).done)return r;switch(i=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,i=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(!(r=a.trys,(r=r.length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){a=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){a.label=l[1];break}if(6===l[0]&&a.label<r[1]){a.label=r[1],r=l;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(l);break}r[2]&&a.ops.pop(),a.trys.pop();continue}l=e.call(t,a)}catch(t){l=[6,t],i=0}finally{n=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},__exportStar=function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||__createBinding(e,t,n)},__createBinding=Object.create?function(t,e,n,i){void 0===i&&(i=n)
;var r=Object.getOwnPropertyDescriptor(e,n);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,r)}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]},__values=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return a},__spread=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(__read(arguments[e]));return t},__spreadArrays=function(){
for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,l=o.length;a<l;a++,r++)i[r]=o[a];return i},__spreadArray=function(t,e,n){if(n||2===arguments.length)for(var i,r=0,o=e.length;r<o;r++)!i&&r in e||(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))},__await=function(t){return this instanceof __await?(this.v=t,this):new __await(t)},__asyncGenerator=function(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(t,e||[]),o=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(t){r[t]&&(i[t]=function(e){return new Promise((function(n,i){o.push([t,e,n,i])>1||l(t,e)}))})}function l(t,e){try{(n=r[t](e)).value instanceof __await?Promise.resolve(n.value.v).then(s,u):c(o[0][2],n)}catch(t){c(o[0][3],t)}var n}function s(t){l("next",t)}function u(t){l("throw",t)}
function c(t,e){t(e),o.shift(),o.length&&l(o[0][0],o[0][1])}},__asyncDelegator=function(t){var e,n;return e={},i("next"),i("throw",(function(t){throw t})),i("return"),e[Symbol.iterator]=function(){return this},e;function i(i,r){e[i]=t[i]?function(e){return(n=!n)?{value:__await(t[i](e)),done:"return"===i}:r?r(e):e}:r}},__asyncValues=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(n){e[n]=t[n]&&function(e){return new Promise((function(i,r){(function(t,e,n,i){Promise.resolve(i).then((function(e){t({value:e,done:n})}),e)})(i,r,(e=t[n](e)).done,e.value)}))}}},__makeTemplateObject=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t};var n=Object.create?function(t,e){
Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};__importStar=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)"default"!==i&&Object.prototype.hasOwnProperty.call(t,i)&&__createBinding(e,t,i);return n(e,t),e},__importDefault=function(t){return t&&t.__esModule?t:{default:t}},__classPrivateFieldGet=function(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)},__classPrivateFieldSet=function(t,e,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it")
;return"a"===i?r.call(t,n):r?r.value=n:e.set(t,n),n},__classPrivateFieldIn=function(t,e){if(null===e||"object"!=typeof e&&"function"!=typeof e)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof t?e===t:t.has(e)},t("__extends",__extends),t("__assign",__assign),t("__rest",__rest),t("__decorate",__decorate),t("__param",__param),t("__metadata",__metadata),t("__awaiter",__awaiter),t("__generator",__generator),t("__exportStar",__exportStar),t("__createBinding",__createBinding),t("__values",__values),t("__read",__read),t("__spread",__spread),t("__spreadArrays",__spreadArrays),t("__spreadArray",__spreadArray),t("__await",__await),t("__asyncGenerator",__asyncGenerator),t("__asyncDelegator",__asyncDelegator),t("__asyncValues",__asyncValues),t("__makeTemplateObject",__makeTemplateObject),t("__importStar",__importStar),t("__importDefault",__importDefault),t("__classPrivateFieldGet",__classPrivateFieldGet),t("__classPrivateFieldSet",__classPrivateFieldSet),
t("__classPrivateFieldIn",__classPrivateFieldIn)})),function(t,e,n){"use strict";function i(t,e){return t.some(e)}function r(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return n;return-1}var o=Array.isArray;function a(t,e){for(var n,i={},r=0,o=t;r<o.length;r++){var a=o[r],l=null!==(n=e(a))&&void 0!==n?n:"",s=i[l];s||(s=i[l]=[]),s.push(a)}return i}function l(t,e){for(var n=0,i=t;n<i.length;n++){var r=i[n];if(e(r))return r}}function u(t){return null!=t}var c=function(){var t=new Date;return new Date(t.getFullYear(),t.getMonth(),t.getDate())};function d(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}function p(t,n,i){if(null!=n||null!=i)return d(d(p(t||{}),p(n||{})),p(i||{}));var r=t,o={}.toString.call(t).slice(8,-1);if("Set"==o)return new Set(e.__spreadArray([],t,!0).map((function(t){return p(t)})));if("Map"==o)return new Map(e.__spreadArray([],t,!0).map((function(t){return[p(t[0]),p(t[1])]})));if("Date"==o)return new Date(t.getTime())
;if("RegExp"==o)return RegExp(t.source,function(t){if("string"==typeof t.source.flags)return t.source.flags;var e=[];return t.global&&e.push("g"),t.ignoreCase&&e.push("i"),t.multiline&&e.push("m"),t.sticky&&e.push("y"),t.unicode&&e.push("u"),e.join("")}(t));if("Array"==o||"Object"==o)for(var a in r=Array.isArray(t)?[]:{},t)r[a]=p(t[a]);return r}function h(){return B("__types")}function f(t,e){for(var n=e.split("."),i=0;i<n.length;i++)if(null==(t=t[n[i]]))return null;return t}var g,v="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||"undefined"!=typeof global&&global||function(){return this}()||Function("return this")();function y(){return v}function m(t,e){var n,i=h();if(null==e){if(null!=(n=i[t])||null==v||"Object"===t)return n;e=v}return"function"!=typeof(n=f(e,t))?null:n}function _(t){return Object.prototype.hasOwnProperty.call(t,"__typeName")&&t.__typeName||void 0}function b(t,e){Object.defineProperty(t,"__typeName",{
value:e,configurable:!0})}function C(t){return _(t)||t.name||(t.toString().match(/^\s*function\s*([^\s(]+)/)||[])[1]||"Object"}function w(t){var e=C(t),n=e.indexOf("["),i=e.lastIndexOf(".",n>=0?n:e.length);return i>0?e.substr(i+1):e}function S(t){if(null==t)throw new it("instance","Can't get instance type of null or undefined!");try{return t.constructor}catch(t){return Object}}function k(t,e){return t===e||e.prototype instanceof t||"function"==typeof t.__isAssignableFrom&&t.__isAssignableFrom(e)}function x(t,e){return null!=t&&("function"==typeof e.__isInstanceOfType?e.__isInstanceOfType(t):k(e,S(t)))}function I(t,e){return x(t,e)?t:null}function T(t,e){if(null==t)return t;if(x(t,e))return t;throw new rt("Cannot cast object to type "+C(e))}function D(t){if(t!==Object&&t.prototype&&!0!==t.__interface){if(Object.getPrototypeOf)return Object.getPrototypeOf(t.prototype).constructor;var e=t.prototype;if(Object.prototype.hasOwnProperty.call(e,"constructor"))try{var n=e.constructor
;return delete e.constructor,e.constructor}finally{e.constructor=n}return e.constructor}return null}function F(t,e,n){var i,r=[];if(n){var o=D(t);if(o)for(var a=F(o,e,!0),l=0;l<a.length;l++){var s=S(a[l]);r.push(a[l])}}var u=null===(i=t.__metadata)||void 0===i?void 0:i.attr;if(null!=u)for(l=0;l<u.length;l++){a=u[l];if(null==e||x(a,e)){s=S(a);for(var c=r.length-1;c>=0;c--)x(r[c],s)&&r.splice(c,1);r.push(a)}}return r}function P(t,e){var n,i=[],r=D(t);r&&(i=P(r,-2&e));var o=null===(n=t.__metadata)||void 0===n?void 0:n.members;if(null!=o)for(var a=0,l=o;a<l.length;a++){var s=l[a];e&s.type&&i.push(s)}return i}function O(t,e){var n,i=e.name,r=G(t);r.members=r.members||[];for(var o=0,a=r.members;o<a.length;o++){var l=a[o];if(l.name==i){n=l;break}}return n?(null!=e.type&&(n.type=e.type),null!=e.attr&&(n.attr=j(n.attr,e.attr)),null!=e.getter&&(n.getter=e.getter),null!=e.setter&&(n.setter=e.setter),n):(r.members.push(e),e)}function E(t){var e=h(),n=[];if(t){var i=function(t,e){
for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&i(t[r],r);"function"==typeof t&&e.charAt(0).toUpperCase()===e.charAt(0)&&e.charAt(0).toLowerCase()!==e.charAt(0)&&n.push(t)};i(t,"")}else for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.push(e[r]);return n}function A(t){for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&delete t[e]}function N(t,e){if(!t)return e._targets,e;if(!e)return t._targets,t;var n=t._targets?t._targets:[null,t],i=e._targets?e._targets:[null,e];return V(n.concat(i))}t.MemberType=void 0,(g=t.MemberType||(t.MemberType={}))[g.field=4]="field",g[g.property=16]="property";var M,R={};function B(t){var e;if(v?(v.Q||(v.Q={}),(e=v.Q.__stateStore)||(v.Q.__stateStore=e=Object.create(null))):e=R,null==t)return e;var n=e[t];return null==n&&(e[t]=n=Object.create(null)),n}function L(t,e,n){for(var i=0;i<t.length;i+=2)if(t[i]===e&&t[i+1]===n)return!0;return!1}t.Enum=void 0,(M=t.Enum||(t.Enum={})).toString=function(t,e){var n,i=t
;if(0!==e&&(null===(n=t.__metadata)||void 0===n?void 0:n.enumFlags)){var r=[];for(var o in i)i[o]&e?r.push(o):r.push(null==e?"":e.toString());return r.join(" | ")}for(var o in i)if(i[o]===e)return o;return null==e?"":e.toString()},M.getValues=function(t){var e=[],n=t;for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&"number"==typeof n[i]&&e.push(n[i]);return e};var V=function(t){var e=function(){if(2===t.length)return t[1].apply(t[0],arguments);for(var e=t.slice(),n=0;n<e.length;n+=2)L(t,e[n],e[n+1])&&e[n+1].apply(e[n],arguments);return null};return e._targets=t,e},q=function(t,e){if(!t||t===e)return null;if(!e)return t;var n,i=t._targets,r=null;e._targets?(r=e._targets[0],n=e._targets[1]):n=e;for(var o=0;o<i.length;o+=2)if(i[o]===r&&i[o+1]===n){if(2===i.length)return null;var a=i.slice();return a.splice(o,2),V(a)}return t},H=function(t){return"function"!=typeof t&&null===t.__interface};function G(t){
return Object.prototype.hasOwnProperty.call(t,"__metadata")&&t.__metadata||(t.__metadata=Object.create(null)),t.__metadata}var z=new Proxy({},{get:function(t,e){return e}});function j(t,e){return t&&e?(n=t.concat(e)).filter((function(t,e){return n.indexOf(t)===e})):(t||e||[]).slice();var n}function U(t){var e=this;return null!=t&&Array.isArray(t.__interfaces)&&t.__interfaces.some((function(t){var n;return t===e||(null===(n=_(e))||void 0===n?void 0:n.length)&&t.__interface&&_(t)===e.__typeName}))}function W(t,e,n){var i,r=h();e&&e.length?(b(t,e),r[e]=t):(null===(i=_(t))||void 0===i?void 0:i.length)&&(r[t.__typeName]=t),null!=n&&n.length&&Object.defineProperty(t,"__interfaces",{value:j(t.__interfaces,n),configurable:!0})}function K(t,e,n){W(t,e,n),Object.defineProperty(t,"__interface",{value:!1,configurable:!0})}function Q(t,e,n){K(t,e,n),X(t,new tt)}function Y(t,e,n){if(W(t,e,void 0),n&&n!=e){var i=h();i[n]||(i[n]=t)}Object.defineProperty(t,"__interface",{value:null,configurable:!0})}
function J(t,e,n){W(t,e,n),Object.defineProperty(t,"__interface",{value:!0,configurable:!0}),Object.defineProperty(t,"__isAssignableFrom",{value:U,configurable:!0})}function X(t,e){var n=G(t);n.attr=n.attr||[],n.attr.push(e)}var Z=function(){};J(Z,"Serenity.ISlickFormatter");var tt=function(){};function et(t,e,n){var i;if(t)for(var r=h(),o=0,a=Object.keys(t);o<a.length;o++){var l=a[o];if(!(l.charAt(0)<"A"||l.charAt(0)>"Z"||l.indexOf("$")>=0)&&Object.prototype.hasOwnProperty.call(t,l)){var s=t[l];null==s||Array.isArray(s)||s instanceof Date||"function"!=typeof s&&"object"!=typeof s||(!_(s)&&("function"==typeof s&&"number"!=typeof s.nodeType||Object.prototype.hasOwnProperty.call(s,"__interface")&&void 0!==s.__interface)&&("function"==typeof s&&!s.__interfaces&&(null===(i=s.prototype)||void 0===i?void 0:i.format)&&"Formatter"===l.substr(-9)&&(void 0===s.__interface&&Object.defineProperty(s,"__interface",{value:!1,configurable:!0}),s.__interfaces=[Z]),void 0!==s.__interface&&(b(s,e+l),
r[e+l]=s)),n>0&&et(s,e+l+".",n-1))}}}K(tt,"Serenity.EditorAttribute");var nt=function(t){function n(e){var n=t.call(this,e)||this;return n.name="Exception",n}return e.__extends(n,t),n}(Error),it=function(t){function n(e,n){var i=t.call(this,(n||"Value cannot be null.")+"\nParameter name: "+e)||this;return i.name="ArgumentNullException",i}return e.__extends(n,t),n}(nt),rt=function(t){function n(e){var n=t.call(this,e)||this;return n.name="InvalidCastException",n}return e.__extends(n,t),n}(nt);function ot(t,e){return t.endsWith(e)}function at(t){return null==t||0===t.length}function lt(t){return null==ht(t)}function st(t,e,n){if(void 0===n&&(n=" "),(t=null==t?"":t.toString()).padStart)return t.padStart(e,n);for(;t.length<e;)t=n+t;return t}function ut(t,e){return t.startsWith(e)}var ct=function(t){var e,n,i;return null!==(i=null===(n=(e=null!=t?t:"").trimEnd)||void 0===n?void 0:n.call(e))&&void 0!==i?i:t.replace(/\s*$/,"")};function dt(t){var e
;return null!==(e=null==t?void 0:t.trim())&&void 0!==e?e:""}function pt(t){return(null!=t?t:"").trim()}function ht(t){return null==t||0===(t=dt(t)).length?null:t}function ft(t,e,n){var i,r,o;return null!==(o=null===(r=(i=t=t||"").replaceAll)||void 0===r?void 0:r.call(i,e,n))&&void 0!==o?o:t.split(e).join(n)}function gt(t,e){if(null==t)return"";for(var n=t.toString();n.length<e;)n="0"+n;return n}function vt(t){var e=mt()[t];return null==e&&(e=null!=t?t:""),e}var yt=vt;function mt(){return B("__localText")}function _t(t){return mt()[t]}var bt,Ct=function(){function t(t){this.key=t}return t.add=function(e,n){if(e){var i=mt();if("string"!=typeof e){n=n||"";for(var r=0,o=Object.keys(e);r<o.length;r++){var a=o[r],l=n+a,s=e[a];"object"==typeof s?t.add(s,l+"."):i[l]=s}}else i[e]=n}},t.prototype.get=function(){var t=mt()[this.key];return null==t&&(t=this.key||""),t},t.prototype.toString=function(){var t=mt()[this.key];return null==t&&(t=this.key||""),t},t.empty=new t(""),
t.initializeTextClass=function(e,n){for(var i=Object.keys(e).slice(),r=mt(),o=0;o<i.length;o++){var a=i[o],l=e[a];if(l instanceof t){var s=l,u=n+a;r[u]=s.key,e[a]=new t(u)}}},t.getDefault=function(t,e){var n=mt()[t];return null==n&&null==(n=e)&&(n=t||""),n},t}();if("undefined"!=typeof globalThis){var wt=globalThis.Q||(globalThis.Q={});null==wt.LT&&(wt.LT=Ct)}var St="function"==typeof jQuery?jQuery:"function"==typeof globalThis.$?globalThis.$:"undefined"!=typeof window?null!==(bt=window.jQuery)&&void 0!==bt?bt:window.$:void 0;function kt(t,e,n){St("<option/>").attr("value",null!=e?e:"").text(null!=n?n:"").appendTo(t)}var xt=Ft;function It(t,e,n){var i,r=t instanceof St&&null!=t,o=r?t.get(0):t,a="undefined"==typeof document?null:document;if(null==o)return null;var l=!1;void 0===n&&(n=o.getRootNode(),l=!0);for(var s=null!==(i=o.id)&&void 0!==i?i:"";;){var u=null==n?void 0:n.querySelector("#"+s+e);if(!u&&l&&(u=null==a?void 0:a.getElementById(s+e)),
!u&&s.length&&!(u=null==n?void 0:n.querySelector("#"+s+"_"+e))&&l&&(u=null==a?void 0:a.getElementById(s+"_"+e)),u||!s.length)return r?St(null!=u?u:null):null!=u?u:null;var c=s.lastIndexOf("_");s=c<=0?"":s.substring(0,c)}}var Tt={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","&":"&amp;"};function Dt(t){return Tt[t]}function Ft(t){return null==t?"":("string"!=typeof t&&(t=""+t),t.replace(/[<>"'&]/g,Dt))}function Pt(){return St("<div/>").appendTo(document.body)}function Ot(t,e,n){if(null!=e&&e.length)if(e.indexOf(" ")<0)t.classList.toggle(e,n);else for(var i=0,r=e.split(" ").map((function(t){return t.trim()})).filter((function(t){return t.length}));i<r.length;i++){var o=r[i];t.classList.toggle(o,n)}}var Et={tapToDismiss:!0,toastClass:"toast",containerId:"toast-container",showDuration:300,onShown:function(){},hideDuration:1e3,onHidden:function(){},closeMethod:!1,closeDuration:!1,closeEasing:!1,closeOnHover:!0,extendedTimeOut:1e3,iconClass:"toast-info",positionClass:"toast-top-right",
timeOut:5e3,titleClass:"toast-title",messageClass:"toast-message",escapeHtml:!0,target:"body",closeHtml:'<button type="button">&times;</button>',closeClass:"toast-close-button",newestOnTop:!0,preventDuplicates:!1,rtl:!1,onCloseClick:function(){},closeButton:!1,onclick:function(){}},At=null,Nt=function(){function t(t){var e;this.toastId=0,this.previousToast=null,this.options=Object.assign(Object.assign({},null!==(e=null==At?void 0:At.options)&&void 0!==e?e:Et),t),this.createContainer(t)}return t.prototype.createContainer=function(t){void 0===t&&(t=this.options);var e=document.createElement("div");e.setAttribute("id",t.containerId),t.positionClass&&Ot(e,t.positionClass,!0);var n=document.getElementsByTagName(t.target);return n&&n[0]&&n[0].appendChild(e),e},t.prototype.getContainer=function(t,e){var n;void 0===e&&(e=!1);var i=document.getElementById(null!==(n=null==t?void 0:t.containerId)&&void 0!==n?n:this.options.containerId)
;return i||(e?this.createContainer(null!=t?t:this.options):null)},t.prototype.error=function(t,e,n){return this.notify({type:"error",iconClass:"toast-error",message:t,title:e},n)},t.prototype.warning=function(t,e,n){return this.notify({type:"warning",iconClass:"toast-warning",message:t,title:e},n)},t.prototype.success=function(t,e,n){return this.notify({type:"success",iconClass:"toast-success",message:t,title:e},n)},t.prototype.info=function(t,e,n){return this.notify({type:"info",iconClass:"toast-info",message:t,title:e},n)},t.prototype.subscribe=function(t){this.listener=t},t.prototype.publish=function(t){this.listener&&this.listener(t)},t.prototype.clear=function(t,e){void 0===e&&(e={}),this.clearToast(t,this.options,e)||this.clearContainer(this.options)},t.prototype.remove=function(t){var e=this.getContainer(this.options);if(e)if(t&&t!==document.activeElement)this.removeToast(t);else if(!e.hasChildNodes()){var n=e.parentElement;n&&n.removeChild(e)}},
t.prototype.removeToast=function(t,e){void 0===e&&(e=this.options);var n=this.getContainer(e);n&&t.parentNode&&(t.parentNode.removeChild(t),t.offsetWidth>0&&t.offsetHeight>0||n.hasChildNodes()||(n.parentNode&&n.parentNode.removeChild(n),this.previousToast=null))},t.prototype.clearContainer=function(t){void 0===t&&(t=this.options);var e=this.getContainer(t);if(e)for(var n=Array.from(e.childNodes),i=n.length-1;i>=0;i-=1)this.clearToast(n[i])},t.prototype.clearToast=function(t,e,n){if(void 0===n&&(n={}),!t)return!1;var i=n.force||!1;return!(!t||!i&&t===document.activeElement)&&(this.removeToast(t,e),!0)},t.prototype.notify=function(t,e){var n=this;if(function(t,e){if(t.preventDuplicates){if(e.message===n.previousToast)return!0;n.previousToast=e.message||""}return!1}(e=Object.assign(Object.assign(Object.assign({},this.options),t),e),t))return null;this.toastId+=1
;var i=this.getContainer(e,!0),r=null,o=document.createElement("div"),a=document.createElement("div"),l=document.createElement("div"),s=document.createElement("div");s.innerHTML=e.closeHtml.trim();var u=s.firstChild,c={toastId:this.toastId,state:"visible",startTime:new Date,endTime:void 0,opt:e,map:t},d=function(t){void 0===t&&(t=null),(o!==document.activeElement||t)&&(n.removeToast(o),r&&clearTimeout(r),e.onHidden&&"hidden"!==c.state&&e.onHidden(),c.state="hidden",c.endTime=new Date,n.publish(c))};return o.classList.add("show"),e.rtl&&o.classList.add("rtl"),e.toastClass&&Ot(o,e.toastClass,!0),e.iconClass&&Ot(o,e.iconClass,!0),function(){if(t.title){var n=t.title;e.escapeHtml&&(n=Ft(t.title)),a.innerHTML=n,Ot(a,e.titleClass,!0),o.appendChild(a)}}(),function(){if(t.message){var n=t.message;e.escapeHtml&&(n=Ft(t.message)),l.innerHTML=n,Ot(l,e.messageClass,!0),o.appendChild(l)}}(),e.closeButton&&u&&(Ot(u,e.closeClass,!0),u.setAttribute("role","button"),o.insertBefore(u,o.firstChild)),
e.newestOnTop?i.insertBefore(o,i.firstChild):i.appendChild(o),function(){var t="";switch(e.iconClass){case"toast-success":case"toast-info":t="polite";break;default:t="assertive"}o.setAttribute("aria-live",t)}(),e.onShown&&e.onShown(),e.timeOut>0&&(r=setTimeout(d,e.timeOut)),e.closeOnHover&&(o.addEventListener("mouseover",(function(){r&&clearTimeout(r)})),o.addEventListener("mouseout",(function(){(e.timeOut>0||e.extendedTimeOut>0)&&(r=setTimeout(d,e.extendedTimeOut))}))),!e.onclick&&e.tapToDismiss&&o.addEventListener("click",d),e.closeButton&&u&&u.addEventListener("click",(function(t){t.stopPropagation(),e.onCloseClick&&e.onCloseClick(t),d(!0)})),e.onclick&&o.addEventListener("click",(function(t){e.onclick&&e.onclick(t),d()})),this.publish(c),o},t}(),Mt=At=new Nt;void 0!==Mt&&Mt.options&&(Mt.options.escapeHtml=!0);var Rt={timeOut:3e3,showDuration:250,hideDuration:500,escapeHtml:!0,extendedTimeOut:500,positionClass:"position-toast toast-top-full-width"};function Bt(t){
return Ht(!0,t=d(d({},Rt),t)),t}function Lt(t,e,n,i){if(void 0===Mt||"function"!=typeof Mt[t])if("undefined"!=typeof document&&document.body){var r=document.getElementById("toast-container");if(!r){(r=document.createElement("div")).id="toast-container",r.className="toast-container top-0 end-0 p-3",document.body.append(r);var o=document.createElement("div");o.className="toast",o.role="alert",o.ariaLive="assertive",o.ariaAtomic="true",o.innerHTML='<div class="toast-header bg-'.concat(Ft(t)," text-").concat(Ft(t),'">\n          <strong class="me-auto">').concat(Ft(n),'</strong>\n          <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="').concat(Ft(vt("Dialogs.CloseButton")),'"></button>\n        </div>\n        <div class="toast-body">\n        ').concat(Ft(e),"\n        </div>\n      </div>"),r.appendChild(o),"undefined"==typeof bootstrap&&(o.querySelector(".btn-close").addEventListener("click",(function(){this.remove()})),setTimeout((function(){this.remove()
}),1e4))}}else console.error("no document found! can't show toast: ".concat(t," - ").concat(n,": ").concat(e));else Mt[t](e,n,Bt(i))}function $t(t,e,n){Lt("warning",t,e,Bt(n))}function Vt(t,e,n){Lt("success",t,e,Bt(n))}function qt(t,e,n){Lt("error",t,e,Bt(n))}function Ht(t,e){if(void 0!==Mt){var n=Mt.getContainer(e,t);if(n&&n.classList.contains("position-toast")){var i="undefined"!=typeof $?$(window.document.body).children(".ui-dialog:visible, .modal.in, .modal.show").last():[];if(i.length>0){var r=i.position();n.classList.add("positioned-toast"),n.style.position="absolute",n.style.top=r.top+28+"px",n.style.left=r.left+6+"px",n.style.width=i.width()-12+"px"}else n.classList.contains("positioned-toast")&&(n.classList.remove("positioned-toast"),n.style.position="",n.style.top="",n.style.left="",n.style.width="")}}}var Gt={applicationPath:"/",emailAllowOnlyAscii:!0,responsiveDialogs:!0,bootstrapMessages:!1,rootNamespaces:["Serenity"],notLoggedInHandler:null}
;if("undefined"!=typeof document){var zt=document.querySelector("link#ApplicationPath");null!=zt&&(Gt.applicationPath=zt.getAttribute("href"))}var jt,Ut,Wt,Kt,Qt,Yt="undefined"!=typeof bootstrap?bootstrap:void 0;function Jt(t){return t?ut(t,"fa-")?"fa "+t:ut(t,"glyphicon-")?"glyphicon "+t:t:null}function Xt(t,e,n){var i=d({modal:!0,width:"40%",maxWidth:450,minWidth:180,resizable:!1,open:function(){t.onOpen&&t.onOpen.call(this)},close:function(){var e,n;null===(n=(e=St(this)).dialog)||void 0===n||n.call(e,"destroy"),t.onClose&&t.onClose.call(this,t.result)}},t);return i.dialogClass="s-MessageDialog"+(n?" "+n:""),t.buttons&&(i.buttons=t.buttons.map((function(e){var n=ae(e);return n.click=function(n){t.result=e.result,St(this).dialog("close"),e.click&&e.click.call(this,n)},n}))),St("<div>"+e+"</div>").dialog(i)}function Zt(){var t,e,n
;return null!=Kt?Kt:Kt=!(void 0===St||!(null===(n=null===(e=null===(t=null==St?void 0:St.fn)||void 0===t?void 0:t.modal)||void 0===e?void 0:e.Constructor)||void 0===n?void 0:n.VERSION)||"3"!=(St.fn.modal.Constructor.VERSION+"").charAt(0))}function te(){return null!=Qt?Qt:Qt=!(void 0===Yt||Yt.Modal&&Yt.Modal.VERSION&&"4"==(!Yt.Modal.VERSION+"").charAt(0))}void 0!==St&&(null===(Ut=null===(jt=St.fn)||void 0===jt?void 0:jt.button)||void 0===Ut?void 0:Ut.noConflict)&&(null===(Wt=St.ui)||void 0===Wt?void 0:Wt.button)&&(St.fn.btn=St.fn.button.noConflict());var ee,ne={AlertTitle:"Alert",InformationTitle:"Information",WarningTitle:"Warning",ConfirmationTitle:"Confirm",OkButton:"OK",YesButton:"Yes",NoButton:"No",CancelButton:"Cancel",CloseButton:"Close"};function ie(t){var e;return Ft(null!==(e=_t("Dialogs."+t))&&void 0!==e?e:ne[t])}function re(t,e,n,i){void 0===i&&(i=!0)
;var r='<button type="button" class="'.concat(te()?"btn-":"",'close" data-').concat(te()?"bs-":"",'dismiss="modal" aria-label="').concat(ie("CloseButton"),'">')+"".concat(te()?"":'<span aria-hidden="true">&times;</span>',"</button>"),o=document.createElement("div");return o.classList.add("modal"),(null==n?void 0:n.length)&&Ot(o,n,!0),o.setAttribute("tabindex","-1"),o.setAttribute("role","dialog"),o.innerHTML='<div class="modal-dialog" role="document">\n    <div class="modal-content">\n        <div class="modal-header">\n            '.concat(Zt()?r:"",'<h5 class="modal-title">').concat(Ft(t),"</h5>").concat(Zt()?"":r,'\n        </div>\n        <div class="modal-body">').concat(i?Ft(e):e,'</div>\n        <div class="modal-footer"></div>\n    </div>\n</div>'),o}function oe(t){var e,n,i=null==t.htmlEncode||t.htmlEncode?Ft(t.text):t.text,r=Jt(t.icon);(null==r?void 0:r.length)&&(i='<i class="'+Ft(r)+'"><i>'+(i?" "+i:""));var o=document.createElement("button");return o.classList.add("btn"),
(null===(e=t.cssClass)||void 0===e?void 0:e.length)&&Ot(o,t.cssClass,!0),(null===(n=t.hint)||void 0===n?void 0:n.length)&&o.setAttribute("title",t.hint),o.innerHTML=i,o}function ae(t){var e,n=null==t.htmlEncode||t.htmlEncode?Ft(t.text):t.text,i=Jt(t.icon);(null==i?void 0:i.length)&&(n='<i class="'+Ft(i)+'"></i>'+(n?" "+n:""));var r={text:n,click:t.click};return(null===(e=t.cssClass)||void 0===e?void 0:e.length)&&(r.cssClass=t.cssClass),r}function le(t,e,n){var i=re(t.title,e,"s-MessageModal"+(n?" "+n:""),!1),r=i.querySelector(".modal-footer"),o=void 0===St&&te();function a(e){var n=this;if(r){var a=oe(e);r.append(a),a.addEventListener("click",(function(r){var a;t.result=e.result,o?null===(a=Yt.Modal.getInstance(i))||void 0===a||a.hide():St(i).modal("hide"),e.click&&e.click.call(n,r)}))}}if(t.buttons)for(var l=0,s=t.buttons;l<s.length;l++){a(s[l])}if(o)document.body.appendChild(i),t.onOpen&&i.addEventListener("shown.bs.modal",t.onOpen),i.addEventListener("hidden.bs.modal",(function(e){
try{t.onClose&&t.onClose(t.result)}finally{i.remove()}})),document.body.appendChild(i),new Yt.Modal(i,{backdrop:!1}).show();else{var u=St(i).appendTo(document.body);t.onOpen&&u.one("shown.bs.modal",t.onOpen),u.one("hidden.bs.modal",(function(e){try{t.onClose&&t.onClose(t.result)}finally{u.remove()}})),te()?(u.modal({backdrop:!1}),u.modal("show")):u.modal({backdrop:!1,show:!0}),te()&&u.modal("show")}}function se(){var t;return null==ee&&(ee=!(te()||void 0!==St&&(St.ui&&(null===(t=St.ui)||void 0===t?void 0:t.dialog)||St.fn&&St.fn.modal))),ee}function ue(t){var e;return Gt.bootstrapMessages||t.bootstrap||!(null===(e=null==St?void 0:St.ui)||void 0===e?void 0:e.dialog)}function ce(t,e){var n=null==e||null==e.htmlEncode||e.htmlEncode;return n&&(t=Ft(t)),'<div class="message"'+(null==e||null==e.preWrap&&n||e.preWrap?' style="white-space: pre-wrap">':">")+t+"</div>"}function de(t,e){var n,i,r;if(se())window.alert(t);else{null!=e||(e={});var o=ue(e);null==e.htmlEncode&&(e.htmlEncode=!0),
null==e.okButton&&(e.okButton=ie("OkButton")),null==e.title&&(e.title=ie("AlertTitle")),null==e.buttons&&(e.buttons=[],(null==e.okButton||e.okButton)&&e.buttons.push({text:"boolean"==typeof e.okButton?ie("OkButton"):e.okButton,cssClass:null!==(n=e.okButtonClass)&&void 0!==n?n:o?"btn-danger":void 0,result:"ok"}));var a=ce(t,e);o?le(e,a,null!==(i=e.modalClass)&&void 0!==i?i:"s-AlertModal"):Xt(e,a,null!==(r=e.dialogClass)&&void 0!==r?r:"s-AlertDialog")}}var pe=de;function he(t,e,n){var i,r,o;if(se())window.confirm(t)&&e&&e();else{null!=n||(n={});var a=ue(n);null==n.htmlEncode&&(n.htmlEncode=!0),null==n.yesButton&&(n.yesButton=ie("YesButton")),null==n.noButton&&(n.noButton=ie("NoButton")),void 0===n.title&&(n.title=ie("ConfirmationTitle")),null==n.buttons&&(n.buttons=[],(null==n.yesButton||n.yesButton)&&n.buttons.push({text:"boolean"==typeof n.yesButton?ie("YesButton"):n.yesButton,cssClass:null!==(i=n.yesButtonClass)&&void 0!==i?i:a?"btn-primary":void 0,result:"yes",click:e}),
(null==n.noButton||n.noButton)&&n.buttons.push({text:"boolean"==typeof n.noButton?ie("NoButton"):n.noButton,cssClass:a?te()?"btn-danger":"btn-default":void 0,result:"no",click:n.onNo}),n.cancelButton&&n.buttons.push({text:"boolean"==typeof n.cancelButton?ie("CancelButton"):n.cancelButton,cssClass:a?te()?"btn-secondary":"btn-default":void 0,result:"cancel",click:n.onCancel})),t=ce(t,n),a?le(n,t,null!==(r=n.modalClass)&&void 0!==r?r:"s-ConfirmModal"):Xt(n,t,null!==(o=n.dialogClass)&&void 0!==o?o:"s-ConfirmDialog")}}var fe=he;function ge(t){var e,n,i;if(se())window.alert(t.html);else if(ue(t))le({title:ie("AlertTitle"),modalClass:"modal-lg",onOpen:function(){a(this.querySelector(".modal-body>div"))}},'<div style="overflow: hidden"></div>',"s-IFrameModal");else{var r=document.createElement("div");r.style.overflow="hidden",document.body.appendChild(r);var o=d({autoOpen:!0,modal:!0,width:"60%",height:"400",title:ie("AlertTitle"),open:function(){a(r)},close:function(){var t,e,n,i
;null===(i=null===(n=null===(e=(t=St(r)).dialog)||void 0===e?void 0:e.call(t,"destroy").html(""))||void 0===n?void 0:n.remove)||void 0===i||i.call(n)}},t);null===(n=(e=St(r)).dialog)||void 0===n||n.call(e,o)}function a(e){if(e){var n=e.appendChild(document.createElement("iframe"));n.setAttribute("style","border: none; width: 100%; height: 100%;"),(i=n.contentDocument)&&(i.open(),i.write(t.html),i.close())}}}function ve(t,e,n){if(se())return window.alert(t),void(e&&e());he(t,e,d({title:ie("InformationTitle"),dialogClass:"s-InformationDialog",modalClass:"s-InformationModal",yesButton:ie("OkButton"),yesButtonClass:"btn-info",noButton:!1},n))}var ye=ve;function me(t,e,n){if(se())return window.alert(t),void(e&&e());he(t,e,d({title:ie("SuccessTitle"),dialogClass:"s-SuccessDialog",modalClass:"s-SuccessModal",yesButton:ie("OkButton"),yesButtonClass:"btn-success",noButton:!1},n))}var _e=me;function be(t,e){de(t,d({title:ie("WarningTitle"),dialogClass:"s-WarningDialog",
modalClass:"s-WarningModal",okButtonClass:"btn-warning"},e))}var Ce,we=be;function Se(t,e){var n=St&&t instanceof St?t.get(0):t;if(n&&n.classList.contains("s-Panel")&&!n.classList.contains("hidden")){var i;if(St){if((i=St.Event(e)).type="panelbeforeclose",i.target=n,St(t).trigger(i),i.isDefaultPrevented())return;i=St.Event("panelclosing",{panel:n}),St(window).trigger(i)}else{if(i=new Event("panelbeforeclose",{cancelable:!0}),n.dispatchEvent(i),i.defaultPrevented)return;(i=new Event("panelclosing")).panel=n,window.dispatchEvent(i)}n.classList.add("hidden");var r=n.dataset.paneluniquename;if((null==r?void 0:r.length)&&document.querySelectorAll('[data-panelhiddenby="'.concat(r,'"]')).forEach((function(t){t.classList.remove("panel-hidden"),t.removeAttribute("data-panelhiddenby")})),St)St(window).triggerHandler("resize"),St(".require-layout:visible").triggerHandler("layout"),(i=St.Event(e)).type="panelclose",i.target=n,St(n).trigger(i),i=St.Event("panelclosed",{panel:n}),
St(window).trigger(i);else{window.dispatchEvent(new Event("resize"));var o=new Event("layout");document.querySelectorAll(".require-layout").forEach((function(t){(t.offsetWidth>0||t.offsetHeight>0)&&t.dispatchEvent(o)})),n.dispatchEvent(new Event("panelclose")),(i=new Event("panelclosed")).panel=n,window.dispatchEvent(i)}}}function ke(t,e){var n,i,r=St&&t instanceof St?t.get(0):t;if(r){var o;St?(o=St.Event("panelopening",{panel:r}),St(window).trigger(o)):((o=new Event("panelopening")).panel=r,window.dispatchEvent(o));var a=null!==(n=document.querySelector(".panels-container"))&&void 0!==n?n:document.querySelector("section.content");if(r.dataset.paneluniquename=null!==(i=null!=e?e:r.id)&&void 0!==i?i:(new Date).getTime().toString(),a){for(var l=a.children,s=l.length,u=0;u<s;u++)c(l[u]);r.parentElement!==a&&a.appendChild(r)}document.querySelectorAll(".ui-dialog, .ui-widget-overlay, .modal.show, .modal.in").forEach(c),r.classList.remove("hidden"),r.classList.remove("panel-hidden"),
r.classList.add("s-Panel"),St?(St(r).trigger("panelopen"),o=St.Event("panelopened",{panel:r}),St(window).trigger(o)):(r.dispatchEvent(new Event("panelopen")),(o=new Event("panelopened")).panel=r,window.dispatchEvent(o))}function c(t){t===r||"LINK"===t.tagName||"SCRIPT"===t.tagName||t.classList.contains("panel-hidden")||(t.classList.contains("ui-dialog")||t.classList.contains("ui-widget-overlay"))&&t.offsetWidth<=0&&t.offsetHeight<=0||(t.classList.add("panel-hidden"),t.setAttribute("data-panelhiddenby",r.dataset.paneluniquename))}}t.ErrorHandling=void 0,(Ce=t.ErrorHandling||(t.ErrorHandling={})).showServiceError=function(t){var e,n;de(null!==(n=null!==(e=null==t?void 0:t.Message)&&void 0!==e?e:null==t?void 0:t.Code)&&void 0!==n?n:"??ERROR??")},Ce.runtimeErrorHandler=function(t,e,n,i,r){var o;try{if(!Ce.isDevelopmentMode())return;var a=null!==(o=null==r?void 0:r.stack)&&void 0!==o?o:null==r?void 0:r.toString()
;t="<p></p><p>Message: "+Ft(t)+"</p><p>File: "+Ft(e)+", Line: "+n+", Column: "+i+(a?"</p><p>"+Ft(a):"")+"</p>",window.setTimeout((function(){try{qt(t,"SCRIPT ERROR! See browser console (F12) for details.",{escapeHtml:!1,timeOut:15e3})}catch(t){}}),0)}catch(t){}},Ce.isDevelopmentMode=function(){var t,e=(null!==(t=window.location.hostname)&&void 0!==t?t:"").toLowerCase();return"localhost"===e||"127.0.0.1"===e||"[::1]"===e||e.endsWith(".local")||e.endsWith(".localhost")};var xe=0;function Ie(t){if(xe>0)xe++;else{if(null==St?void 0:St.blockUI)St.blockUI(t);else if("undefined"!=typeof document){var e=document.createElement("div");e.className="blockUI blockOverlay",e.setAttribute("style","z-index: 2000; border: none; margin: 0px; padding: 0px; width: 100%; height: 100%; top: 0px; left: 0px; opacity: 0; cursor: wait; position: fixed;"),document.body.appendChild(e)}xe++}}function Te(t){(t=Object.assign({baseZ:2e3,message:"",overlayCSS:{opacity:"0.0",zIndex:2e3,cursor:"wait"},fadeOut:0
},t)).useTimeout?window.setTimeout((function(){Ie(t)}),0):Ie(t)}function De(){var t;xe>1?xe--:(xe--,(null==St?void 0:St.unblockUI)?St.unblockUI({fadeOut:0}):"undefined"!=typeof document&&(null===(t=document.body.querySelector(":scope > .blockUI.blockOverlay"))||void 0===t||t.remove()))}function Fe(t){if($.cookie)return $.cookie(t);t+="=";for(var e=document.cookie.split(/;\s*/),n=e.length-1;n>=0;n--)if(!e[n].indexOf(t))return e[n].replace(t,"")}function Pe(e){var n=e.service;return n&&n.length&&"~"!=n.charAt(0)&&"/"!=n.charAt(0)&&n.indexOf("://")<0&&(n=Ae("~/Services/")+n),(e=d({dataType:"json",contentType:"application/json",type:"POST",cache:!1,blockUI:!0,url:n,data:JSON.stringify(e.request),success:function(t,n,i){try{!t.Error&&e.onSuccess&&e.onSuccess(t)}finally{e.blockUI&&De(),e.onCleanup&&e.onCleanup()}},error:function(n,i,r){try{if(403===n.status){var o=null;try{o=n.getResponseHeader("Location")}catch(t){o=null}if(o)return void(window.top.location.href=o)}
if((n.getResponseHeader("content-type")||"").toLowerCase().indexOf("application/json")>=0){var a=$.parseJSON(n.responseText);if(a&&a.Error)return s=a,void(null!=Gt.notLoggedInHandler&&s&&s.Error&&"NotLoggedIn"==s.Error.Code&&Gt.notLoggedInHandler(e,s)||(null==e.onError?t.ErrorHandling.showServiceError(s.Error):e.onError(s)))}var l=n.responseText;l?ge({html:l}):n.status?500==n.status?de("HTTP 500: Connection refused! Check browser console for details."):de("HTTP "+n.status+" error! Check browser console for details."):"abort"!=n.statusText&&de("An unknown AJAX connection error occurred! Check browser console for details.")}finally{e.blockUI&&De(),e.onCleanup&&e.onCleanup()}var s}},e)).blockUI&&Te(null),$.ajax(e)}function Oe(t,e,n){null==t.EqualityFilter&&(t.EqualityFilter={}),t.EqualityFilter[e]=n}function Ee(t){var e=$("<form/>").attr("method","POST").attr("action",t.url?Ae(t.url):Ae("~/Services/"+t.service)).appendTo(document.body);t.target&&e.attr("target",t.target)
;var n=$("<div/>").appendTo(e);$("<input/>").attr("type","hidden").attr("name","request").val($.toJSON(t.request)).appendTo(n);var i=Fe("CSRF-TOKEN");i&&$("<input/>").attr("type","hidden").attr("name","__RequestVerificationToken").appendTo(n).val(i),$("<input/>").attr("type","submit").appendTo(n),e.submit(),window.setTimeout((function(){e.remove()}),0)}function Ae(t){return t&&"~/"===t.substr(0,2)?Gt.applicationPath+t.substr(2):t}"undefined"!=typeof $&&$.ajaxSetup&&$.ajaxSetup({beforeSend:function(t,e){if(!e||!e.crossDomain){var n=Fe("CSRF-TOKEN");n&&t.setRequestHeader("X-CSRF-TOKEN",n)}}});var Ne={decimalSeparator:".",groupSeparator:",",decimalDigits:2,negativeSign:"-",positiveSign:"+",percentSymbol:"%",currencySymbol:"$",dateSeparator:"/",dateOrder:"mdy",dateFormat:"MM/dd/yyyy",dateTimeFormat:"MM/dd/yyyy HH:mm:ss",amDesignator:"AM",pmDesignator:"PM",timeSeparator:":",firstDayOfWeek:0,dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],
shortDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],minimizedDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],shortMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],stringCompare:function(t,e){return t<e?-1:t>e?1:0}};function Me(t){for(var e={},n=0;n<t.length;n++)e[t.charAt(n)]=n+1;return function(t,n){if((t=t||"")==(n=n||""))return 0;for(var i,r=0,o=Math.min(t.length,n.length);r<o;r++){var a=t.charAt(r),l=n.charAt(r);if(a!==l){var s=e[a],u=e[l];if(null!=s&&null!=u)return s<u?-1:1;if(0!=(i=a.localeCompare(l)))return i}}return null!=i?i:t.localeCompare(n)}}var Re={decimalSeparator:".",groupSeparator:",",dateSeparator:"/",dateOrder:"dmy",dateFormat:"dd/MM/yyyy",dateTimeFormat:"dd/MM/yyyy HH:mm:ss",stringCompare:Me("AaBbCcÇçFfGgĞğHhIıİiJjKkLlMmNnOoÖöPpRrSsŞşTtUuÜüVvYyZz")};!function(){var t,e
;for(e in Ne)void 0===Re[e]&&Object.prototype.hasOwnProperty.call(Ne,e)&&(Re[e]=Ne[e]);if("undefined"!=typeof document&&null!=(e=ht(null===(t=document.querySelector("script#ScriptCulture"))||void 0===t?void 0:t.textContent))){var n=JSON.parse(e);for(e in null!=n.DecimalSeparator&&(Re.decimalSeparator=n.DecimalSeparator),null!=n.GroupSeparator&&n.GroupSeparator!=Re.decimalSeparator?Re.groupSeparator=n.GroupSeparator:Re.groupSeparator==Re.decimalSeparator&&(Re.groupSeparator="."==Re.decimalSeparator?",":"."),delete n.GroupSeparator,delete n.DecimalSeparator,n)void 0===Re[e]&&Object.prototype.hasOwnProperty.call(n,e)&&(Re[e.charAt(0).toLowerCase()+e.substr(1)]=n[e])}}();var Be=Re.stringCompare;function Le(t,e,n,i){var r=null,o=t.indexOf(e);o>0&&(r=t.substring(o),t=t.substr(0,o));var a=ut(t,i);a&&(t=t.substring(1));var l=3;if(t.length<l)return(a?i:"")+(r?t+r:t);for(var s=t.length,u="",c=!1;!c;){var d=l,p=s-d;if(p<0&&(l+=p,d+=p,p=0,c=!0),!d)break;var h=t.substring(p,p+d);u=u.length?h+n+u:h,
s-=d}return a&&(u="-"+u),r?u+r:u}var $e=/\{\{|\}\}|\{[^\}\{]+\}/g;function Ve(t,e,n,i){return t.replace($e,(function(t){if("{{"===t||"}}"===t)return t.charAt(0);var r=parseInt(t.substr(1),10),o=n[r+i];if(null==o)return"";var a=null,l=t.indexOf(":");return l>0&&(a=t.substring(l+1,t.length-1)),function(t,e,n){if("number"==typeof t)return ze(t,e,n);if("[object Date]"===Object.prototype.toString.call(t))return Qe(t,e,n);if(t.format)return t.format(e,null!=n?n:Re);return String(t)}(o,a,e)}))}function qe(t){return Ve(t,Re,arguments,1)}var He=function(t,e,n){var i=Math.pow(10,e||0),r=(t*=i)>0|-(t<0);if(t%1==.5*r){var o=Math.floor(t);return(o+(n?r>0:o%2*r))/i}return Math.round(t)/i},Ge=function(t){return null!=t?t>0?Math.floor(t):Math.ceil(t):null};function ze(t,e,n,i){var r,o,a,l,s,u,c,d;if(null==t)return"";var p="string"!=typeof n?null!=n?n:Re:{decimalSeparator:n,groupSeparator:null!=i?i:","==n?".":","};if(isNaN(t))return null!==(r=p.nanSymbol)&&void 0!==r?r:Re.nanSymbol
;if("i"===e)return t.toString();null!=e&&""!=e||(e="g");var h=null!==(o=p.decimalSeparator)&&void 0!==o?o:Re.decimalSeparator;i=null!==(a=null!=i?i:p.groupSeparator)&&void 0!==a?a:Re.groupSeparator;var f=null!==(l=p.negativeSign)&&void 0!==l?l:Re.negativeSign,g="",v=-1;e.length>1&&(v=parseInt(e.substring(1),10));var y=e.charAt(0);switch(y){case"g":case"G":g=-1!=v?t.toFixed(v):t.toString(),"."!=h&&(g=g.replace(".",h));break;case"d":case"D":g=parseInt(Math.abs(t)).toString(),-1!=v&&(g=st(g,v,"0")),t<0&&(g=f+g);break;case"x":case"X":g=parseInt(Math.abs(t)).toString(16),"X"==y&&(g=g.toUpperCase()),-1!=v&&(g=st(g,v,"0"));break;case"e":case"E":g=-1==v?t.toExponential(6):t.toExponential(v),"E"==y&&(g=g.toUpperCase());break;case"f":case"F":case"n":case"N":if(-1==v&&(v=null!==(s=p.decimalDigits)&&void 0!==s?s:Re.decimalDigits),g=t.toFixed(v).toString(),v&&"."!=h){var m=g.indexOf(".");g=g.substring(0,m)+h+g.substring(m+1)}"n"!=y&&"N"!=y||(g=Le(g,h,i,f));break;case"c":case"C":case"p":case"P":
var _;if(-1==v&&(v=null!==(u=p.decimalDigits)&&void 0!==u?u:Re.decimalDigits),"p"===y||"P"==y?(t*=100,_=null!==(c=p.percentSymbol)&&void 0!==c?c:Re.percentSymbol):_=null!==(d=p.currencySymbol)&&void 0!==d?d:Re.currencySymbol,g=t.toFixed(v).toString(),v&&"."!=h){m=g.indexOf(".");g=g.substring(0,m)+h+g.substring(m+1)}g=Le(g,h,i,f)+_;break;default:for(var b="",C="",w="",S=!1,k=!1,x=0;x<e.length;x++){if("'"!=(I=e.charAt(x))){if(!k)if("\\"==I){var I=e.charAt(x+1)||"";x++}else if("#"==I||","==I||"."==I||"0"==I){S=!0,C+=I;continue}S?w+=I:b+=I}else k=!k}var T="";if((e=C).indexOf(".")>-1){var D=h,F=e.substring(e.lastIndexOf(".")+1);t=function(t,e){var n=Math.pow(10,e||0),i=(Math.round(t*n)/n).toString();if(e>0){var r=i.indexOf(".");for(-1==r?(i+=".",r=0):r=i.length-(r+1);r<e;)i+="0",r++}return parseFloat(i)}(t,F.length);var P=new String((t%1).toFixed(F.length));P=P.substring(P.lastIndexOf(".")+1);for(var O=0;O<F.length;O++)if("#"!=F.charAt(O)||"0"==P.charAt(O)){
if("#"==F.charAt(O)&&"0"==P.charAt(O)){if(P.substring(O).match("[1-9]")){D+=P.charAt(O);continue}break}"0"==F.charAt(O)?D+=P.charAt(O):D+=F.charAt(O)}else D+=P.charAt(O);T+=D}else t=Math.round(t);var E=Math.floor(t);t<0&&(E=Math.ceil(t));var A="";A=-1==e.indexOf(".")?e:e.substring(0,e.indexOf("."));var N="";if(0!=E||"#"!=A.substr(A.length-1)){var M=new String(Math.abs(E)),R=9999;-1!=A.lastIndexOf(",")&&(R=A.length-A.lastIndexOf(",")-1);for(var B=0,L=M.length-1;L>-1;L--)N=M.charAt(L)+N,++B==R&&0!=L&&(N=i+N,B=0);if(A.length>N.length){var $=A.indexOf("0");if(-1!=$)for(var V=A.length-$,q=A.length-N.length-1;N.length<V;){var H=A.charAt(q);","==H&&(H=i),N=H+N,q--}}}return N||-1===A.indexOf("0",A.length-1)||(N="0"),T=N+T,t<0&&(T=f+T),T.lastIndexOf(h)==T.length-1&&(T=T.substring(0,T.length-1)),b+T+w}return g}function je(t){if(null==t)return null;if(!(t=dt(t.toString())).length)return null;var e=Re.groupSeparator
;return t&&t.length&&t.indexOf(e)>0&&(t=t.replace(new RegExp("(\\b\\d{1,3})\\"+e+"(?=\\d{3}(\\D|$))","g"),"$1")),/^[-\+]?\d+$/.test(t)?parseInt(t,10):NaN}function Ue(t){if(null==t)return null;if(0==(t=dt(t.toString())).length)return null;var e=Re.groupSeparator;return t&&t.length&&t.indexOf(e)>0&&(t=t.replace(new RegExp("(\\b\\d{1,3})\\"+e+"(?=\\d{3}(\\D|$))","g"),"$1")),new RegExp("^\\s*([-\\+])?(\\d*)\\"+Re.decimalSeparator+"?(\\d*)\\s*$").test(t)?parseFloat(t.toString().replace(Re.decimalSeparator,".")):NaN}function We(t){return null==t?null:"number"==typeof t?t:("string"==typeof t&&(t=dt(t)),t.length?t.length>=15||!/^-?\d+$/.test(t)?t:parseInt(t,10):null)}var Ke=/'.*?[^\\]'|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|zzz|zz|z|\//g;function Qe(t,e,n){var i,r,o,a,l,s,u,c,d,p,h,f,g;if(!t)return"";if("string"==typeof t){if(!(g=en(t,null==n?void 0:n.dateOrder)))return"";if(isNaN(g.valueOf()))return t}else g=t;if("i"==e)return g.toString()
;if("id"==e)return g.toDateString();if("it"==e)return g.toTimeString();if(null==n&&(n=Re),null==e||"d"==e)e=null!==(i=n.dateFormat)&&void 0!==i?i:Re.dateFormat;else if(1==e.length)switch(e){case"g":e=(null!==(r=n.dateTimeFormat)&&void 0!==r?r:Re.dateTimeFormat).replace(":ss","");break;case"G":e=null!==(o=n.dateTimeFormat)&&void 0!==o?o:Re.dateTimeFormat;break;case"s":e="yyyy-MM-ddTHH:mm:ss";break;case"t":e=n.dateTimeFormat&&n.dateFormat?n.dateTimeFormat.replace(n.dateFormat+" ",""):"HH:mm";break;case"u":case"U":e="u"==e?"yyyy-MM-ddTHH:mm:ss.fffZ":null!==(a=n.dateTimeFormat)&&void 0!==a?a:Re.dateTimeFormat,g=new Date(g.getUTCFullYear(),g.getUTCMonth(),g.getUTCDate(),g.getUTCHours(),g.getUTCMinutes(),g.getUTCSeconds(),g.getUTCMilliseconds())}"%"==e.charAt(0)&&(e=e.substr(1));var v=Ke,y=[];for(v.lastIndex=0;;){var m=v.lastIndex,_=v.exec(e);if(y.push(e.slice(m,_?_.index:e.length)),!_)break;var b=_[0],C=b;switch(b){case"/":C=null!==(l=n.dateSeparator)&&void 0!==l?l:Re.dateSeparator;break
;case"dddd":C=(null!==(s=n.dayNames)&&void 0!==s?s:Re.dayNames)[g.getDay()];break;case"ddd":C=(null!==(u=n.shortDayNames)&&void 0!==u?u:Re.shortDayNames)[g.getDay()];break;case"dd":C=st(g.getDate().toString(),2,"0");break;case"d":C=g.getDate();break;case"MMMM":C=(null!==(c=n.monthNames)&&void 0!==c?c:Re.monthNames)[g.getMonth()];break;case"MMM":C=(null!==(d=n.shortMonthNames)&&void 0!==d?d:Re.shortMonthNames)[g.getMonth()];break;case"MM":C=st(g.getMonth()+1,2,"0");break;case"M":C=g.getMonth()+1;break;case"yyyy":C=st(g.getFullYear(),4,"0");break;case"yy":C=st(g.getFullYear()%100,2,"0");break;case"y":C=g.getFullYear()%100;break;case"h":case"hh":(C=g.getHours()%12)?"hh"==b&&(C=st(C,2,"0")):C="12";break;case"HH":C=st(g.getHours(),2,"0");break;case"H":C=g.getHours();break;case"mm":C=st(g.getMinutes(),2,"0");break;case"m":C=g.getMinutes();break;case"ss":C=st(g.getSeconds().toString(),2,"0");break;case"s":C=g.getSeconds();break;case"t":case"tt":
C=g.getHours()<12?null!==(p=n.amDesignator)&&void 0!==p?p:Re.amDesignator:null!==(h=n.pmDesignator)&&void 0!==h?h:Re.pmDesignator,"t"==b&&(C=C.charAt(0));break;case"fff":C=st(g.getMilliseconds(),3,"0");break;case"ff":C=st(g.getMilliseconds(),3,"0").substr(0,2);break;case"f":C=st(g.getMilliseconds(),3,"0").charAt(0);break;case"z":C=((C=g.getTimezoneOffset()/60)>=0?"-":"+")+Math.floor(Math.abs(C));break;case"zz":case"zzz":C=((C=g.getTimezoneOffset()/60)>=0?"-":"+")+st(Math.floor(Math.abs(C)),2,"0"),"zzz"==b&&(C+=(null!==(f=n.timeSeparator)&&void 0!==f?f:Re.timeSeparator)+st(Math.abs(g.getTimezoneOffset()%60),2,"0"));break;default:"'"==C.charAt(0)&&(C=C.substr(1,C.length-2).replace(/\\'/g,"'"))}y.push(C)}return y.join("")}function Ye(t){if(null==t)return"";var e=function(t){return(t<10?"0":"")+t
},n=t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes()),i=Number(t.getUTCSeconds()+"."+(t.getUTCMilliseconds()<100?"0":"")+e(t.getUTCMilliseconds()));return n+=":"+e(i)+"Z"}var Je=/(\d{4,})(?:-(\d{1,2})(?:-(\d{1,2})(?:[T ](\d{1,2}):(\d{1,2})(?::(\d{1,2})(?:\.(\d+))?)?(?:(Z)|([+-])(\d{1,2})(?::(\d{1,2}))?)?)?)?)?/;function Xe(t){return null==t?null:("string"!=typeof t&&(t+=""),t.length?Je.test(t)?new Date(t+(10==t.length?"T00:00:00":"")):new Date(NaN):null)}function Ze(t){var e,n,i=dt(t);if(!i.length)return null;if(i.length<4||i.length>5)return NaN;if(":"==i.charAt(1))e=je(i.substr(0,1)),n=je(i.substr(2,2));else{if(":"!=i.charAt(2))return NaN;e=je(i.substr(0,2)),n=je(i.substr(3,2))}return isNaN(e)||isNaN(n)||e<0||e>23||n<0||n>59?NaN:60*e+n}function tn(t){var e,n=dt(t);if(!n.length)return null;var i=n.split(".");if(1==i.length)return e=je(i[0]),isNaN(e)?Ze(i[0]):24*e*60;if(2==i.length){e=je(i[0]);var r=Ze(i[1])
;return isNaN(e)||!r||isNaN(r)?NaN:24*e*60+r}return NaN}function en(t,e){if(!t||!t.length)return null;if(!(t=dt(t)).length)return null;if(t.length>=10&&"-"===t.charAt(4)&&"-"===t.charAt(7)&&(10===t.length||t.length>10&&"T"===t.charAt(10)))return Xe(t);if(t.indexOf(" ")>0&&t.indexOf(":")>t.indexOf(" ")+1){var n=en(t.substring(0,t.indexOf(" ")));return!n||isNaN(n.valueOf())?new Date(NaN):Xe(Qe(n,"yyyy-MM-dd")+"T"+dt(t.substring(t.indexOf(" ")+1)))}var i,r,o,a=nn(t);if(3==a.length){if(a.some((function(t){return!/^[0-9]+$/.test(t)})))return new Date(NaN);switch(e=e||Re.dateOrder){case"dmy":i=parseInt(a[0],10),r=parseInt(a[1],10)-1,o=parseInt(a[2],10);break;case"ymd":i=parseInt(a[2],10),r=parseInt(a[1],10)-1,o=parseInt(a[0],10);break;default:i=parseInt(a[1],10),r=parseInt(a[0],10)-1,o=parseInt(a[2],10)}if(isNaN(i)||isNaN(r)||isNaN(o)||i<1||i>31||r<0||r>11||o>9999||o<0)return new Date(NaN);if(o<100){var l=(new Date).getFullYear();o+=l-l%100+(o<=l%100+10?0:-100)}return new Date(o,r,i)}
if(1==a.length)try{return new Date(a[0])}catch(t){return new Date(NaN)}return new Date(NaN)}function nn(t){return(t=dt(t)).length?t.indexOf("/")>=0?t.split("/"):t.indexOf(".")>=0?t.split("."):t.indexOf("-")>=0?t.split("-"):t.indexOf("\\")>=0?t.split("\\"):[t]:null}function rn(e,n){var i,r=B();if(null==r.__scriptHash&&"undefined"!=typeof document&&null!=(i=ht((document.querySelector("script#RegisteredScripts")||{}).innerHTML))&&"{"==i.charAt(0)){var o=JSON.parse(i);t.ScriptData.setRegisteredScripts(o)}if(null==r.__scriptHash){if(!n)return null;r.__scriptHash={}}return n?r.__scriptHash[e]=(new Date).getTime().toString():r.__scriptHash[e]}function on(t){return B("__scriptData")[t]}function an(e){return t.ScriptData.ensure("RemoteData."+e)}function ln(n){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(e){switch(e.label){case 0:return[4,t.ScriptData.ensureAsync("RemoteData."+n)];case 1:return[2,e.sent()]}}))}))}function sn(e){
return t.ScriptData.ensure("Lookup."+e)}function un(n){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(e){switch(e.label){case 0:return[4,t.ScriptData.ensureAsync("Lookup."+n)];case 1:return[2,e.sent()]}}))}))}function cn(e){return t.ScriptData.reload("Lookup."+e)}function dn(n){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(e){switch(e.label){case 0:return[4,t.ScriptData.reloadAsync("Lookup."+n)];case 1:return[2,e.sent()]}}))}))}function pn(t){return hn(t).items}function hn(e){return t.ScriptData.ensure("Columns."+e)}function fn(t){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(e){switch(e.label){case 0:return[4,gn(t)];case 1:return[2,e.sent().items]}}))}))}function gn(n){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(e){return[2,t.ScriptData.ensureAsync("Columns."+n)]}))}))}function vn(t){return yn(t).items}function yn(e){
return t.ScriptData.ensure("Form."+e)}function mn(t){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(e){switch(e.label){case 0:return[4,_n(t)];case 1:return[2,e.sent().items]}}))}))}function _n(n){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(e){switch(e.label){case 0:return[4,t.ScriptData.ensureAsync("Form."+n)];case 1:return[2,e.sent()]}}))}))}function bn(e){return t.ScriptData.ensure("Template."+e)}function Cn(n){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(e){switch(e.label){case 0:return[4,t.ScriptData.ensureAsync("Template."+n)];case 1:return[2,e.sent()]}}))}))}function wn(e){return t.ScriptData.canLoad(e)}t.ScriptData=void 0,function(t){function n(t){"undefined"!=typeof $&&"undefined"!=typeof document&&$(document.body).triggerHandler("scriptdatachange",[t])}function i(t,e){var n;return{async:e,cache:!0,type:"GET",
url:Ae("~/DynJS.axd/")+t+".js?v="+(null!==(n=rn(t))&&void 0!==n?n:(new Date).getTime()),data:null,dataType:"text",converters:{"text script":function(t){return t}},success:function(t,e,n){$.globalEval(t)},error:function(e,n,i){var r=ut(t,"Lookup.");if(403==e.status&&r)qt('<p>Access denied while trying to load the lookup: "<b>'+t.substr(7)+'</b>". Please check if current user has required permissions for this lookup.</p> <p><em>Lookups use the ReadPermission of their row by default. You may override that for the lookup like [LookupScript("Some.Lookup", Permission = "?")] to grant all authenticated users to read it (or use "*" for public).</em></p><p><em>Note that this might be a security risk if the lookup contains sensitive data, so it could be better to set a separate permission for lookups, like "MyModule:Lookups".</em></p>',null,{timeOut:1e4,escapeHtml:!1});else{
qt("An error occurred while trying to load "+(r?' the lookup: "'+t.substr(7):' dynamic script: "'+t)+'"!. Please check the error message displayed in the dialog below for more info.');var o=e.responseText;o?ge({html:o}):e.status?500==e.status?de("HTTP 500: Connection refused! Check browser console for details."):de("HTTP "+e.status+" error! Check browser console for details."):de("An unknown connection error occurred! Check browser console for details.")}}}}t.bindToChange=function(t,e,n){"undefined"!=typeof $&&"undefined"!=typeof document&&$(document.body).bind("scriptdatachange."+e,(function(e,i){i==t&&n()}))},t.triggerChange=n,t.unbindFromChange=function(t){"undefined"!=typeof $&&"undefined"!=typeof document&&$(document.body).unbind("scriptdatachange."+t)};var r={};function o(t){var e,n=t+"?"+(null!==(e=rn(t))&&void 0!==e?e:""),o=r[n];if(o)return o;var a=i(t,!0);return Te(null),r[n]=o=Promise.resolve($.ajax(a).always((function(){delete r[n],De()}))),o}function a(t){$.ajax(i(t,!1))}
function l(t){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(e){switch(e.label){case 0:return[4,o(t)];case 1:return[2,e.sent()]}}))}))}function s(t){var e;throw qt(e=null!=t&&t.startsWith("Lookup.")?'No lookup with key "'+t.substring(7)+'" is registered. Please make sure you have a [LookupScript("'+t.substring(7)+'")] attribute in server side code on top of a row / custom lookup and  its key is exactly the same.':qe("Can't load script data: {0}!",t)),new Error(e)}t.ensure=function(t){var e=on(t);return null==e&&a(t),null==(e=on(t))&&s(t),e},t.ensureAsync=function(t){return e.__awaiter(this,void 0,void 0,(function(){var n;return e.__generator(this,(function(e){switch(e.label){case 0:return null!=(n=on(t))?[2,n]:[4,l(t)];case 1:return e.sent(),null==(n=on(t))&&s(t),[2,n]}}))}))},t.reload=function(t){return rn(t,!0),a(t),on(t)},t.reloadAsync=function(t){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(e){
switch(e.label){case 0:return rn(t,!0),[4,l(t)];case 1:return e.sent(),[2,on(t)]}}))}))},t.canLoad=function(t){return null!=on(t)||null!=rn(t)},t.setRegisteredScripts=function(t){var e,n,i=(new Date).getTime().toString();for(var r in t)e=r,n=t[r]||i,B("__scriptHash")[e]=n},t.set=function(t,e){!function(t,e){B("__scriptData")[t]=e}(t,e),n(t)}}(t.ScriptData||(t.ScriptData={}));var Sn={canLoadScriptData:wn,getColumns:pn,getColumnsAsync:fn,getForm:vn,getFormAsync:mn,getLookup:sn,getLookupAsync:un,getRemoteData:an,getRemoteDataAsync:ln,getTemplate:bn,getTemplateAsync:Cn,reloadLookup:cn,reloadLookupAsync:dn,ScriptData:t.ScriptData};if("undefined"!=typeof globalThis){var kn=globalThis.Q||(globalThis.Q={});for(var xn in Sn)null==kn[xn]&&(kn[xn]=Sn[xn])}var In=/[|&]/;function Tn(t,e,n){var i,r,o,a,l;null==e&&(e=100);var s=function(){var u=Date.now()-a;u<e&&u>=0?i=setTimeout(s,e-u):(i=null,n||(l=t.apply(o,r)),i||(o=r=null))},u=function(){return o=this,r=arguments,a=Date.now(),
i||(i=setTimeout(s,e),n&&(l=t.apply(o,r))),l};return u.clear=function(){i&&(clearTimeout(i),i=null)},u.flush=function(){i&&(l=t.apply(o,r),o=r=null,clearTimeout(i),i=null)},u}function Dn(e,n){var i=e&&e[0];if(i)if(i.offsetWidth>0&&i.offsetHeight>0)n();else var r=t.LayoutTimer.onShown((function(){return i}),(function(){t.LayoutTimer.off(r),n()}))}function Fn(e,n,i){var r=e&&e[0];r&&(i&&r.offsetWidth>0&&r.offsetHeight>0&&n(),t.LayoutTimer.onShown((function(){return r}),(function(){n()})))}function Pn(t){var e=0;return t.parent().children().not(t).each((function(t,n){var i=St(n);i.is(":visible")&&(e+=i.outerHeight(!0))})),e=t.parent().height()-e,"border-box"!==t.css("box-sizing")&&(e-=t.outerHeight(!0)-t.height()),e}function On(t){var e=Pn(t),n=Math.round(e)+"px";t.css("height")!=n&&t.css("height",n)}function En(){var t,e,n
;return"undefined"!=typeof window&&(null!==(n=null===(e=null===(t=window.matchMedia)||void 0===t?void 0:t.call(window,"(max-width: 767px)"))||void 0===e?void 0:e.matches)&&void 0!==n?n:window.innerWidth<768)}function An(){var t=y();if(t&&Gt.rootNamespaces)for(var e=0,n=Gt.rootNamespaces;e<n.length;e++){var i=n[e],r=f(t,i);null!=r&&et(r,i+".",3)}}function Nn(t){var e,n;null===(n=(e=t=t.closest(".ui-dialog")).position)||void 0===n||n.call(e,{at:"center center",of:window});var i=t.position();i.left<0&&t.css("left","0px"),i.top<0&&t.css("top","0px")}t.Authorization=void 0,function(t){function n(e){if(null==e)return!1;if("*"==e)return!0;if(""==e||"?"==e)return!!t.isLoggedIn;var n=t.userDefinition;return!!n&&(!!n.IsAdmin||r(n.Permissions,e))}function i(n){return e.__awaiter(this,void 0,void 0,(function(){var i;return e.__generator(this,(function(e){switch(e.label){case 0:return null==n?[2,!1]:"*"==n?[2,!0]:""!=n&&"?"!=n?[3,2]:[4,t.isLoggedInAsync];case 1:return[2,e.sent()];case 2:
return[4,t.userDefinitionAsync];case 3:return(i=e.sent())?i.IsAdmin?[2,!0]:[2,r(i.Permissions,n)]:[2,!1]}}))}))}function r(t,e){if(!t||null==e)return!1;if(t[e])return!0;if(!In.test(e))return!1;for(var n=0,i=e.split("|");n<i.length;n++){var r=i[n];if(r.length){for(var o=!1,a=0,l=r.split("&");a<l.length;a++){var s=l[a];if(!s||!t[s]){o=!0;break}}if(!o)return!0}}return!1}t.hasPermission=n,t.hasPermissionAsync=i,t.isPermissionInSet=r,t.validatePermission=function(t){if(!n(t))throw qt(vt("Authorization.AccessDenied")),new Error(vt("Authorization.AccessDenied"))},t.validatePermissionAsync=function(t){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(e){switch(e.label){case 0:return[4,i(t)];case 1:if(!e.sent())throw qt(vt("Authorization.AccessDenied")),new Error(vt("Authorization.AccessDenied"));return[2]}}))}))}}(t.Authorization||(t.Authorization={})),Object.defineProperty(t.Authorization,"isLoggedIn",{get:function(){var e,n
;return!!(null===(n=null===(e=t.Authorization.userDefinition)||void 0===e?void 0:e.Username)||void 0===n?void 0:n.length)},configurable:!0}),Object.defineProperty(t.Authorization,"isLoggedInAsync",{get:function(){var n,i;return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(e){switch(e.label){case 0:return[4,t.Authorization.userDefinitionAsync];case 1:return[2,!!(null===(i=null===(n=e.sent())||void 0===n?void 0:n.Username)||void 0===i?void 0:i.length)]}}))}))},configurable:!0}),Object.defineProperty(t.Authorization,"userDefinition",{get:function(){return an("UserData")},configurable:!0}),Object.defineProperty(t.Authorization,"userDefinitionAsync",{get:function(){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(t){switch(t.label){case 0:return[4,ln("UserData")];case 1:return[2,t.sent()]}}))}))},configurable:!0}),Object.defineProperty(t.Authorization,"username",{get:function(){var e
;return null===(e=t.Authorization.userDefinition)||void 0===e?void 0:e.Username},configurable:!0}),Object.defineProperty(t.Authorization,"usernameAsync",{get:function(){var n;return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(e){switch(e.label){case 0:return[4,t.Authorization.userDefinitionAsync];case 1:return[2,null===(n=e.sent())||void 0===n?void 0:n.Username]}}))}))},configurable:!0}),t.LayoutTimer=void 0,function(t){var e,n=0,i=0,r={};function o(){null==e&&i>0&&(e=window.setTimeout(l,100))}function a(){null!=e&&(window.clearTimeout(e),e=null)}function l(){for(var t in r){var e=r[t];try{var n=e.element();if(!n)continue;var i=n.offsetWidth,l=n.offsetHeight;try{if((e.width&&e.storedWidth!==i||e.height&&e.storedHeight!==l||!e.width&&!e.height&&(!i!=!e.storedWidth||!l!=!e.storedHeight))&&i>0&&l>0)try{e.handler()}finally{i=n.offsetWidth,l=n.offsetHeight}}finally{e.storedWidth=i,e.storedHeight=l}}catch(t){console.log(t)}}a(),o()}function s(t){var e=r[t]
;if(e){var n=e.element();n&&(e.storedWidth=n.offsetWidth,e.storedHeight=n.offsetHeight)}}function u(t,e,a,l){if(null==e)throw"Layout handler can't be null!";return r[++n]={element:t,handler:e,width:!1!==a,height:!1!==l},i++,s(n),o(),n}t.store=s,t.trigger=function(t){var e=r[t];e&&(s(t),e.storedWidth>=0&&e.storedHeight>=0&&e.handler(),s(t))},t.onSizeChange=u,t.onWidthChange=function(t,e){return u(t,e,!0,!1)},t.onHeightChange=function(t,e){return u(t,e,!1,!0)},t.onShown=function(t,e){return u(t,e,!1,!1)},t.off=function(t){return r[t]?(delete r[t],--i<=0&&a(),0):0}}(t.LayoutTimer||(t.LayoutTimer={})),t.Router=void 0,function(t){var e,n=0,i=0,r=0,o=0;function a(i,r,o){if(t.enabled&&!(n>0)){i=(i=(i=i||"").replace(/^#/,""))?"#"+i:"";var a,l,s=window.location.href.replace(/#$/,"").replace(/#.*$/,"")+i;if(s!=window.location.href){if(r&&null!=e&&((a=e)==(l=s)||a==l+"#"||l==a+"#"))return o&&p(),e=null,void window.history.back();o&&p(),e=window.location.href,window.location.hash=i}}}
function l(t,e){a(t,e,!0)}function s(e,n){if(t.enabled){var i=window.location.hash||"";"#"==i.charAt(0)&&(i=i.substr(1,i.length-1));var r=i.split("/+/");r.length>1&&(e&&e.length?(r[r.length-1]=e,e=r.join("/+/")):(r.splice(r.length-1,1),e=r.join("/+/"))),l(e,n)}}function u(){return St(".ui-dialog-content:visible, .ui-dialog.panel-hidden>.ui-dialog-content, .s-Panel").toArray().sort((function(t,e){return(St(t).data("qrouterorder")||0)-(St(e).data("qrouterorder")||0)}))}function c(t,e,n){var i,r=[],o=t.hasClass(".ui-dialog-content")||t.hasClass(".s-Panel"),a=o?t:t.closest(".ui-dialog-content, .s-Panel"),c=n();if(a.length){for(var d=u(),p=d.indexOf(a[0]),h=0;h<=p;h++){var f=St(d[h]).data("qroute");f&&f.length&&r.push(f)}if(!o)if(i=a.attr("id"))i+="_",(g=t.attr("id"))&&ut(g,i)&&(c=g.substr(i.length)+"@"+c)}else{var g;!(g=t.attr("id"))||t.hasClass("route-handler")&&St(".route-handler").first().attr("id")==g||(c=g+"@"+c)}r.push(c),e.data("qroute",c),l(r.join("/+/")),
e.bind("dialogclose.qrouter panelclose.qrouter",(function(t){e.data("qroute",null),e.unbind(".qrouter");var n=e.data("qprhash"),i=St(t.target).closest(".s-MessageDialog").length>0||t&&t.originalEvent&&("keydown"==t.originalEvent.type&&27==t.originalEvent.keyCode||St(t.originalEvent.target).hasClass("ui-dialog-titlebar-close")||St(t.originalEvent.target).hasClass("panel-titlebar-close"));null!=n?l(n,i):s("",i)}))}function d(e){var i,r,o;if(t.enabled){n++;try{"#"==(e=null!==(i=null!=e?e:window.location.hash)&&void 0!==i?i:"").charAt(0)&&(e=e.substr(1,e.length-1));for(var a=u(),l=e.split("/+/"),s=a.map((function(t){return St(t).data("qroute")})),c=0;c<a.length&&c<l.length&&s[c]==l[c];)c++;for(var d=c;d<a.length;d++){var p=St(a[d]);p.hasClass("ui-dialog-content")?null===(o=(r=p).dialog)||void 0===o||o.call(r,"close"):p.hasClass("s-Panel")&&Se(p)}for(d=c;d<l.length;d++){var h,f=l[d],g=f.split("@");if(2==g.length){var v=St(d>0?a[d-1]:[]);if(v.length){var y=v.attr("id")
;y&&(h=St("#"+y+"_"+g[0])).length&&(f=g[1])}h&&h.length||(h=St("#"+g[0])).length&&(f=g[1])}h&&h.length||(h=d>0?St(a[d-1]):St(".route-handler").first()),h.triggerHandler("handleroute",{handled:!1,route:f,parts:l,index:d})}}finally{n--}}}function p(){r++,o=(new Date).getTime()}t.enabled=!0,t.navigate=a,t.replace=l,t.replaceLast=s,t.dialog=function(e,n,i){t.enabled&&n.on("dialogopen.qrouter panelopen.qrouter",(function(t){c(e,n,i)}))},t.resolve=d,window.addEventListener("hashchange",(function(t,e){if(r>0){if(!((new Date).getTime()-o>1e3))return void r--;r=0}d()}),!1);var h=1;"undefined"!=typeof document&&void 0!==St&&St.fn&&St(document).on("dialogopen panelopen",".ui-dialog-content, .s-Panel",(function(e,n){if(t.enabled){var r=St(e.target);if(r.data("qrouterorder",h++),!r.data("qroute")){r.data("qprhash",window.location.hash);var o=St(u).not(r).last();o.length||(o=St("html")),c(o,r,(function(){return"!"+(++i).toString(36)}))}}}))}(t.Router||(t.Router={})),
void 0!==St?St(An):"undefined"!=typeof document&&"loading"===document.readyState?document.addEventListener("DOMContentLoaded",An):An();var Mn,Rn,Bn,Ln=function(){function t(t,e){this.items=[],this.itemById={},t=t||{},this.textFormatter=t.textFormatter,this.idField=t.idField,this.parentIdField=t.parentIdField,this.textField=t.textField,this.textFormatter=t.textFormatter,null!=e&&this.update(e)}return t.prototype.update=function(t){if(this.items=[],this.itemById={},t)for(var e=0,n=t;e<n.length;e++){var i=n[e];this.items.push(i)}var r=this.idField;if(r)for(var o=0,a=this.items;o<a.length;o++){var l=a[o],s=l[r];null!=s&&(this.itemById[s]=l)}},t}();t.SummaryType=void 0,(Mn=t.SummaryType||(t.SummaryType={}))[Mn.Disabled=-1]="Disabled",Mn[Mn.None=0]="None",Mn[Mn.Sum=1]="Sum",Mn[Mn.Avg=2]="Avg",Mn[Mn.Min=3]="Min",Mn[Mn.Max=4]="Max",Y(t.SummaryType,"Serenity.SummaryType"),t.ColumnSelection=void 0,(Rn=t.ColumnSelection||(t.ColumnSelection={}))[Rn.List=0]="List",Rn[Rn.KeyOnly=1]="KeyOnly",
Rn[Rn.Details=2]="Details",Rn[Rn.None=3]="None",Rn[Rn.IdOnly=4]="IdOnly",Rn[Rn.Lookup=5]="Lookup",t.RetrieveColumnSelection=void 0,(Bn=t.RetrieveColumnSelection||(t.RetrieveColumnSelection={}))[Bn.details=0]="details",Bn[Bn.keyOnly=1]="keyOnly",Bn[Bn.list=2]="list",Bn[Bn.none=3]="none",Bn[Bn.idOnly=4]="idOnly",Bn[Bn.lookup=5]="lookup";var $n,Vn=null==St?void 0:St.validator;if(Vn&&Vn.methods&&Vn.addMethod){if(Vn.prototype.showLabel){var qn=Vn.prototype.showLabel;Vn.prototype.showLabel=function(t,e){null!=e&&(e=Ft(e)),qn.call(this,t,e)}}Vn.addMethod("customValidate",(function(t,e){var n=this.optional(e);if(null==e||n)return n;var i=$._data(e,"events");if(!i)return!0;var r=i.customValidate;if(null==r||0===r.length)return!0;for(var o=$(e),a=0;a<r.length;a++)if($.isFunction(r[a].handler)){var l=r[a].handler(o);if(null!=l)return o.data("customValidationMessage",l),!1}return!0}),(function(t,e){return $(e).data("customValidationMessage")})),Vn.addMethod("dateQ",(function(t,e){
var n=this.optional(e);if(n)return n;var i=en(t);if(!i||isNaN(i.valueOf()))return!1;var r=new Date(i);return r.setHours(0,0,0,0),r.getTime()===i.getTime()})),Vn.addMethod("dateTimeQ",(function(t,e){var n=this.optional(e);if(n)return n;var i=en(t);return!(!i||isNaN(i.valueOf()))})),Vn.addMethod("hourAndMin",(function(t,e){return this.optional(e)||!isNaN(Ze(t))})),Vn.addMethod("dayHourAndMin",(function(t,e){return this.optional(e)||!isNaN(tn(t))})),Vn.addMethod("decimalQ",(function(t,e){return this.optional(e)||!isNaN(Ue(t))})),Vn.addMethod("integerQ",(function(t,e){return this.optional(e)||!isNaN(je(t))}));var Hn=Vn.methods.email,Gn=null;Vn.addMethod("email",(function(t,e){
return Gt.emailAllowOnlyAscii?Hn.call(this,t,e):(null==Gn&&(Gn=new RegExp("^((([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+(\\.([a-z]|\\d|[!#\\$%&'\\*\\+\\-\\/=\\?\\^_`{\\|}~]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])+)*)|((\\x22)((((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(([\\x01-\\x08\\x0b\\x0c\\x0e-\\x1f\\x7f]|\\x21|[\\x23-\\x5b]|[\\x5d-\\x7e]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(\\\\([\\x01-\\x09\\x0b\\x0c\\x0d-\\x7f]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]))))*(((\\x20|\\x09)*(\\x0d\\x0a))?(\\x20|\\x09)+)?(\\x22)))@((([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|\\d|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))\\.)+(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])|(([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])([a-z]|\\d|-|\\.|_|~|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])*([a-z]|[\\u00A0-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF])))$","i")),
Gn.test(t))})),$(zn)}function zn(){var t=function(t,e){var n=_t("Validation."+e);n?Vn.messages[t]=n:Vn.messages[t]||(Vn.messages[t]=e+"?")};t("required","Required"),t("email","Email"),t("minlength","MinLength"),t("maxlength","MaxLength"),t("digits","Digits"),t("range","Range"),t("xss","Xss"),t("dateQ","DateInvalid"),t("decimalQ","Decimal"),t("integerQ","Integer"),t("url","Url")}function jn(t,e,n){var i,r,o,a,l,s;return Zt()?null===(r=null===(i=t.attr("data-original-title",e||""))||void 0===i?void 0:i.tooltip)||void 0===r||r.call(i,"fixTitle"):null===(a=null===(o=t.attr("title",e||""))||void 0===o?void 0:o.tooltip)||void 0===a||a.call(o,"_fixTitle"),null!=n&&(null===(s=(l=t).tooltip)||void 0===s||s.call(l,n?"show":"hide")),t}function Un(t){var e=t.dataset.vxHighlight;return e?document.getElementById(e):t.classList.contains("select2-offscreen")&&t.id?document.getElementById("s2id_"+t.id):void 0}function Wn(){return{errorClass:"error",
ignore:'[style*="display:none"], [style*="display: none"] *, .hidden *, input[type=hidden], .no-validate',ignoreTitle:!0,normalizer:function(t){return $.trim(t)},highlight:function(t,e,n){if("radio"===t.type)this.findByName(t.name).addClass(e).removeClass(n);else{null!=e&&e.length&&t.classList.add(e),null!=n&&n.length&&t.classList.remove(n);var i=Un(t);i&&i.classList&&(null!=e&&e.length&&i.classList.add(e),null!=n&&n.length&&i.classList.remove(n))}},unhighlight:function(t,e,n){if("radio"===t.type)this.findByName(t.name).removeClass(e).addClass(n);else{null!=e&&e.length&&t.classList.remove(e),null!=n&&n.length&&t.classList.add(n);var i=Un(t);i&&i.classList&&(null!=e&&e.length&&i.classList.remove(e),null!=n&&n.length&&i.classList.add(n))}},showErrors:function(){var t;if(null===(t=null===$||void 0===$?void 0:$.fn)||void 0===t?void 0:t.tooltip){var e,n,i,r,o;for(e=0;this.errorList[e];e++)r=null!=(o=Un((i=this.errorList[e]).element))?$(o):$(i.element),0!=e?jn(r,"",!1):jn(r,i.message,!0)
;for(e=0,n=this.validElements();n[e];e++)jn(r=null!=(o=Un(i.element))?$(o):$(i.element),"",!1)}Vn.prototype.defaultShowErrors.call(this)}}}function Kn(t,e,n){if(!t.length)return t;if(null==n)throw new nt("rule is null!");return t.addClass("customValidate").bind("customValidate."+e,n),t}function Qn(t,e){$n.call(this,t,e),this.errorsFor(t).each((function(t,n){var i=$(n);i.parent(".vx").length&&(i.attr("title",i.text()),e&&i.hasClass("error")&&i.removeClass("checked"))}))}function Yn(){if("undefined"!=typeof $&&$.validator){var t=$.validator;t=t.prototype,$n=t.showLabel,t.showLabel=Qn,t.oldfocusInvalid=t.focusInvalid,t.focusInvalid=function(){this.settings.abortHandler&&this.settings.abortHandler(this),this.oldfocusInvalid.call(this)},t.oldstopRequest=t.focusInvalid,t.stopRequest=function(t,e){var n=this.formSubmitted;this.oldfocusInvalid.call(this,[t,e]),!e&&0==this.pendingRequest&&n&&this.settings.abortHandler&&this.settings.abortHandler(this)},t.resetAll=function(){this.submitted={},
this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass)}}}function Jn(t){t.settings.abortHandler=null,t.settings.submitHandler=function(){return!1}}function Xn(t){var e=Wn();return delete e.showErrors,d(d(e,{meta:"v",errorPlacement:function(t,e){var n=null,i=e.attr("data-vx-id");if(i&&(n=(n=$("#"+i)).length?n[0]:null),null==n)if((n=e.parents("div.field")).length){var r=$("div.vx",n[0]);r.length&&(n=r[0])}else n=e.parent();t.appendTo(n)},submitHandler:function(){return!1},invalidHandler:function(t,e){var n;if(qt(vt("Validation.InvalidFormMessage")),$(e.errorList.map((function(t){return t.element}))).closest(".category.collapsed").children(".category-title").each((function(t,e){return $(e).click(),!0})),e.errorList.length){var i=e.errorList[0].element;if(i){var r=$(i).closest(".tab-content>.tab-pane[id]:not(.active)").attr("id");if(r){var o='a[href="#'+r+'"]';$(o).click(),null===(n=document.querySelector(o))||void 0===n||n.click()}
var a=$(i).closest(".ui-tabs-panel[id]:not(.ui-tabs-panel-active)").attr("id");if(a&&$('a[href="#'+a+'"]').click(),$.fn.tooltip){var l,s=Un(i);l=s?$(s):$(i),$.fn.tooltip&&l.tooltip({title:e.errorList[0].message,trigger:"manual"}).tooltip("show"),window.setTimeout((function(){l.tooltip(Zt()?"destroy":"dispose")}),1500)}}}},success:function(t){t.addClass("checked")}}),t)}"undefined"!=typeof $?$.validator?Yn():$(Yn):"undefined"!=typeof document&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",Yn):setTimeout(Yn,100));var Zn=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return e.__extends(n,t),n.prototype.bw=function(t,e){return[[this,">=",t],"and",[this,"<=",e]]},n.prototype.contains=function(t){return[this,"like","%"+t+"%"]},n.prototype.endsWith=function(t){return[this,"like","%"+t]},n.prototype.eq=function(t){return[this,"=",t]},n.prototype.gt=function(t){return[this,">",t]},n.prototype.ge=function(t){return[this,">=",t]},
n.prototype.in=function(t){return[this,"in",[t]]},n.prototype.isNull=function(){return["is null",this]},n.prototype.isNotNull=function(){return["is not null",this]},n.prototype.le=function(t){return[this,"<=",t]},n.prototype.lt=function(t){return[this,"<",t]},n.prototype.ne=function(t){return[this,"!=",t]},n.prototype.like=function(t){return[this,"like",t]},n.prototype.startsWith=function(t){return[this,"like",t+"%"]},n.prototype.notIn=function(t){return[this,"not in",[t]]},n.prototype.notLike=function(t){return[this,"not like",t]},n}(Array),ti=function(t,e,n){this.expression=t,this.error=e,this.position=n,this.toString=function(){return'Error parsing expression: "'+t+'", "'+e+", position: "+n}};var ei,ni,ii={"=":4,">":4,"<":4,">=":4,"<=":4,"<>":4,"!=":4,like:5,"not like":5,in:5,"not in":5,"is null":5,"is not null":5,not:6,and:7,xor:8,or:9};function ri(t,e){var n=function(t){var e,n,i,r,o=[],a=t.length,l=t.length-1,s=0;function u(){for(;i<a&&(" "===(r=t.charAt(i))||"\t"===r);)i++}
function c(){e=i;for(var o=!1;e++<l;)if("'"===(r=t.charAt(e))){if(e<l&&"'"===t.charAt(e+1)){e++,o=!0;continue}break}if(e===i||"'"!==t.charAt(e))throw new ti(t,"unterminated string",i);n=t.substr(i+1,e-i-1),o&&(n=n.replace(/''/g,"'"))}function d(){e=i;for(var o=!1;e<l&&((r=t.charAt(e+1))>="0"&&r<="9"||!o&&"."===r);)"."===r&&(o=!0),e++;n=parseFloat(t.substring(i,e+1))}function p(){for(e=i;e<l&&("_"==(r=t.charAt(e+1))||r>="A"&&r<="Z"||r>="a"&&r<="z"||r>="0"&&r<="9");)e++;n=t.substr(i,e-i+1)}function h(){if(i++,p(),!n.length)throw new ti(t,"expected parameter name",i)}function f(){if(u(),i>=a||"("!=t.charAt(i)){if(i<a&&"@"==t.charAt(i))return h(),void(i=e);throw new ti(t,"expected parenthesis",i)}i++;for(var o=[];;){if(u(),i>=a)throw new ti(t,"expected parenthesis",i);if(","==(r=t.charAt(i))){if(0==o.length)throw new ti(t,"unexpected comma",i);i++,u(),r=t.charAt(i)}else{if(")"==r)break;if(o.length>0)throw new ti(t,"expected comma",i)}if("'"!==r)if(r>="0"&&r<="9")d(),o.push(n),i=e+1;else{
if("n"!=r||(p(),"null"!==n))throw new ti(t,"unexpected token",i);o.push(null),i=e+1}else c(),o.push(n),i=e+1}n=o}for(i=0;i<a;i++)if(" "!==(r=t.charAt(i))&&"\t"!==r)if("_"==r||r>="A"&&r<="Z"||r>="a"&&r<="z"){p();var g=n.toLowerCase();if("is"==g)if(i=e+1,u(),p(),"not"===(g=n.toLowerCase())){if(i=e+1,u(),p(),"null"!==n.toLowerCase())throw new ti(t,'expected "null"',i);o.push({t:2,v:"is not null"})}else{if("null"!==g)throw new ti(t,'expected "null" or "not" keyword',i);o.push({t:2,v:"is null"})}else if("and"===g||"or"===g||"xor"===g)o.push({t:2,v:g});else{if("not"===g){var v=e;i=e+1,u(),p(),"in"===(g=n.toLowerCase())?(i=e+1,o.push({t:2,v:"not in"}),f(),"string"==typeof n?o.push({t:4,v:n}):o.push({t:3,v:n})):"like"===g?(o.push({t:2,v:"not like"}),i=e):(o.push({t:2,v:"not"}),i=v);continue}if("in"===g){o.push({t:2,v:"in"}),i=e+1,f(),"string"==typeof n?o.push({t:4,v:n}):o.push({t:3,v:n});continue}"like"===g?o.push({t:2,v:"like"}):o.push({t:1,v:n})}i=e
}else if("@"!==r)if(("-"===r||"+"===r)&&i<l&&t.charAt(i+1)>="0"&&t.charAt(i+1)<="9"||r>="0"&&r<="9")e=i,d(),o.push({t:3,v:n}),i=e;else if("'"!==r)if("="!==r)if("("!==r)if(")"!=r){if(">"!==r&&"<"!==r)throw new ti(t,"unknown token",i);i<l&&"="===t.charAt(i+1)?(o.push({t:2,v:r+"="}),i++):o.push({t:2,v:r})}else{if(s<=0)throw new ti(t,"unexpected parenthesis",i);s--,o.push({t:2,v:r})}else s++,o.push({t:2,v:r});else o.push({t:2,v:r});else e=i,c(),o.push({t:3,v:n}),i=e;else h(),o.push({t:4,v:n}),i=e;if(s>0)throw new ti(t,"missing parenthesis",i);return o}(t),i=function(t){for(var e=[],n=[],i=0,r=t;i<r.length;i++){var o=r[i];if(2===o.t){var a=ii[o.v];if(null!=a){for(;n.length;){var l=n[n.length-1];if(2!==l.t||"("==l.v)break;var s=ii[l.v];if(null==s||s>a)break;e.push(n.pop())}n.push(o)}else if("("===o.v)n.push(o);else if(")"===o.v){for(;n.length&&(2!==n[n.length-1].t||"("!==n[n.length-1].v);)e.push(n.pop());n.pop()}else e.push(o)}else e.push(o)}for(;n.length;){var u=n.pop()
;if(2==u.t&&("("===u.v||")"===u.v))throw"Mismatched parentheses in criteria expression!";e.push(u)}return e}(n);return function(t,e){for(var n=[],i=0,r=t;i<r.length;i++){var o=r[i];switch(o.t){case 1:n.push([o.v]);break;case 3:n.push(Array.isArray(o.v)?[o.v]:o.v);break;case 4:if(!e)throw new Error("getParam must be passed for parameterized expressions!");var a=e(o.v);n.push(Array.isArray(a)?[a]:a);break;case 2:switch(o.v){case"not":case"is null":case"is not null":if(!n.length)throw new Error("Unary operator "+o.v+" requires a value!");n.push([o.v,n.pop()]);break;default:if(n.length<2)throw new Error("Binary operator "+o.v+" requires two values!");var l=n.pop(),s=n.pop();n.push([s,o.v,l])}break;default:throw new Error("Invalid operator type: "+o.t+"!")}}if(1!=n.length)throw new Error("Error evaluating expression!");return n.pop()}(i,e)}function oi(t){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];if(!(null==t?void 0:t.length))return[]
;if("string"==typeof t)return ri(t,null==n||null==n[0]?null:function(t){return n[0][t]});if(!n.length)return ri(t.join(""));var r=String.raw.apply(String,e.__spreadArray([{raw:t}],n.map((function(t,e){return"@__"+e})),!1));return ri(r,(function(t){return t.startsWith("__")?n[parseInt(t.substring(2),10)]:void 0}))}function ai(t){var e=Zn.of(t);return!e.eq&&(e.__proto__=Zn.prototype),e}t.CriteriaOperator=void 0,(ei=t.CriteriaOperator||(t.CriteriaOperator={})).paren="()",ei.not="not",ei.isNull="is null",ei.isNotNull="is not null",ei.exists="exists",ei.and="and",ei.or="or",ei.xor="xor",ei.eq="=",ei.ne="!=",ei.gt=">",ei.ge=">=",ei.lt="<",ei.le="<=",ei.in="in",ei.notIn="not in",ei.like="like",ei.notLike="not like",ai.and=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=ai.join(t,"and",e);if(n)for(var o=0,a=n;o<a.length;o++){var l=a[o];r=ai.join(r,"and",l)}return r},ai.Operator=t.CriteriaOperator,ai.isEmpty=function(t){
return null==t||0===t.length||1===t.length&&"string"==typeof t[0]&&0===t[0].length},ai.join=function(t,e,n){return ai.isEmpty(t)?n:ai.isEmpty(n)?t:[t,e,n]},ai.not=function(t){return["not",t]},ai.or=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=ai.join(t,"or",e);if(n)for(var o=0,a=n;o<a.length;o++){var l=a[o];r=ai.join(r,"or",l)}return r},ai.paren=function(t){return ai.isEmpty(t)?t:["()",t]},ai.parse=oi,t.Aggregators=void 0,(ni=t.Aggregators||(t.Aggregators={})).Avg=function(t){this.field_=t,this.type_="Avg",this.init=function(){this.count_=0,this.nonNullCount_=0,this.sum_=0},this.accumulate=function(t){var e=t[this.field_];this.count_++,null==e||""===e||isNaN(e)||(this.nonNullCount_++,this.sum_+=parseFloat(e))},this.storeResult=function(t){t.avg||(t.avg={}),0!=this.nonNullCount_&&(t.avg[this.field_]=this.sum_/this.nonNullCount_)}},ni.WeightedAvg=function(t,e){this.field_=t,this.type_="WeightedAvg",this.weightedField_=e,this.init=function(){this.sum_=0,
this.weightedSum_=0},this.accumulate=function(t){var e=t[this.field_],n=t[this.weightedField_];this.isValid(e)&&this.isValid(n)&&(this.weightedSum_+=parseFloat(n),this.sum_+=parseFloat(e)*parseFloat(n))},this.storeResult=function(t){t.avg||(t.avg={}),this.sum_&&this.weightedSum_&&(t.avg[this.field_]=this.sum_/this.weightedSum_)},this.isValid=function(t){return null!==t&&""!==t&&!isNaN(t)}},ni.Min=function(t){this.field_=t,this.type_="Min",this.init=function(){this.min_=null},this.accumulate=function(t){var e=t[this.field_];null==e||""===e||isNaN(e)||(null==this.min_||e<this.min_)&&(this.min_=e)},this.storeResult=function(t){t.min||(t.min={}),t.min[this.field_]=this.min_}},ni.Max=function(t){this.field_=t,this.type_="Max",this.init=function(){this.max_=null},this.accumulate=function(t){var e=t[this.field_];null==e||""===e||isNaN(e)||(null==this.max_||e>this.max_)&&(this.max_=e)},this.storeResult=function(t){t.max||(t.max={}),t.max[this.field_]=this.max_}},ni.Sum=function(t){
this.field_=t,this.type_="Sum",this.init=function(){this.sum_=null},this.accumulate=function(t){var e=t[this.field_];null==e||""===e||isNaN(e)||(this.sum_+=parseFloat(e))},this.storeResult=function(t){t.sum||(t.sum={}),t.sum[this.field_]=this.sum_}},t.AggregateFormatting=void 0,function(t){function e(t,e,n){var r,o=n.substring(0,1).toUpperCase()+n.substring(1),a=null!==(r=_t("Enums.Serenity.SummaryType."+o))&&void 0!==r?r:o,l=i(e,t[n][e.field]);return"<span class='aggregate agg-"+n+"'  title='"+Ft(a)+"'>"+l+"</span>"}function i(t,e){var i,r,o,a=null!==(i=t.format)&&void 0!==i?i:t.formatter?n.convertCompatFormatter(t.formatter):null;if(null!=a){var l=new n.NonDataRow;l[t.field]=e;try{return a({column:t,escape:n.escape,item:l,value:e})}catch(t){}}return Ft("number"==typeof e?ze(e,null!==(o=null===(r=t.sourceItem)||void 0===r?void 0:r.displayFormat)&&void 0!==o?o:"#,##0.##"):e)}t.formatMarkup=e,t.formatValue=i,t.groupTotalsFormatter=function(t,n){if(!t||!n)return"";var i=null
;return["sum","avg","min","max","cnt"].forEach((function(r){if(null==i&&t[r]&&null!=t[r][n.field])return i=e(t,n,r),!1})),i||""}}(t.AggregateFormatting||(t.AggregateFormatting={}));var li=function(e){var i,r,o=this;null!=n.gridDefaults&&void 0===n.gridDefaults.groupTotalsFormatter&&(n.gridDefaults.groupTotalsFormatter=t.AggregateFormatting.groupTotalsFormatter);var a,l,s,u,c,h,f,g,v=[],y=[],m={},_=null,b=null,C=null,w=0,S=!0,k={},x={},I=[],T=[],D={getter:null,formatter:null,comparer:function(t,e){return t.value===e.value?0:t.value>e.value?1:-1},predefinedValues:[],aggregateEmpty:!1,aggregateCollapsed:!1,aggregateChildGroups:!1,collapsed:!1,displayTotalsRow:!0,lazyTotalsCalculation:!1
},F={},P=[],O=[],E=[],A=":|:",N=1,M=0,R=new n.EventEmitter,B=new n.EventEmitter,L=new n.EventEmitter,V=new n.EventEmitter,q=new n.EventEmitter,H=new n.EventEmitter,G=new n.EventEmitter,z=new n.EventEmitter,j=new n.EventEmitter,U=!1,W=null,K=0,Q=0,Y=null,J=e.groupItemMetadataProvider,X=null!==(i=e.localSort)&&void 0!==i&&i;function Z(t){for(var e,n=t=t||0,i=v.length;n<i;n++){if(void 0===(e=v[n][r])){var o="Each data element must implement a unique '"+r+"' property. Object at index '"+n+"' has no identity value: ";throw o+=$.toJSON(v[n])}m[e]=n}}function tt(t,e){null!=e&&"string"==typeof e&&(r=e),v=I=t,X&&v.sort(nt()),m={},_=null,F.totals={},Z(),function(){for(var t,e=0,n=v.length;e<n;e++)if(void 0===(t=v[e][r])||m[t]!==e){var i="Each data element must implement a unique '"+r+"' property. Object at index '"+e+"' ";throw(i+=null==t?"has no identity value: ":"has repeated identity value '"+t+"': ")+$.toJSON(v[e])}}(),w?It(v):Tt(),R.notify({dataView:o},null,o)}function et(){return{
rowsPerPage:g.rowsPerPage,page:N,totalCount:Y,loading:U,error:W,dataView:g}}function nt(){if(null!=l)return l;for(var t=[],e=[],n=0,i=g.sortBy||[];n<i.length;n++){var r=i[n];null!=r&&(r.length>5&&" desc"==r.toLowerCase().substr(r.length-5).toLowerCase()?(e.push(!1),t.push(r.substr(0,r.length-5))):(e.push(!0),t.push(r)))}return function(n,i){for(var r=0,o=t.length;r<o;r++){var a=t[r],l=e[r]?1:-1,s=n[a],u=i[a],c=(s==u?0:s>u?1:-1)*l;if(0!=c)return c}return 0}}function it(t,e){S=e,a=null,!1===e&&v.reverse(),l=t,v.sort(nt()),!1===e&&v.reverse(),m={},Z(),Tt()}function rt(t,e){S=e,a=t,l=null;var n=Object.prototype.toString;Object.prototype.toString="function"==typeof t?t:function(){return this[t]},!1===e&&v.reverse(),v.sort(),Object.prototype.toString=n,!1===e&&v.reverse(),m={},Z(),Tt()}function ot(t){J||(J=new n.GroupItemMetadataProvider),O=[],E=[],P=(t=t||[])instanceof Array?t:[t];for(var e=0;e<P.length;e++){var i=P[e]=d(d({},D),p(P[e]));i.aggregators=i.aggregators||F.aggregators||[],
i.getterIsAFn="function"==typeof i.getter,i.compiledAccumulators=[];for(var r=i.aggregators.length;r--;)i.compiledAccumulators[r]=wt(i.aggregators[r]);E[e]={}}Tt()}function at(){if(!_){_={};for(var t=0,e=y.length;t<e;t++)_[y[t][r]]=t}}function lt(t){return v[m[t]]}function st(t,e){if(void 0===m[t])throw new Error("Invalid id");if(t!==e[r]){var n=e[r];if(null==n)throw new Error("Cannot update item to associate with a null id");if(void 0!==m[n])throw new Error("Cannot update item to associate with a non-unique id");m[n]=m[t],delete m[t],C&&C[t]&&delete C[t],t=n}v[m[t]]=e,C||(C={}),C[t]=!0,Tt()}function ut(t,e){v.splice(t,0,e),Z(t),Tt()}function ct(t){var e=m[t];if(void 0===e)throw"Invalid id";delete m[t],v.splice(e,1),Z(e),Tt()}function dt(t){ut(function(t){for(var e=0,n=v.length,i=nt();e<n;){var r=e+n>>>1;-1===i(v[r],t)?e=r+1:n=r}return e}(t),t)}function pt(t,e){if(null==t)for(var n=0;n<P.length;n++)E[n]={},P[n].collapsed=e,!0===e?q.notify({level:n,groupingKey:null}):V.notify({level:n,
groupingKey:null});else E[t]={},P[t].collapsed=e,!0===e?q.notify({level:t,groupingKey:null}):V.notify({level:t,groupingKey:null});Tt()}function ht(t,e){var n=function(t){var e=t[0];return 1===t.length&&-1!==e.indexOf(A)?{level:e.split(A).length-1,groupingKey:e}:{level:t.length-1,groupingKey:t.join(A)}}(t);E[n.level][n.groupingKey]=P[n.level].collapsed^e,e?q.notify({level:n.level,groupingKey:n.groupingKey}):V.notify({level:n.level,groupingKey:n.groupingKey}),Tt()}function ft(t,e,i,r,o){var a=t[e];return a||((a=new n.Group).value=e,a.level=i,a.groupingKey=(r?r.groupingKey+A:"")+e,o[o.length]=a,t[e]=a),a}function gt(t,e){for(var n,i,r=[],o={},a=e?e.level+1:0,l=P[a],s=0,u=l.predefinedValues.length;s<u;s++)n=ft(o,l.predefinedValues[s],a,e,r);for(s=0,u=t.length;s<u;s++)i=t[s],(n=ft(o,l.getterIsAFn?l.getter(i):i[l.getter],a,e,r)).rows[n.count++]=i;if(a<P.length-1)for(s=0;s<r.length;s++)(n=r[s]).groups=gt(n.rows,n);return r.length&&_t(r,a),r.sort(P[a].comparer),r}function yt(t){
var e,n=t.group,i=P[n.level],r=n.level==P.length,o=i.aggregators.length;if(!r&&i.aggregateChildGroups)for(var a=n.groups.length;a--;)n.groups[a].totals.initialized||yt(n.groups[a].totals);for(;o--;)(e=i.aggregators[o]).init(),!r&&i.aggregateChildGroups?i.compiledAccumulators[o].call(e,n.groups):i.compiledAccumulators[o].call(e,n.rows),e.storeResult(t);t.initialized=!0}function mt(t){var e=P[t.level],i=new n.GroupTotals;i.group=t,t.totals=i,e.lazyTotalsCalculation||yt(i)}function _t(t,e){for(var n,i=P[e=e||0],r=i.collapsed,o=E[e],a=t.length;a--;)(n=t[a]).collapsed&&!i.aggregateCollapsed||(n.groups&&_t(n.groups,e+1),i.aggregators.length&&(i.aggregateEmpty||n.rows.length||n.groups&&n.groups.length)&&mt(n),n.collapsed=r^o[n.groupingKey],n.title=i.formatter?i.formatter(n):Ft(n.value))}function bt(t,e){for(var n,i,r=P[e=e||0],o=[],a=0,l=0,s=t.length;l<s;l++){if(i=t[l],o[a++]=i,!i.collapsed)for(var u=0,c=(n=i.groups?bt(i.groups,e+1):i.rows).length;u<c;u++)o[a++]=n[u]
;i.totals&&r.displayTotalsRow&&(!i.collapsed||r.aggregateCollapsed)&&(o[a++]=i.totals)}return o}function Ct(t){var e=t.toString().match(/^function[^(]*\(([^)]*)\)\s*{([\s\S]*)}$/);return{params:e[1].split(","),body:e[2]}}function wt(t){var e=Ct(t.accumulate);return new Function("_items","for (var "+e.params[0]+", _i=0, _il=_items.length; _i<_il; _i++) {"+e.params[0]+" = _items[_i]; "+e.body+"}")}function St(t,e){for(var n=[],i=0,r=0,o=t.length;r<o;r++)b(t[r],e)&&(n[i++]=t[r]);return n}function kt(t,e,n){for(var i,r=[],o=0,a=0,l=t.length;a<l;a++)i=t[a],n[a]?r[o++]=i:b(i,e)&&(r[o++]=i,n[a]=!0);return r}function xt(t){if(b){var n=e.inlineFilters?u:St,i=e.inlineFilters?c:kt;k.isFilterNarrowing?I=n(I,s):k.isFilterExpanding?I=i(t,s,T):k.isFilterUnchanged||(I=n(t,s))}else I=t.concat();return{totalRows:I.length,rows:I}}function It(t){_=null,k.isFilterNarrowing==x.isFilterNarrowing&&k.isFilterExpanding==x.isFilterExpanding||(T=[]);var e=xt(t);M=e.totalRows;var n=e.rows;F.totals={},O=[],
P.length&&(O=gt(n)).length&&(n=bt(O));var i=function(t,e){var n,i,o,a=[],l=0,s=e.length;k&&k.ignoreDiffsBefore&&(l=Math.max(0,Math.min(e.length,k.ignoreDiffsBefore))),k&&k.ignoreDiffsAfter&&(s=Math.min(e.length,Math.max(0,k.ignoreDiffsAfter)));for(var u=l,c=t.length;u<s;u++)u>=c?a[a.length]=u:(n=e[u],i=t[u],(P.length&&(o=n.__nonDataRow||i.__nonDataRow)&&n.__group!==i.__group||n.__group&&!n.equals(i)||o&&(n.__groupTotals||i.__groupTotals)||n[r]!=i[r]||C&&C[n[r]])&&(a[a.length]=u));return a}(y,n);return y=n,i}function Tt(){if(!w){var t=y.length,e=M,n=It(v);C=null,x=k,k={},e!==M&&H.notify(et(),null,o),t!==y.length&&G.notify({previous:t,current:y.length,dataView:o},null,o),n.length>0&&z.notify({rows:n,dataView:o},null,o),(t!==y.length||n.length>0)&&j.notify({rowsDiff:n,previousRowCount:t,currentRowCount:y.length,rowCountChanged:t!==y.length,rowsChanged:n.length>0,dataView:o},null,o)}}function Dt(t){if(g.onProcessData&&t&&(t=g.onProcessData(t,g)||t),W=null,U&&U.abort(),U=!1,
!t)return W=g.errormsg,H.notify(et()),!1;t.TotalCount=t.TotalCount||0,t.Entities=t.Entities||[],t.Skip&&(g.rowsPerPage||t.Take)?t.Page=Math.ceil(t.Skip/(t.Take||g.rowsPerPage))+1:t.Page=1,N=t.Page,Y=t.TotalCount,tt(t.Entities),H.notify(et())}function Pt(){if(K>0)Q++;else{if(Q=0,U&&U.abort(),g.onSubmit&&!1===g.onSubmit(g))return!1;if(B.notify(this),!g.url)return!1;g.seekToPage||(g.seekToPage=1);var t={},e=(g.seekToPage-1)*g.rowsPerPage;e&&(t.Skip=e),g.rowsPerPage&&(t.Take=g.rowsPerPage),g.sortBy&&g.sortBy.length&&("string"!=typeof g.sortBy?t.Sort=g.sortBy:t.Sort=[g.sortBy]),g.params&&(t=d(t,g.params));var n=f,i={cache:!1,type:g.method,contentType:h,url:g.url,data:t,dataType:n,success:function(t){U=!1,t.Error?qt(t.Error.Message||t.Error.Code):Dt(t),L.notify(this)},error:function(t,e,n){if(U=!1,(t.getResponseHeader("content-type")||"").toLowerCase().indexOf("application/json")>=0){var i=$.parseJSON(t.responseText);if(null!=i&&null!=i.Error)return qt(i.Error.Message||i.Error.Code),
H.notify(et()),void L.notify(this)}W=t.errormsg,H.notify(et()),L.notify(this)},complete:function(){U=!1}};if(g.onAjaxCall&&!1===g.onAjaxCall(this,i))return U=!1,H.notify(et()),!1;i.data=$.toJSON(i.data),H.notify(et()),U=$.ajax(i)}}return r=e.idField||"id",h=e.contentType||"application/json",f=e.dataType||"json",b=e.filter||null,g={beginUpdate:function(){w++},endUpdate:function(){--w<=0&&Tt()},setPagingOptions:function(t){var e,n=!1;null!=t.rowsPerPage&&g.rowsPerPage!=t.rowsPerPage&&(g.rowsPerPage=t.rowsPerPage,n=!0),null!=t.page&&((e=g.rowsPerPage?null==Y?t.page:Math.min(t.page,Math.ceil(Y/g.rowsPerPage)+1):1)<1&&(e=1),e!=N&&(g.seekToPage=e,n=!0)),n&&Pt()},getPagingInfo:et,getIdPropertyName:function(){return r},getRows:function(){return y},getItems:function(){return v},setItems:tt,getFilter:function(){return b},getFilteredItems:function(){return I},setFilter:function(t){b=t,e.inlineFilters&&(u=function(){
var t=Ct(b),e=t.body.replace(/return false\s*([;}]|$)/gi,"{ continue _coreloop; }$1").replace(/return true\s*([;}]|$)/gi,"{ _retval[_idx++] = $item$; continue _coreloop; }$1").replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ($1) { _retval[_idx++] = $item$; }; continue _coreloop; }$2"),n=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","$filter$; ","} ","return _retval; "].join("");n=(n=(n=n.replace(/\$filter\$/gi,e)).replace(/\$item\$/gi,t.params[0])).replace(/\$args\$/gi,t.params[1]);var i=new Function("_items,_args",n);return i.displayName=i.name="compiledFilter",i}(),c=function(){
var t=Ct(b),e=t.body.replace(/return false\s*([;}]|$)/gi,"{ continue _coreloop; }$1").replace(/return true\s*([;}]|$)/gi,"{ _cache[_i] = true;_retval[_idx++] = $item$; continue _coreloop; }$1").replace(/return ([^;}]+?)\s*([;}]|$)/gi,"{ if ((_cache[_i] = $1)) { _retval[_idx++] = $item$; }; continue _coreloop; }$2"),n=["var _retval = [], _idx = 0; ","var $item$, $args$ = _args; ","_coreloop: ","for (var _i = 0, _il = _items.length; _i < _il; _i++) { ","$item$ = _items[_i]; ","if (_cache[_i]) { ","_retval[_idx++] = $item$; ","continue _coreloop; ","} ","$filter$; ","} ","return _retval; "].join("");n=(n=(n=n.replace(/\$filter\$/gi,e)).replace(/\$item\$/gi,t.params[0])).replace(/\$args\$/gi,t.params[1]);var i=new Function("_items,_args,_cache",n),r="compiledFilterWithCaching";return i.displayName=r,i.name=function(t,e){try{Object.defineProperty(t,"name",{writable:!0,value:e})}catch(n){t.name=e}}(i,r),i}()),Tt()},sort:it,fastSort:rt,reSort:function(){a?rt(a,S):it(l,S)},
getLocalSort:function(){return X},setLocalSort:function(t){X!=t&&(X=t,it())},setSummaryOptions:function(t){t=t||{},F.aggregators=t.aggregators||[],F.compiledAccumulators=[],F.totals={};for(var e=F.aggregators.length;e--;)F.compiledAccumulators[e]=wt(F.aggregators[e]);ot(P||[])},getGrandTotals:function(){if(F.totals=F.totals||{},!F.totals.initialized){F.aggregators=F.aggregators||[],F.compiledAccumulators=F.compiledAccumulators||[];for(var t,e=F.aggregators.length;e--;)(t=F.aggregators[e]).init(),F.compiledAccumulators[e].call(t,v),t.storeResult(F.totals);F.totals.initialized=!0}return F.totals},setGrouping:ot,getGrouping:function(){return P},collapseAllGroups:function(t){pt(t,!0)},expandAllGroups:function(t){pt(t,!1)},collapseGroup:function(t){var e=Array.prototype.slice.call(arguments);ht(e,!0)},expandGroup:function(t){var e=Array.prototype.slice.call(arguments);ht(e,!1)},getGroups:function(){return O},getIdxById:function(t){return m[t]},getRowByItem:function(t){return at(),_[t[r]]},
getRowById:function(t){return at(),_[t]},getItemById:lt,getItemByIdx:function(t){return v[t]},mapItemsToRows:function(t){var e=[];at();for(var n=0,i=t.length;n<i;n++){var o=_[t[n][r]];null!=o&&(e[e.length]=o)}return e},mapRowsToIds:function(t){for(var e=[],n=0,i=t.length;n<i;n++)t[n]<y.length&&(e[e.length]=y[t[n]][r]);return e},mapIdsToRows:function(t){var e=[];at();for(var n=0,i=t.length;n<i;n++){var r=_[t[n]];null!=r&&(e[e.length]=r)}return e},setRefreshHints:function(t){k=t},setFilterArgs:function(t){s=t},refresh:Tt,updateItem:st,insertItem:ut,addItem:function(t){v.push(t),Z(v.length-1),Tt()},deleteItem:ct,sortedAddItem:dt,sortedUpdateItem:function(t,e){if(void 0===m[t]||t!==e[r])throw new Error("Invalid or non-matching id "+m[t]);0!==nt()(lt(t),e)?(ct(t),dt(e)):st(t,e)},syncGridSelection:function(t,e,i){var r,o=this,a=o.mapRowsToIds(t.getSelectedRows()),l=new n.EventEmitter;function s(e){a.join(",")!=e.join(",")&&(a=e,l.notify({grid:t,ids:a,dataView:o},new n.EventData,o))}
function u(){if(a.length>0){r=!0;var n=o.mapIdsToRows(a);e||s(o.mapRowsToIds(n)),t.setSelectedRows(n),r=!1}}return t.onSelectedRowsChanged.subscribe((function(e,n){if(!r){var l=o.mapRowsToIds(t.getSelectedRows());i&&t.getOptions().multiSelect?s($.grep(a,(function(t){return void 0===o.getRowById(t)})).concat(l)):s(l)}})),this.onRowsChanged.subscribe(u),this.onRowCountChanged.subscribe(u),l},syncGridCellCssStyles:function(t,e){var n,i;function o(t){for(var e in n={},t){var i=y[e][r];n[i]=t[e]}}function a(){if(n){i=!0,at();var r={};for(var o in n){var a=_[o];null!=a&&(r[a]=n[o])}t.setCellCssStyles(e,r),i=!1}}o(t.getCellCssStyles(e));var l=function(n,r){i||e==r.key&&(r.hash?o(r.hash):(t.onCellCssStylesChanged.unsubscribe(l),j.unsubscribe(a)))};t.onCellCssStylesChanged.subscribe(l),j.subscribe(a)},getLength:function(){return y.length},getItem:function(t){var e=y[t];if(e&&e.__group&&e.totals&&!e.totals.initialized){var n=P[e.level];n.displayTotalsRow||(yt(e.totals),
e.title=n.formatter?n.formatter(e):Ft(e.value))}else e&&e.__groupTotals&&!e.initialized&&yt(e);return e},getItemMetadata:function(t){var n=y[t];return void 0===n?null:n.__group?J.getGroupRowMetadata(n):n.__groupTotals?J.getTotalsRowMetadata(n):e.getItemMetadata&&e.getItemMetadata(n,t)||null},getGroupItemMetadataProvider:function(){return J},setGroupItemMetadataProvider:function(t){J=t},onRowCountChanged:G,onRowsChanged:z,onRowsOrCountChanged:j,onPagingInfoChanged:H,onGroupExpanded:V,onGroupCollapsed:q,addData:Dt,populate:Pt,populateLock:function(){0==K&&(Q=0),K++},populateUnlock:function(){K>0&&0==--K&&Q>0&&Pt()},onDataChanged:R,onDataLoaded:L,onDataLoading:B,params:e.params||{},onSubmit:e.onSubmit||null,url:e.url||null,rowsPerPage:e.rowsPerPage||0,seekToPage:e.seekToPage||1,onAjaxCall:e.onAjaxCall||null,onProcessData:e.onProcessData||null,method:e.method||"POST",errormsg:vt("Controls.Pager.DefaultLoadError"),sortBy:"string"==typeof e.sortBy?[e.sortBy]:e.sortBy||[],idField:r},
e.url&&e.autoLoad&&Pt(),g};function si(t){return function(e){return K(e,"Serenity."+t+"Attribute")}}var ui=function(){function t(t){this.value=t}return t=e.__decorate([si("EnumKey")],t)}(),ci=function(){function t(t){this.displayName=t}return t=e.__decorate([si("DisplayName")],t)}(),di=function(){function t(t){this.category=t}return t=e.__decorate([si("Category")],t)}(),pi=function(){function t(t){this.value=t}return t=e.__decorate([si("ColumnsKey")],t)}(),hi=function(){function t(t){this.cssClass=t}return t=e.__decorate([si("CssClass")],t)}(),fi=function(){function t(t){this.value=t}return t=e.__decorate([si("DefaultValue")],t)}(),gi=function(){function t(t){this.value=t}return t=e.__decorate([si("DialogType")],t)}(),vi=function(){function t(t,e){this.key=t,this.value=e}return t=e.__decorate([si("EditorOption")],t)}(),yi=function(){function t(t){this.editorType=t}return t.prototype.setParams=function(t){},t}();K(yi,"Serenity.EditorTypeAttributeBase");var mi=function(t){function n(e){
return t.call(this,e)||this}return e.__extends(n,t),n=e.__decorate([si("EditorType")],n)}(yi),_i=function(){function t(t){this.value=t}return t=e.__decorate([si("Element")],t)}(),bi=function(){function t(t){this.value=t}return t=e.__decorate([si("EntityType")],t)}(),Ci=function(){function t(t){void 0===t&&(t=!0),this.value=t}return t=e.__decorate([si("Filterable")],t)}(),wi=function(){function t(t){void 0===t&&(t=!0),this.value=t}return t=e.__decorate([si("Flexify")],t)}(),Si=function(){function t(t){this.value=t}return t=e.__decorate([si("FormKey")],t)}(),ki=function(){function t(t){this.origin=t}return t=e.__decorate([si("GeneratedCode")],t)}(),xi=function(){function t(){}return t=e.__decorate([si("Hidden")],t)}(),Ii=function(){function t(t){this.hint=t}return t=e.__decorate([si("Hint")],t)}(),Ti=function(){function t(t){this.value=t}return t=e.__decorate([si("IdProperty")],t)}(),Di=function(){function t(t){void 0===t&&(t=!0),this.value=t}return t=e.__decorate([si("Insertable")],t)
}(),Fi=function(){function t(t){this.value=t}return t=e.__decorate([si("IsActiveProperty")],t)}(),Pi=function(){function t(t){this.value=t}return t=e.__decorate([si("ItemName")],t)}(),Oi=function(){function t(t){this.value=t}return t=e.__decorate([si("LocalTextPrefix")],t)}(),Ei=function(){function t(t){void 0===t&&(t=!0),this.value=t}return t=e.__decorate([si("Maximizable")],t)}(),Ai=function(){function t(t){this.maxLength=t}return t=e.__decorate([si("MaxLength")],t)}(),Ni=function(){function t(t){this.value=t}return t=e.__decorate([si("NameProperty")],t)}(),Mi=function(){function t(){}return t=e.__decorate([si("OneWay")],t)}(),Ri=function(){function t(){}return t=e.__decorate([si("Option")],t)}(),Bi=function(){function t(t){this.value=t}return t=e.__decorate([si("OptionsType")],t)}(),Li=function(){function t(t){void 0===t&&(t=!0),this.value=t}return t=e.__decorate([si("Panel")],t)}(),$i=function(){function t(t){this.value=t}return t=e.__decorate([si("Placeholder")],t)
}(),Vi=function(){function t(t){void 0===t&&(t=!0),this.value=t}return t=e.__decorate([si("ReadOnly")],t)}(),qi=function(){function t(t){void 0===t&&(t=!0),this.isRequired=t}return t=e.__decorate([si("Required")],t)}(),Hi=function(){function t(t){void 0===t&&(t=!0),this.value=t}return t=e.__decorate([si("Resizable")],t)}(),Gi=function(){function t(t){void 0===t&&(t=!0),this.value=t}return t=e.__decorate([si("Responsive")],t)}(),zi=function(){function t(t){this.value=t}return t=e.__decorate([si("Service")],t)}(),ji=function(){function t(t){void 0===t&&(t=!0),this.value=t}return t=e.__decorate([si("Updatable")],t)}();t.Decorators=void 0,function(e){function n(t,e){return function(n){"string"==typeof t?K(n,t,e):K(n,null,t)}}function i(t,e,n){Y(t,n,e),e&&X(t,new ui(e))}e.registerClass=n,e.registerInterface=function(t,e){return function(n){"string"==typeof t?J(n,t,e):J(n,null,t)}},e.registerEditor=function(t,e){return function(n){"string"==typeof t?Q(n,t,e):Q(n,null,t)}},e.registerEnum=i,
e.registerEnumType=function(t,e,n){i(t,null!=n?n:e,e)},e.registerFormatter=function(t,e){return void 0===t&&(t=[Z]),void 0===e&&(e=[Z]),n(t,e)},e.enumKey=function(t){return function(e){X(e,new ui(t))}},e.option=function(){return function(e,n){var i=ut(n,"get_")||ut(n,"set_"),r=i?n.substr(4):n;O(e.constructor,{name:r,attr:[new Ri],type:i?t.MemberType.property:t.MemberType.field,getter:i?"get_"+r:null,setter:i?"set_"+r:null})}},e.dialogType=function(t){return function(e){X(e,new gi(t))}},e.editor=function(){return function(t){X(t,new tt)}},e.element=function(t){return function(e){X(e,new _i(t))}},e.filterable=function(t){return void 0===t&&(t=!0),function(e){X(e,new Ci(t))}},e.flexify=function(t){return void 0===t&&(t=!0),function(e){X(e,new wi(t))}},e.itemName=function(t){return function(e){X(e,new Pi(t))}},e.maximizable=function(t){return void 0===t&&(t=!0),function(e){X(e,new Ei(t))}},e.optionsType=function(t){return function(e){X(e,new Bi(t))}},e.panel=function(t){
return void 0===t&&(t=!0),function(e){X(e,new Li(t))}},e.resizable=function(t){return void 0===t&&(t=!0),function(e){X(e,new Hi(t))}},e.responsive=function(t){return void 0===t&&(t=!0),function(e){X(e,new Gi(t))}},e.service=function(t){return function(e){X(e,new zi(t))}}}(t.Decorators||(t.Decorators={}));var Ui,Wi,Ki,Qi=function(){function n(){}return n=e.__decorate([t.Decorators.registerInterface("Serenity.IBooleanValue")],n)}(),Yi=function(){function n(){}return n=e.__decorate([t.Decorators.registerInterface("Serenity.IDoubleValue")],n)}(),Ji=function(){function n(){}return n=e.__decorate([t.Decorators.registerInterface("Serenity.IDialog")],n)}(),Xi=function(){function n(){}return n=e.__decorate([t.Decorators.registerInterface("Serenity.IEditDialog")],n)}(),Zi=function(){function n(){}return n=e.__decorate([t.Decorators.registerInterface("Serenity.IGetEditValue")],n)}(),tr=function(){function n(){}return n=e.__decorate([t.Decorators.registerInterface("Serenity.IReadOnly")],n)
}(),er=function(){function n(){}return n=e.__decorate([t.Decorators.registerInterface("Serenity.ISetEditValue")],n)}(),nr=function(){function n(){}return n=e.__decorate([t.Decorators.registerInterface("Serenity.IStringValue")],n)}(),ir=function(){function n(){}return n=e.__decorate([t.Decorators.registerInterface("Serenity.IValidateRequired")],n)}();function rr(t,e,n){var i;function r(e){var n=m(e);if(null!=n&&t(n))return n;for(var r=0,o=Gt.rootNamespaces;r<o.length;r++){var a=o[r];if(n=i[a+"."+e])return n;if(null!=(n=m(a+"."+e))&&t(n))return n}}return{reset:function(){i=null},tryGet:function(o){var a,l;if(!o)return null;if(null==i&&function(){i={};for(var r=0,o=E();r<o.length;r++){var a=o[r];if(t(a)){var l=_(a);i[l]=a;var s=e&&e(a);s&&s!==l&&(i[s]=a)}}if(n)for(var u=0,c=Object.keys(i);u<c.length;u++){var d=c[u];if(d.endsWith(n)){var p=d.substring(0,d.length-n.length);p&&!i[p]&&(i[p]=i[d])}}}(),l=i[o])return l;if(null==(l=r(o))&&n&&!ot(o,n)&&(l=null!==(a=i[o+n])&&void 0!==a?a:r(o+n)),
l){i[o]=l;var s=e&&e(l);if(s&&o!=s&&(i[s]=l),n&&o.endsWith(n)){var u=o.substring(0,o.length-n.length);u&&!i[u]&&(i[u]=i[o])}return l}return l}}}function or(){var t,e,n="undefined"!=typeof global?global:"undefined"!=typeof window?window:"undefined"!=typeof self?self:null;"undefined"==typeof React&&void 0!==n&&(null!=n.preact?(n.React=n.ReactDOM=n.preact,React.Fragment=null!==(t=React.Fragment)&&void 0!==t?t:"x-fragment"):null!=n.Nerv?(n.React=n.ReactDOM=n.Nerv,React.Fragment=null!==(e=React.Fragment)&&void 0!==e?e:"x-fragment"):(n.React={Component:function(){},Fragment:"x-fragment",createElement:function(){return{_reactNotLoaded:!0}}},n.ReactDOM={render:function(){throw Error("To use React, it should be included before Serenity.CoreLib.js")}}))}t.CaptureOperationType=void 0,(Ui=t.CaptureOperationType||(t.CaptureOperationType={}))[Ui.Before=0]="Before",Ui[Ui.Delete=1]="Delete",Ui[Ui.Insert=2]="Insert",Ui[Ui.Update=3]="Update",Y(t.CaptureOperationType,"Serenity.CaptureOperationType"),
t.ReflectionUtils=void 0,function(t){function e(t){if(at(t))return t;if("ID"===t)return"id";for(var e=!1,n=0,i=0;i<t.length;i++){if(!(t.charCodeAt(i)>=65&&t.charCodeAt(i)<=90)){e=!0;break}n++}return!e&&1!==t.length||0===n?t:n>1?t.substr(0,n-1).toLowerCase()+t.substr(n-1):1===t.length?t.toLowerCase():t.substr(0,1).toLowerCase()+t.substr(1)}t.getPropertyValue=function(t,n){var i=t,r=i["get_"+n];if(void 0!==r)return r.apply(t);var o=e(n);return void 0!==(r=i["get_"+o])?r.apply(t):i[o]},t.setPropertyValue=function(t,n,i){var r=t,o=r["set_"+n];if(void 0===o){var a=e(n);void 0===(o=r["set_"+a])?r[a]=i:o.apply(t,[i])}else o.apply(t,[i])},t.makeCamelCase=e}(t.ReflectionUtils||(t.ReflectionUtils={})),t.DialogTypeRegistry=void 0,Wi=t.DialogTypeRegistry||(t.DialogTypeRegistry={}),Ki=rr((function(t){return k(Ji,t)}),null,"Dialog"),Wi.get=function(t){if(at(t))throw new it("key");var e=Ki.tryGet(t);if(e)return e
;var n='"'.concat(Ft(t),'" dialog class not found! \nMake sure there is such a dialog type under the project root namespace, \nand its namespace parts start with capital letters like MyProject.MyModule.MyDialog.\n\nIf using ES modules, make sure the dialog type has a decorator like \n@Decorators.registerClass(\'MyProject.MyModule.MyDialog\') with the full name\nand "side-effect-import" this dialog class from the current \n"page.ts/grid.ts/dialog.ts file (import "./path/to/MyDialog.ts").\n\nIf you had this error from an editor with the InplaceAdd option, verify that the lookup key\nand dialog type name match case-sensitively, excluding the Dialog suffix.\nSpecify the DialogType property in the LookupEditor attribute if it is not.\n\nAfter applying fixes, build and run "node ./tsbuild.js" (or "tsc" if using namespaces) \nfrom the project folder.');throw qt(n.replace(/\r?\n\r?\n/g,"<br/><br/>"),"",{escapeHtml:!1,timeOut:5e3}),new nt(n)},Wi.reset=function(){Ki.reset()},
Wi.tryGet=function(t){return Ki.tryGet(t)},or();var ar,lr=function(){function n(t,e){var n=this;if(this.element=t,this.options=e||{},this.widgetName=i.getWidgetName(S(this)),this.uniqueName=this.widgetName+(i.nextWidgetNumber++).toString(),t.data(this.widgetName))throw new nt(qe("The element already has widget '{0}'!",this.widgetName));t.on("remove."+this.widgetName,(function(t){t.bubbles||t.cancelable||n.destroy()})).data(this.widgetName,this),this.addCssClass(),this.idPrefix=this.uniqueName+"_",this.renderContents()}var i;return i=n,n.prototype.destroy=function(){this.element&&(this.element.removeClass(this.getCssClass()),this.element.off("."+this.widgetName).off("."+this.uniqueName).removeData(this.widgetName),this.element=null)},n.prototype.addCssClass=function(){this.element.addClass(this.getCssClass())},n.prototype.getCssClass=function(){var t=S(this),e=[],n=ft(C(t),".","-");e.push(n);for(var i=0,r=Gt.rootNamespaces;i<r.length;i++){var o=r[i];if(ut(n,o+"-")){
e.push(n.substr(o.length+1));break}}return e.push(w(t)),e.filter((function(t,e,n){return n.indexOf(t)===e})).map((function(t){return"s-"+t})).join(" ")},n.getWidgetName=function(t){return ft(C(t),".","_")},n.elementFor=function(t){var e=F(t,_i,!0),n=e.length>0?e[0].value:"<input/>";return St(n)},n.prototype.addValidationRule=function(t,e){return Kn(this.element,t,e)},n.prototype.getGridField=function(){return this.element.closest(".field")},n.prototype.change=function(t){this.element.on("change."+this.uniqueName,t)},n.prototype.changeSelect2=function(t){this.element.on("change."+this.uniqueName,(function(e,n){!0!==n&&t(e)}))},n.create=function(t){var e;if(k(Ji,t.type))e=new t.type(t.options),t.container&&e.element.appendTo(t.container),t.element&&t.element(e.element);else{var n=i.elementFor(t.type);t.container&&n.appendTo(t.container),t.element&&t.element(n),e=new t.type(n,t.options)}return e.init(null),t.init&&t.init(e),e},n.prototype.initialize=function(){},
n.prototype.init=function(t){return t&&t(this),this},n.prototype.renderContents=function(){},n.nextWidgetNumber=0,n.__isWidgetType=!0,n=i=e.__decorate([t.Decorators.registerClass("Serenity.Widget")],n)}();void 0!==St&&St.fn&&(St.fn.tryGetWidget=function(t){var e;if(k(lr,t)){var n=lr.getWidgetName(t);if(null==(e=this.data(n))||k(t,S(e))||(e=null),null!=e)return e}var i=this.data();if(null==i)return null;for(var r=0,o=Object.keys(i);r<o.length;r++){if(null!=(e=i[o[r]])&&k(t,S(e)))return e}return null},St.fn.getWidget=function(t){if(null==this)throw new it("element");if(0===this.length)throw new nt(qe("Searching for widget of type '{0}' on a non-existent element! ({1})",C(t),this.selector));var e=this.tryGetWidget(t);if(null==e){
var n=qe("Element has no widget of type '{0}'! If you have recently changed editor type of a property in a form class, or changed data type in row (which also changes editor type) your script side Form definition might be out of date. Make sure your project builds successfully and transform T4 templates",C(t));throw qt(n,"",null),new nt(n)}return e}),"function"==typeof St&&function(t){function e(){if(void 0===t||!t.ui||!t.ui.dialog||!t.ui.dialog.prototype)return!1;var e;t.ui.dialog.prototype._allowInteraction=function(e){return!!t(e.target).closest(".ui-dialog").length||!!t(e.target).closest(".ui-datepicker, .select2-drop, .cke, .cke_dialog, .modal, #support-modal").length},e=t.ui.dialog.prototype._focusTabbable,t.ui.dialog.prototype._focusTabbable=function(){En?this.uiDialog&&this.uiDialog.focus():e.call(this)},function(e){t.ui.dialog.prototype._createTitlebar=function(){e.call(this),this.uiDialogTitlebar.find(".ui-dialog-titlebar-close").html('<i class="fa fa-times" />')}
}(t.ui.dialog.prototype._createTitlebar)}var n;!e()&&void 0!==t&&t.fn&&t(e),void 0!==t&&t.fn&&(t.toJSON||(t.toJSON=JSON.stringify),t.parseJSON||(t.parseJSON=JSON.parse),t.cleanData=(n=t.cleanData,function(e){var i,r,o,a=e;for(o=0;null!=(r=a[o]);o++)try{(i=t._data(r,"events"))&&i.remove&&(a===e&&(a=Array.prototype.slice.call(e)),t(r).triggerHandler("remove"),delete i.remove)}catch(t){}n(e)}))}(St),t.EditorTypeRegistry=void 0,function(t){var e=rr((function(t){return!!F(t,tt).length||k(lr,t)}),null,"Editor");t.get=function(t){if(at(t))throw new it("key");var n=e.tryGet(t);if(n)return n
;var i='"'.concat(Ft(t),'" editor class not found! \nMake sure there is such a editor type under the project root namespace,\nand its namespace parts start with capital letters like MyProject.MyModule.MyEditor.\n\nIf using ES modules, make sure the editor type has a decorator like \n@Decorators.registerEditor(\'MyProject.MyModule.MyFormatter\') with the full name \nand "side-effect-import" this editor class from the current \n"page.ts/grid.ts/dialog.ts file (import "./path/to/MyEditor.ts").\n\nAfter applying fixes, build and run "node ./tsbuild.js" (or "tsc" if using namespaces) \nfrom the project folder.');throw qt(i.replace(/\r?\n\r?\n/g,"<br/><br/>"),"",{escapeHtml:!1,timeOut:5e3}),new nt(i)},t.reset=function(){e.reset()},t.tryGet=function(t){return e.tryGet(t)}}(t.EditorTypeRegistry||(t.EditorTypeRegistry={})),t.EnumTypeRegistry=void 0,function(t){var e=rr(H,(function(t){var e;return null===(e=F(t,ui)[0])||void 0===e?void 0:e.value}),null);t.get=function(t){var n=e.tryGet(t)
;if(n)return n;var i="Can't find \"".concat(Ft(t),'" enum type! \nIf you have recently defined this enum type in server side code, make sure \nyour project builds successfully and run "dotnet sergen t". \n\nAlso verify there is such an enum type under the project root namespace, \nand its namespace parts start with capital letters like MyProject.MyModule.MyEnum.\n\nIf using ES modules, make sure the enum type is registered with \nQ.registerEnum(\'MyProject.MyModule.MyDialog\') with the full name of \nyour enum type and "side-effect-import" this enum from the current \n"page.ts/grid.ts/dialog.ts file (import "./path/to/MyEnum.ts").\n\nAfter applying fixes, build and run "node ./tsbuild.js" (or "tsc" if using namespaces) \nfrom the project folder.');throw qt(i.replace(/\r?\n\r?\n/g,"<br/><br/>"),"",{escapeHtml:!1,timeOut:5e3}),new nt(i)},t.reset=function(){e.reset()},t.tryGet=function(t){return e.tryGet(t)}}(t.EnumTypeRegistry||(t.EnumTypeRegistry={})),t.LazyLoadHelper=void 0,
(ar=t.LazyLoadHelper||(t.LazyLoadHelper={})).executeOnceWhenShown=Dn,ar.executeEverytimeWhenShown=Fn;var sr=function(){function t(t){this.idPrefix=t}return t.prototype.byId=function(t){return $("#"+this.idPrefix+t)},t.prototype.w=function(t,e){return $("#"+this.idPrefix+t).getWidget(e)},t}(),ur=function(n){function i(t,e){var i,r,o=this;return o=n.call(this,t,e)||this,t.addClass("s-PopupMenuButton"),t.click((function(t){var e,n,i,r;t.preventDefault(),t.stopPropagation(),null!=o.options.onPopup&&o.options.onPopup();var a=o.options.menu;null===(n=(e=a.show()).position)||void 0===n||n.call(e,{my:null!==(i=o.options.positionMy)&&void 0!==i?i:"left top",at:null!==(r=o.options.positionAt)&&void 0!==r?r:"left bottom",of:o.element});var l=o.uniqueName;$(document).one("click."+l,(function(t){a.hide()}))})),null===(r=(i=o.options.menu.hide().appendTo(document.body).addClass("s-PopupMenu")).menu)||void 0===r||r.call(i),o}return e.__extends(i,n),i.prototype.destroy=function(){
null!=this.options.menu&&(this.options.menu.remove(),this.options.menu=null),n.prototype.destroy.call(this)},i=e.__decorate([t.Decorators.registerEditor("Serenity.PopupMenuButton")],i)}(lr),cr=function(n){function i(t,e){var i=n.call(this,t,e)||this;return t.addClass("s-PopupToolButton"),$("<b/>").appendTo(t.children(".button-outer").children("span")),i}return e.__extends(i,n),i=e.__decorate([t.Decorators.registerEditor("Serenity.PopupToolButton")],i)}(ur),dr=function(n){function i(t,e){var i=n.call(this,t,e)||this;return i.element.addClass("s-Toolbar clearfix").html('<div class="tool-buttons"><div class="buttons-outer"><div class="buttons-inner"></div></div></div>'),i.createButtons(),i}return e.__extends(i,n),i.prototype.destroy=function(){this.element.find("div.tool-button").unbind("click"),this.mouseTrap&&(this.mouseTrap.destroy?this.mouseTrap.destroy():this.mouseTrap.reset(),this.mouseTrap=null),n.prototype.destroy.call(this)},i.prototype.createButtons=function(){
for(var t=$("div.buttons-inner",this.element).last(),e=this.options.buttons,n=0,i=0;i<e.length;i++){var r=e[i];r.separator&&n>0&&(t=$('<div class="buttons-inner"></div>').appendTo(t.parent()),n=0),this.createButton(t,r),n++}},i.prototype.createButton=function(t,e){var n,i=null!==(n=e.cssClass)&&void 0!==n?n:"",r=$('<div class="tool-button"><div class="button-outer"><span class="button-inner"></span></div></div>').appendTo(t);null!=e.action&&r.attr("data-action",e.action),"right"!==e.separator&&"both"!==e.separator||$('<div class="separator"></div>').appendTo(t),i.length>0&&r.addClass(i),at(e.hint)||r.attr("title",e.hint),r.click((function(t){r.hasClass("disabled")||e.onClick(t)}));var o=e.title;if(!1!==e.htmlEncode&&(o=Ft(e.title)),!at(e.icon)){r.addClass("icon-tool-button");var a=e.icon;ut(a,"fa-")?a="fa "+a:ut(a,"glyphicon-")&&(a="glyphicon "+a),o="<i class='"+Ft(a)+"'></i> "+o}null==o||0===o.length?r.addClass("no-text"):r.find("span").html(o),!1===e.visible&&r.hide(),
null!=e.disabled&&"function"!=typeof e.disabled&&r.toggleClass("disabled",!!e.disabled),"function"!=typeof e.visible&&"function"!=typeof e.disabled||r.on("updateInterface",(function(){"function"==typeof e.visible&&r.toggle(!!e.visible()),"function"==typeof e.disabled&&r.toggleClass("disabled",!!e.disabled())})),at(e.hotkey)||null==window.Mousetrap||(this.mouseTrap=this.mouseTrap||window.Mousetrap(e.hotkeyContext||this.options.hotkeyContext||window.document.documentElement),this.mouseTrap.bind(e.hotkey,(function(t,n){return r.is(":visible")&&r.triggerHandler("click"),e.hotkeyAllowDefault})))},i.prototype.findButton=function(t){return null!=t&&ut(t,".")&&(t=t.substr(1)),$("div.tool-button."+t,this.element)},i.prototype.updateInterface=function(){this.element.find(".tool-button").each((function(t,e){$(e).triggerHandler("updateInterface")}))},i=e.__decorate([t.Decorators.registerClass("Serenity.Toolbar")],i)}(lr),pr=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}
var r;return e.__extends(i,n),r=i,i.prototype.byId=function(t){return $("#"+this.idPrefix+t,this.element)},i.prototype.byID=function(t,e){return this.byId(t).getWidget(e)},i.noGeneric=function(t){var e=t.indexOf("$");return e>=0?t.substr(0,e):t},i.prototype.getDefaultTemplateName=function(){return r.noGeneric(w(S(this)))},i.prototype.getTemplateName=function(){var t=S(this),e=C(t),n=r.templateNames,i=r.templateNames[e];if(null!=i)return i;for(;t&&t!==lr;){for(var o=r.noGeneric(C(t)),a=0,l=Gt.rootNamespaces;a<l.length;a++){var s=l[a];if(ut(o,s+".")){o=o.substr(s.length+1);break}}if(wn("Template."+o))return n[e]=o,o;if(wn("Template."+(o=ft(o,".","_")))||$("script#Template_"+o).length>0)return n[e]=o,o;if(wn("Template."+(o=r.noGeneric(w(t))))||$("script#Template_"+o).length>0)return r.templateNames[e]=o,o;t=D(t)}return n[e]=i=this.getDefaultTemplateName(),i},i.prototype.getFallbackTemplate=function(){return null},i.prototype.getTemplate=function(){
var t,e=this.getTemplateName(),n=$("script#Template_"+e);if(n.length>0)return n.html();if(!wn("Template."+e)&&this.getDefaultTemplateName()==e&&null!=(t=this.getFallbackTemplate()))return t;if(null==(t=bn(e)))throw new Error(qe("Can't locate template for widget '{0}' with name '{1}'!",C(S(this)),e));return t},i.prototype.renderContents=function(){for(var t=this.getTemplate().replace(new RegExp("~_","g"),this.idPrefix),e=0;;){var n=t.indexOf('{{text:"',e);if(n<0)break;if((e=t.indexOf('"}}',n))<0)break;var i=vt(t.substr(n+8,e-n-8));t=t.substr(0,n)+i+t.substr(e+3),e=n+i.length}this.element.html(t)},i.prototype.useIdPrefix=function(){return hr(this.idPrefix)},i.templateNames={},i=r=e.__decorate([t.Decorators.registerClass("Serenity.TemplatedWidget")],i)}(lr);function hr(t){return new Proxy({_:null!=t?t:""},fr)}var fr={get:function(t,e){return e.startsWith("#")?"#"+t._+e.substring(1):t._+e}};"undefined"!=typeof $&&$.fn&&($.fn.flexHeightOnly=function(t){return void 0===t&&(t=1),
this.flexWidthHeight(0,t)},$.fn.flexWidthOnly=function(t){return void 0===t&&(t=1),this.flexWidthHeight(t,0)},$.fn.flexWidthHeight=function(t,e){return void 0===t&&(t=1),void 0===e&&(e=1),this.addClass("flexify").data("flex-x",t).data("flex-y",e)},$.fn.flexX=function(t){return this.data("flex-x",t)},$.fn.flexY=function(t){return this.data("flex-y",t)});var gr,vr=function(n){function i(e,i){var r=n.call(this,e,i)||this;return r.xDifference=0,r.yDifference=0,t.LazyLoadHelper.executeOnceWhenShown(e,(function(){r.storeInitialSize()})),r}return e.__extends(i,n),i.prototype.storeInitialSize=function(){var t=this;if(!this.element.data("flexify-init")){var e=this.options.designWidth;null==e&&(e=this.element.width()),this.element.data("flexify-width",e);var n=this.options.designHeight;null==n&&(n=this.element.height()),this.element.data("flexify-height",n),this.element.data("flexify-init",!0),this.element.on("resize."+this.uniqueName,(function(){return t.resizeElements()})),
this.element.on("resizestop."+this.uniqueName,(function(){return t.resizeElements()}));var i=this.element.find(".ui-tabs");i.length>0&&i.on("tabsactivate."+this.uniqueName,(function(){return t.resizeElements()})),null==this.options.designWidth&&null==this.options.designHeight||this.resizeElements()}},i.prototype.getXFactor=function(t){var e=null;return null!=this.options.getXFactor&&(e=this.options.getXFactor(t)),null==e&&(e=t.data("flex-x")),null!=e?e:1},i.prototype.getYFactor=function(t){var e=null;return null!=this.options.getYFactor&&(e=this.options.getYFactor(t)),null==e&&(e=t.data("flex-y")),null!=e?e:0},i.prototype.resizeElements=function(){var t=this,e=this.element.width(),n=this.element.data("flexify-width");null==n&&(this.element.data("flexify-width",e),n=e);var i=this.element.height(),r=this.element.data("flexify-height");null==r&&(this.element.data("flexify-height",i),r=i),this.xDifference=e-n,this.yDifference=i-r;var o=this.element,a=this.element.find(".ui-tabs-panel")
;a.length>0&&(o=a.filter(":visible")),o.find(".flexify").add(a.filter(".flexify:visible")).each((function(e,n){t.resizeElement($(n))}))},i.prototype.resizeElement=function(t){var e=this.getXFactor(t);if(0!==e){var n=t.data("flexify-width");if(null==n){var i=t.width();t.data("flexify-width",i),n=i}t.width(n+e*this.xDifference|0)}var r=this.getYFactor(t);if(0!==r){var o=t.data("flexify-height");if(null==o){var a=t.height();t.data("flexify-height",a),o=a}t.height(o+r*this.yDifference|0)}t.hasClass("require-layout")&&t.triggerHandler("layout")},i}(lr);t.DialogExtensions=void 0,(gr=t.DialogExtensions||(t.DialogExtensions={})).dialogResizable=function(t,e,n,i,r){var o,a=null===(o=null==t?void 0:t.dialog)||void 0===o?void 0:o.call(t);return a.dialog("option","resizable",!0),null!=i&&a.dialog("option","minWidth",i),null!=e&&a.dialog("option","width",e),null!=r&&a.dialog("option","minHeight",r),null!=n&&a.dialog("option","height",n),t},gr.dialogMaximizable=function(t){return t.dialogExtend({
closable:!0,maximizable:!0,dblclick:"maximize",icons:{maximize:"ui-icon-maximize-window"}}),t},gr.dialogFlexify=function(t){return new vr(t.closest(".ui-dialog"),{}),t};var yr,mr,_r=function(n){function i(t){var e=n.call(this,Pt().addClass("s-TemplatedDialog hidden"),t)||this;return e.element.attr("id",e.uniqueName),e.initValidator(),e.initTabs(),e.initToolbar(),e}var r;return e.__extends(i,n),r=i,Object.defineProperty(i.prototype,"isMarkedAsPanel",{get:function(){var t=F(S(this),Li,!0);return t.length>0&&!1!==t[t.length-1].value},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isResponsive",{get:function(){return Gt.responsiveDialogs||F(S(this),Gi,!0).length>0},enumerable:!1,configurable:!0}),i.getCssSize=function(t,e){var n=t.css(e);if(null==n)return null;if(!ot(n,"px"))return null;var i=je(n=n.substr(0,n.length-2));return null==i||isNaN(i)||0==i?null:i},i.applyCssSizes=function(t,e){var n,i=$("<div/>").hide().addClass(e).appendTo(document.body);try{
var o=$("<div/>").addClass("size").appendTo(i);null!=(n=r.getCssSize(o,"minWidth"))&&(t.minWidth=n),null!=(n=r.getCssSize(o,"width"))&&(t.width=n),null!=(n=r.getCssSize(o,"height"))&&(t.height=n),null!=(n=r.getCssSize(o,"minHeight"))&&(t.minHeight=n)}finally{i.remove()}},i.prototype.destroy=function(){var t,e,i,r,o,a,l;if(null===(e=null===(t=this.tabs)||void 0===t?void 0:t.tabs)||void 0===e||e.call(t,"destroy"),this.tabs=null,null===(o=null===(r=null===(i=this.toolbar)||void 0===i?void 0:i.toolbar)||void 0===r?void 0:r.destroy)||void 0===o||o.call(r),this.toolbar=null,this.validator&&this.byId("Form").remove(),this.validator=null,null!=this.element&&this.element.hasClass("ui-dialog-content"))null===(l=null===(a=this.element)||void 0===a?void 0:a.dialog)||void 0===l||l.call(a,"destroy"),this.element.removeClass("ui-dialog-content");else if(null!=this.element&&this.element.hasClass("modal-body")){var s=this.element.closest(".modal").data("bs.modal",null)
;this.element&&this.element.removeClass("modal-body"),window.setTimeout((function(){return s.remove()}),0)}$(window).unbind("."+this.uniqueName),n.prototype.destroy.call(this)},i.prototype.initDialog=function(){var e,n,i=this;if(!this.element.hasClass("ui-dialog-content")){this.element.removeClass("hidden"),null===(n=null===(e=this.element)||void 0===e?void 0:e.dialog)||void 0===n||n.call(e,this.getDialogOptions()),this.element.closest(".ui-dialog").on("resize",(function(t){return i.arrange()}));var r=S(this);this.isResponsive?(t.DialogExtensions.dialogResizable(this.element),$(window).bind("resize."+this.uniqueName,(function(t){i.element&&i.element.is(":visible")&&i.handleResponsive()})),this.element.closest(".ui-dialog").addClass("flex-layout")):t.DialogExtensions.dialogFlexify&&F(r,wi,!0).length>0&&(t.DialogExtensions.dialogFlexify(this.element),t.DialogExtensions.dialogResizable(this.element)),F(r,Ei,!0).length>0&&t.DialogExtensions.dialogMaximizable(this.element);var o=this
;this.element.bind("dialogopen."+this.uniqueName,(function(){$(document.body).addClass("modal-dialog-open"),i.isResponsive&&i.handleResponsive(),o.onDialogOpen()})),this.element.bind("dialogclose."+this.uniqueName,(function(){$(document.body).toggleClass("modal-dialog-open",$(".ui-dialog:visible").length>0),o.onDialogClose()}))}},i.prototype.getModalOptions=function(){return{backdrop:!1,keyboard:!1,size:"lg",modalClass:this.getCssClass()}},i.prototype.initModal=function(){var t,e,n=this;if(!this.element.hasClass("modal-body")){var i=null!==(e=null!==(t=this.element.data("dialogtitle"))&&void 0!==t?t:this.getDialogTitle())&&void 0!==e?e:"",r=this.getModalOptions();r.show=!1;var o="s-Modal";r.modalClass&&(o+=" "+r.modalClass);var a=re(i,"",o),l=$(a).appendTo(document.body).addClass("flex-layout");l.one("shown.bs.modal."+this.uniqueName,(function(){n.element.triggerHandler("shown.bs.modal"),n.onDialogOpen()})),l.one("hidden.bs.modal."+this.uniqueName,(function(){
$(document.body).toggleClass("modal-open",$(".modal.show").length+$(".modal.in").length>0),n.onDialogClose()})),r.size&&l.find(".modal-dialog").addClass("modal-"+r.size);var s=l.find(".modal-footer"),u=this.getDialogButtons();if(null!=u)for(var c=0,d=u;c<d.length;c++){var p=d[c];$(oe(p)).appendTo(s).click(p.click)}else s.hide();l.modal(r),l.find(".modal-body").replaceWith(this.element.removeClass("hidden").addClass("modal-body")),$(window).on("resize."+this.uniqueName,this.arrange.bind(this))}},i.prototype.initToolbar=function(){var t=this.byId("Toolbar");if(0!==t.length){var e=this.element.closest(".ui-dialog");0===e.length&&0==(e=this.element.closest(".modal")).length&&(e=this.element);var n={buttons:this.getToolbarButtons(),hotkeyContext:e[0]};this.toolbar=new dr(t,n)}},i.prototype.getToolbarButtons=function(){return[]},i.prototype.getValidatorOptions=function(){return{}},i.prototype.initValidator=function(){var t=this.byId("Form");if(t.length>0){var e=this.getValidatorOptions()
;this.validator=(Vn||t.validate)&&t.validate(Xn(e))}},i.prototype.resetValidation=function(){this.validator&&this.validator.resetAll()},i.prototype.validateForm=function(){return null==this.validator||!!this.validator.form()},i.prototype.dialogOpen=function(t){var e,n,i=this;(t=null!=t?t:this.isMarkedAsPanel)?(this.element.hasClass("s-Panel")||(this.element.on("panelopen."+this.uniqueName,(function(){i.onDialogOpen()})),this.element.on("panelclose."+this.uniqueName,(function(){i.onDialogClose()}))),r.openPanel(this.element,this.uniqueName),this.setupPanelTitle()):this.useBSModal()?(this.initModal(),this.element.closest(".modal").modal("show")):(this.initDialog(),null===(n=(e=this.element).dialog)||void 0===n||n.call(e,"open"))},i.prototype.useBSModal=function(){var t;return!($.ui&&(null===(t=$.ui)||void 0===t?void 0:t.dialog)&&!r.bootstrapModal)},i.openPanel=function(t,e){return ke(t,e)},i.closePanel=function(t,e){return Se(t,e)},i.prototype.onDialogOpen=function(){var t,e
;En()||$(":input",this.element).not("button").eq(0).focus(),this.arrange(),this.tabs&&(null===(e=(t=this.tabs).tabs)||void 0===e||e.call(t,"option","active",0))},i.prototype.arrange=function(){this.element.find(".require-layout").filter(":visible").each((function(t,e){$(e).triggerHandler("layout")}))},i.prototype.onDialogClose=function(){var t=this;$(document).trigger("click"),$.qtip&&$(document.body).children(".qtip").each((function(t,e){$(e).qtip("hide")})),window.setTimeout((function(){var e=t.element;t.destroy(),e.remove(),Ht(!1,null)}),0)},i.prototype.addCssClass=function(){this.isMarkedAsPanel&&(n.prototype.addCssClass.call(this),this.isResponsive&&this.element.addClass("flex-layout"))},i.prototype.getDialogButtons=function(){},i.prototype.getDialogOptions=function(){var t,e,n={},i="s-Dialog "+this.getCssClass();n.dialogClass=i;var o=this.getDialogButtons();null!=o&&(n.buttons=o.map(ae)),n.width=920,r.applyCssSizes(n,i),n.autoOpen=!1;var a=S(this)
;return n.resizable=F(a,Hi,!0).length>0,n.modal=!0,n.position={my:"center",at:"center",of:$(window.window)},n.title=null!==(e=null!==(t=this.element.data("dialogtitle"))&&void 0!==t?t:this.getDialogTitle())&&void 0!==e?e:"",n},i.prototype.getDialogTitle=function(){return""},i.prototype.dialogClose=function(){var t,e,n,i;this.element.hasClass("ui-dialog-content")?null===(i=null===(e=(t=this.element).dialog)||void 0===e?void 0:(n=e.call(t)).dialog)||void 0===i||i.call(n,"close"):this.element.hasClass("modal-body")?this.element.closest(".modal").modal("hide"):this.element.hasClass("s-Panel")&&!this.element.hasClass("hidden")&&r.closePanel(this.element)},Object.defineProperty(i.prototype,"dialogTitle",{get:function(){var t,e
;return this.element.hasClass("ui-dialog-content")?null===(e=(t=this.element).dialog)||void 0===e?void 0:e.call(t,"option","title"):this.element.hasClass("modal-body")?this.element.closest(".modal").find(".modal-header").children("h5").text():this.element.data("dialogtitle")},set:function(t){var e,n,i=this.dialogTitle;this.element.data("dialogtitle",t),this.element.hasClass("ui-dialog-content")?null===(n=(e=this.element).dialog)||void 0===n||n.call(e,"option","title",t):this.element.hasClass("modal-body")?this.element.closest(".modal").find(".modal-header").children("h5").text(null!=t?t:""):this.element.hasClass("s-Panel")&&i!=this.dialogTitle&&(this.setupPanelTitle(),this.arrange())},enumerable:!1,configurable:!0}),i.prototype.setupPanelTitle=function(){var t,e=this,n=null!==(t=this.dialogTitle)&&void 0!==t?t:this.getDialogTitle(),i=this.element.children(".panel-titlebar")
;at(n)?i.remove():(this.element.children(".panel-titlebar").length||(i=$("<div class='panel-titlebar'><div class='panel-titlebar-text'></div></div>").prependTo(this.element)),i.children(".panel-titlebar-text").text(n),this.element.hasClass("s-Panel")&&(i.children(".panel-titlebar-close").length||$('<button class="panel-titlebar-close">&nbsp;</button>').prependTo(i).click((function(t){r.closePanel(e.element,t)}))))},i.prototype.set_dialogTitle=function(t){this.dialogTitle=t},i.prototype.initTabs=function(){var t,e,n=this,i=this.byId("Tabs");0!==i.length&&(this.tabs=null===(e=(t=i).tabs)||void 0===e?void 0:e.call(t,{}),this.tabs.bind("tabsactivate",(function(){return n.arrange()})))},i.prototype.handleResponsive=function(){var t,e=null===(t=this.element)||void 0===t?void 0:t.dialog(),n=this.element.closest(".ui-dialog");if(En()){var i=this.element.data("responsiveData");if(!i){(i={}).draggable=e.dialog("option","draggable"),i.resizable=e.dialog("option","resizable"),
i.position=e.css("position");var r=n.position();i.left=r.left,i.top=r.top,i.width=n.width(),i.height=n.height(),i.contentHeight=this.element.height(),this.element.data("responsiveData",i),e.dialog("option","draggable",!1),e.dialog("option","resizable",!1)}n.addClass("mobile-layout"),n.css({left:"0px",top:"0px",width:$(window).width()+"px",height:$(window).height()+"px",position:"fixed"}),$(document.body).scrollTop(0),On(this.element)}else{var o=this.element.data("responsiveData");o&&(e.dialog("option","draggable",o.draggable),e.dialog("option","resizable",o.resizable),this.element.closest(".ui-dialog").css({left:"0px",top:"0px",width:o.width+"px",height:o.height+"px",position:o.position}),this.element.height(o.contentHeight),n.removeClass("mobile-layout"),this.element.removeData("responsiveData"))}},i=r=e.__decorate([t.Decorators.registerClass("Serenity.TemplatedDialog",[Ji])],i)}(pr),br=function(n){function i(t,e){var i=n.call(this,t,e)||this;return i.initValidator(),i.initTabs(),
i.initToolbar(),i}return e.__extends(i,n),i.prototype.destroy=function(){var t,e;this.tabs&&(null===(e=(t=this.tabs).tabs)||void 0===e||e.call(t,"destroy"),this.tabs=null),this.toolbar&&(this.toolbar.destroy(),this.toolbar=null),this.validator&&(this.byId("Form").remove(),this.validator=null),n.prototype.destroy.call(this)},i.prototype.arrange=function(){this.element.find(".require-layout").filter(":visible").each((function(t,e){$(e).triggerHandler("layout")}))},i.prototype.getToolbarButtons=function(){return[]},i.prototype.getValidatorOptions=function(){return{}},i.prototype.initTabs=function(){var t,e,n=this.byId("Tabs");0!==n.length&&(this.tabs=null===(e=(t=n).tabs)||void 0===e?void 0:e.call(t,{}))},i.prototype.initToolbar=function(){var t=this.byId("Toolbar");if(0!==t.length){var e={buttons:this.getToolbarButtons()};this.toolbar=new dr(t,e)}},i.prototype.initValidator=function(){var t=this.byId("Form");if(t.length>0){var e=this.getValidatorOptions();this.validator=t.validate(Xn(e))
}},i.prototype.resetValidation=function(){this.validator&&this.validator.resetAll()},i.prototype.validateForm=function(){return null==this.validator||!!this.validator.form()},i=e.__decorate([t.Decorators.registerClass("Serenity.TemplatedPanel")],i)}(pr);t.ValidationHelper=void 0,(yr=t.ValidationHelper||(t.ValidationHelper={})).asyncSubmit=function(t,e,n){var i=t.validate().settings;return!(i.abortHandler||null!=e&&!1===e()||(i.abortHandler=Jn,i.submitHandler=function(){return null!=n&&n(),!1},t.trigger("submit"),0))},yr.submit=function(t,e,n){var i=t.validate();return!(null!=i.settings.abortHandler||null!=e&&!1===e()||!i.form()||(null!=n&&n(),0))},yr.getValidator=function(t){var e=t.closest("form");return 0===e.length?null:e.data("validator")},t.VX=void 0,(mr=t.VX||(t.VX={})).addValidationRule=function(t,e,n){if(!t.length)return t;if(null==n)throw new nt("rule is null!");return t.addClass("customValidate").bind("customValidate."+e,n),t},mr.removeValidationRule=function(t,e){
return t.unbind("customValidate."+e),t},mr.validateElement=function(t,e){return t.element(e.element[0])};var Cr=function(){function n(t,e,n){var i=this;this.parentType=t,this.widget=e,this.parentChange=n,this.bind(),this.widget.element.bind("remove."+e.uniqueName+"cwh",(function(t){i.unbind(),i.widget=null,i.parentChange=null}))}return n.prototype.bind=function(){var t=this;if(at(this._parentID))return null;var e=It(this.widget.element,this._parentID).tryGetWidget(this.parentType);return null!=e?(e.element.bind("change."+this.widget.uniqueName,(function(){t.parentChange(e)})),e):(qt("Can't find cascaded parent element with ID: "+this._parentID+"!","",null),null)},n.prototype.unbind=function(){if(at(this._parentID))return null;var t=It(this.widget.element,this._parentID).tryGetWidget(this.parentType);return null!=t&&t.element.unbind("."+this.widget.uniqueName),t},n.prototype.get_parentID=function(){return this._parentID},n.prototype.set_parentID=function(t){
this._parentID!==t&&(this.unbind(),this._parentID=t,this.bind())},n=e.__decorate([t.Decorators.registerClass("Serenity.CascadedWidgetLink")],n)}();t.TabsExtensions=void 0,function(t){function e(t){var e=t.data("indexByKey");return e||(e={},t.children("ul").children("li").children("a").each((function(t,n){var i=n.getAttribute("href").toString(),r="_Tab",o=i.lastIndexOf(r);o>=0&&(i=i.substr(o+r.length)),e[i]=t})),t.data("indexByKey",e)),e}t.setDisabled=function(t,n,i){var r,o,a,l;if(t){var s=e(t);if(s){var u=s[n];null!=u&&(i&&u===t.tabs("option","active")&&(null===(o=(r=t).tabs)||void 0===o||o.call(r,"option","active",0)),null===(l=(a=t).tabs)||void 0===l||l.call(a,i?"disable":"enable",u))}}},t.toggle=function(t,n,i){var r,o,a,l;if(t){var s=e(t);if(s){var u=s[n];null!=u&&(i||u!==(null===(o=(r=t).tabs)||void 0===o?void 0:o.call(r,"option","active"))||null===(l=(a=t).tabs)||void 0===l||l.call(a,"option","active",0),t.children("ul").children("li").eq(u).toggle(i))}}},
t.activeTabKey=function(t){var e,n,i=t.children("ul").children("li").eq(null===(n=(e=t).tabs)||void 0===n?void 0:n.call(e,"option","active")).children("a").attr("href").toString(),r="_Tab",o=i.lastIndexOf(r);return o>=0&&(i=i.substr(o+r.length)),i},t.indexByKey=e,t.selectTab=function(t,n){var i,r,o,a,l=e(t);if(l){var s=l[n];null!=s&&s!==(null===(r=(i=t).tabs)||void 0===r?void 0:r.call(i,"option","active"))&&(null===(a=(o=t).tabs)||void 0===a||a.call(o,"option","active",s))}}}(t.TabsExtensions||(t.TabsExtensions={})),t.ReflectionOptionsSetter=void 0,(t.ReflectionOptionsSetter||(t.ReflectionOptionsSetter={})).set=function(e,n){if(null!=n){var i=S(e);if(i!==Object){var r=i.__propByName,o=i.__fieldByName;if(null==r){r={};for(var a=0,l=P(i,t.MemberType.property).filter((function(t){return!!t.setter&&((t.attr||[]).filter((function(t){return x(t,Ri)})).length>0||(t.attr||[]).filter((function(t){return x(t,ci)})).length>0)}));a<l.length;a++){var s=l[a]
;r[t.ReflectionUtils.makeCamelCase(s.name)]=s}i.__propByName=r}if(null==o){var u=P(i,t.MemberType.field).filter((function(t){return(t.attr||[]).filter((function(t){return x(t,Ri)})).length>0||(t.attr||[]).filter((function(t){return x(t,ci)})).length>0}));o={};for(var c=0;c<u.length;c++){var d=u[c];o[t.ReflectionUtils.makeCamelCase(d.name)]=d}i.__fieldByName=o}for(var p=0,h=Object.keys(n);p<h.length;p++){var f=h[p],g=n[f],v=t.ReflectionUtils.makeCamelCase(f),y=r[v]||r[f];if(null!=y){var m=e[y.setter];m&&m.call(e,g)}else{var _=o[v]||o[f];_&&(e[_.name]=g)}}}}},t.EditorUtils=void 0,function(t){t.getDisplayText=function(t){var e,i,r;if(null!=t.element.data("select2")){var o=t.element.select2("data");return null==o?"":null!==(e=o.text)&&void 0!==e?e:""}var a=n(t);return null==a?"":"string"==typeof a?a:a instanceof Boolean?a?null!==(i=_t("Controls.FilterPanel.OperatorNames.true"))&&void 0!==i?i:"True":null!==(r=_t("Controls.FilterPanel.OperatorNames.true"))&&void 0!==r?r:"False":a.toString()}
;var e={name:"_"};function n(t){var n={};return i(t,e,n),n._}function i(t,e,n){var i=I(t,Zi);if(null==i){var r=I(t,nr);if(null==r){var o=I(t,Qi);if(null==o){var a=I(t,Yi);if(null==a)null==t.getEditValue?t.element.is(":input")&&(n[e.name]=t.element.val()):t.getEditValue(e,n);else{var l=a.get_value();n[e.name]=isNaN(l)?null:l}}else n[e.name]=o.get_value()}else n[e.name]=r.get_value()}else i.getEditValue(e,n)}function r(t,e,n){var i=I(t,er);if(null==i){var r=I(t,nr);if(null!=r){var o=n[e.name];return null!=o&&(o=o.toString()),void r.set_value(T(o,String))}var a=I(t,Qi);if(null==a){var l=I(t,Yi);if(null==l)if(null==t.setEditValue)if(t.element.is(":input")){var s=n[e.name];null==s?t.element.val(""):t.element.val(s)}else;else t.setEditValue(n,e);else{var u=n[e.name];null==u||x(u,String)&&lt(T(u,String))?l.set_value(null):x(u,String)?l.set_value(T(Ue(T(u,String)),Number)):x(u,Boolean)?l.set_value(u?1:0):l.set_value(T(u,Number))}}else{var c=n[e.name]
;"number"==typeof c?a.set_value(c>0):a.set_value(!!c)}}else i.setEditValue(n,e)}function o(t,e){return t.each((function(t,n){var i=$(n),r=i.attr("type");return i.is("select")||"radio"===r||"checkbox"===r?e?i.addClass("readonly").attr("disabled","disabled"):i.removeClass("readonly").removeAttr("disabled"):e?i.addClass("readonly").attr("readonly","readonly"):i.removeClass("readonly").removeAttr("readonly"),!0})),t}t.getValue=n,t.saveValue=i,t.setValue=function(t,n){r(t,e,{_:n})},t.loadValue=r,t.setReadonly=o,t.setReadOnly=function(t,e){var n=I(t,tr);null!=n?n.set_readOnly(e):t.element.is(":input")&&o(t.element,e)},t.setRequired=function(t,e){var n=I(t,ir);null!=n?n.set_required(e):t.element.is(":input")&&t.element.toggleClass("required",!!e);var i=t.element.closest(".field"),r=i.find("sup").get().length>0;e&&!r?$("<sup>*</sup>").attr("title",vt("Controls.PropertyGrid.RequiredHint")).prependTo(i.find(".caption")[0]):!e&&r&&$(i.find("sup")[0]).remove()},
t.setContainerReadOnly=function(e,n){if(n)e.addClass("readonly-container").find(".editor").not(".container-readonly").each((function(e,n){var i=$(n).tryGetWidget(lr);if(null!=i){if(i.get_readOnly){if(i.get_readOnly())return}else if($(n).is("[readonly]")||$(n).is("[disabled]")||$(n).is(".readonly")||$(n).is(".disabled"))return;$(n).addClass("container-readonly"),t.setReadOnly(i,!0)}else{if($(n).is("[readonly]")||$(n).is("[disabled]")||$(n).is(".readonly")||$(n).is(".disabled"))return;t.setReadonly($(n).addClass("container-readonly"),!0)}}));else{if(!e.hasClass("readonly-container"))return;e.removeClass("readonly-container").find(".editor.container-readonly").removeClass("container-readonly").each((function(e,n){var i=$(n).tryGetWidget(lr);null!=i?t.setReadOnly(i,!1):t.setReadonly($(n),!1)}))}}}(t.EditorUtils||(t.EditorUtils={}));var wr,Sr=function(n){function r(t,e){var r,o=this;(o=n.call(this,t,e)||this).categoryLinkClick=function(t){t.preventDefault()
;var e=$("a[name="+t.target.getAttribute("href").toString().substr(1)+"]");e.closest(".category").hasClass("collapsed")&&e.closest(".category").children(".category-title").click();var n=function(){$.fn.fadeTo&&e.fadeTo(100,.5,(function(){e.fadeTo(100,1,(function(){}))}))},i=e.closest(".category");$.fn.scrollintoview?0===i.closest(":scrollable(both)").length?n():i.scrollintoview({duration:"fast",direction:"y",complete:n}):i&&i[0]&&i[0].scrollIntoView&&(i[0].scrollIntoView(),n())},o.idPrefix=o.options.idPrefix=null!==(r=o.options.idPrefix)&&void 0!==r?r:o.idPrefix,null==o.options.mode&&(o.options.mode=1),t.addClass("s-PropertyGrid"),o.editors=[];var a=o.options.items||[];if(o.items=[],i(a,(function(t){return!at(t.tab)}))){var l=a.filter((function(t){return at(t.tab)}));l.length>0&&(o.createItems(o.element,l),$("<div class='pad'></div>").appendTo(o.element));for(var s=a.filter((function(t){return!at(t.tab)
})),u=$("<ul class='nav nav-tabs property-tabs' role='tablist'></ul>").appendTo(o.element),c=$("<div class='tab-content property-panes'></div>").appendTo(o.element),d=0,p=0;p<s.length;){var h={$:pt(s[p].tab)},f=[],g=p;do{f.push(s[g])}while(++g<s.length&&pt(s[g].tab)===h.$);p=g;var v=$(Zt()?'<li><a data-toggle="tab" role="tab"></a></li>':'<li class="nav-item"><a class="nav-link" data-'.concat(te()?"bs-":"",'toggle="tab" role="tab"></a></li>')).appendTo(u);0===d&&(Zt()?v.addClass("active"):v.children("a").addClass("active"));var y=o.uniqueName+"_Tab"+d;v.children("a").attr("href","#"+y).text(o.determineText(h.$,function(t){return t+"Tabs."+this.tab.$}.bind({tab:h})));var m=$("<div class='tab-pane fade' role='tabpanel'>").appendTo(c);0===d&&m.addClass(Zt()?"in active":"show active"),m.attr("id",y),o.createItems(m,f),d++}}else o.createItems(o.element,a);return o.updateInterface(),o}var o;return e.__extends(r,n),o=r,r.prototype.destroy=function(){if(null!=this.editors){
for(var t=0;t<this.editors.length;t++)this.editors[t].destroy();this.editors=null}this.element.find("a.category-link").unbind("click",this.categoryLinkClick).remove(),lr.prototype.destroy.call(this)},r.prototype.createItems=function(t,e){var n,r,o,a,l={},s=!1!==this.options.useCategories&&i(e,(function(t){return!at(t.category)}));if(s){var u=$("<div/>").addClass("category-links");l=this.createCategoryLinks(u,e),Object.keys(l).length>1?u.appendTo(t):u.find("a.category-link").unbind("click",this.categoryLinkClick).remove()}o=$("<div/>").addClass("categories").appendTo(t),a=s?o:$("<div/>").addClass("category").appendTo(o);for(var c=null,d=0;d<e.length;d++){var p=e[d],h=p.category;if(null==h&&(h=null!==(n=this.options.defaultCategory)&&void 0!==n?n:""),s&&c!==h){var f=this.createCategoryDiv(o,l,h,!0!==p.collapsible?null:null!==(r=p.collapsed)&&void 0!==r&&r);null==c&&f.addClass("first-category"),c=h,a=f}var g=this.createField(a,p);this.items.push(p),this.editors.push(g)}},
r.prototype.createCategoryDiv=function(t,e,n,i){var r=$("<div/>").addClass("category").appendTo(t),o=$("<div/>").addClass("category-title").append($("<a/>").addClass("category-anchor").text(this.determineText(n,(function(t){return t+"Categories."+n}))).attr("name",this.idPrefix+"Category"+e[n].toString())).appendTo(r);if(null!=i){r.addClass(!0===i?"collapsible collapsed":"collapsible");var a=$("<i/>").addClass(!0===i?"fa fa-plus":"fa fa-minus").appendTo(o);o.click((function(t){r.toggleClass("collapsed"),a.toggleClass("fa-plus").toggleClass("fa-minus")}))}return r},r.prototype.determineText=function(t,e){if(null!=t&&!ut(t,"`")){var n=_t(t);if(null!=n)return n}if(null!=t&&ut(t,"`")&&(t=t.substring(1)),!at(this.options.localTextPrefix)){var i=_t(e(this.options.localTextPrefix));if(null!=i)return i}return t},r.prototype.createField=function(e,n){var i,r,a=$("<div/>").addClass("field").addClass(n.name).data("PropertyItem",n).appendTo(e);if(at(n.cssClass)||a.addClass(n.cssClass),
!at(n.formCssClass)&&(a.addClass(n.formCssClass),n.formCssClass.indexOf("line-break-")>=0)){var l=n.formCssClass.split(String.fromCharCode(32));l.indexOf("line-break-xs")>=0?$("<div class='line-break' style='width: 100%' />").insertBefore(a):l.indexOf("line-break-sm")>=0?$("<div class='line-break hidden-xs' style='width: 100%' />").insertBefore(a):l.indexOf("line-break-md")>=0?$("<div class='line-break hidden-sm' style='width: 100%' />").insertBefore(a):l.indexOf("line-break-lg")>=0&&$("<div class='line-break hidden-md' style='width: 100%' />").insertBefore(a)}var s=this.idPrefix+n.name,u=this.determineText(n.title,(function(t){return t+n.name})),c=this.determineText(n.hint,(function(t){return t+n.name+"_Hint"})),p=this.determineText(n.placeholder,(function(t){return t+n.name+"_Placeholder"}));null==c&&(c=null!=u?u:"");var h=$("<label/>").addClass("caption").attr("for",s).attr("title",c).text(null!=u?u:"").appendTo(a)
;at(n.labelWidth)||("0"===n.labelWidth?h.hide():h.css("width",n.labelWidth)),!0===n.required&&$("<sup>*</sup>").attr("title",vt("Controls.PropertyGrid.RequiredHint")).prependTo(h);var f=t.EditorTypeRegistry.get(null!==(i=n.editorType)&&void 0!==i?i:"String"),g=lr.elementFor(f).addClass("editor").attr("id",s).appendTo(a);g.is(":input")&&g.attr("name",null!==(r=n.name)&&void 0!==r?r:""),at(p)||g.attr("placeholder",p);n.editorParams;var v,y=null,m=F(f,Bi,!0);return null!=m&&m.length>0&&(y=m[0].optionsType),(v=new f(g,d(null!=y?new y:new Object,n.editorParams))).initialize(),"BooleanEditor"!=w(v)||null!=n.editorParams&&n.editorParams.labelFor||h.removeAttr("for"),"RadioButtonEditor"!=w(v)||null!=n.editorParams&&n.editorParams.labelFor||h.removeAttr("for"),null!=n.maxLength&&o.setMaxLength(v,n.maxLength),null!=n.editorParams&&t.ReflectionOptionsSetter.set(v,n.editorParams),$("<div/>").addClass("vx").appendTo(a),$("<div/>").addClass("clear").appendTo(a),v},
r.prototype.getCategoryOrder=function(t){var e,n=0,i={},r=ht(this.options.categoryOrder);if(null!=r)for(var o=0,a=r.split(";");o<a.length;o++){var l=ht(a[o]);null!=l&&(null==i[l]&&(i[l]=n++))}for(var s=0,u=t;s<u.length;s++){var c=u[s].category;null==c&&(c=null!==(e=this.options.defaultCategory)&&void 0!==e?e:""),null==i[c]&&(i[c]=n++)}return i},r.prototype.createCategoryLinks=function(t,e){for(var n,i=0,r={},o={},a=0,l=e;a<l.length;a++){var s=l[a],u=s.name,c=s.category;null==c&&(c=null!==(n=this.options.defaultCategory)&&void 0!==n?n:""),o[u]=c,r[s.name]=i++}var d=this.getCategoryOrder(e);e.sort((function(t,e){var n=0,i=o[t.name],a=o[e.name];if(i!=a){var l=d[i],s=d[a];null!=l&&null!=s?n=l-s:null!=l?n=-1:null!=s&&(n=1)}return 0===n&&(n=Re.stringCompare(i,a)),0===n&&(n=r[t.name]<r[e.name]?-1:r[t.name]>r[e.name]?1:0),n}));for(var p={},h=0;h<e.length;h++){var f=e[h],g={$:o[f.name]};if(null==p[g.$]){var v=Object.keys(p).length+1;p[g.$]=v,
v>1&&$("<span/>").addClass("separator").text("|").prependTo(t),$("<a/>").addClass("category-link").text(this.determineText(g.$,function(t){return t+"Categories."+this.category.$}.bind({category:g}))).attr("tabindex","-1").attr("href","#"+this.idPrefix+"Category"+v.toString()).click(this.categoryLinkClick).prependTo(t)}}return $("<div/>").addClass("clear").appendTo(t),p},r.prototype.get_editors=function(){return this.editors},r.prototype.get_items=function(){return this.items},r.prototype.get_idPrefix=function(){return this.idPrefix},r.prototype.get_mode=function(){return this.options.mode},r.prototype.set_mode=function(t){this.options.mode!==t&&(this.options.mode=t,this.updateInterface())},r.loadEditorValue=function(t,e,n){},r.saveEditorValue=function(e,n,i){t.EditorUtils.saveValue(e,n,i)},r.setReadOnly=function(e,n){t.EditorUtils.setReadOnly(e,n)},r.setReadonly=function(e,n){return t.EditorUtils.setReadonly(e,n)},r.setRequired=function(e,n){t.EditorUtils.setRequired(e,n)},
r.setMaxLength=function(t,e){t.element.is(":input")&&(e>0?t.element.attr("maxlength",e):t.element.removeAttr("maxlength"))},r.prototype.load=function(e){for(var n=0;n<this.editors.length;n++){var i=this.items[n],r=this.editors[n];1===this.get_mode()&&null!=i.defaultValue&&void 0===e[i.name]&&(e[i.name]=i.defaultValue),t.EditorUtils.loadValue(r,i,e)}},r.prototype.save=function(e){null==e&&(e=Object.create(null));for(var n=0;n<this.editors.length;n++){var i=this.items[n];if(!0!==i.oneWay&&this.canModifyItem(i)){var r=this.editors[n];t.EditorUtils.saveValue(r,i,e)}}return e},Object.defineProperty(r.prototype,"value",{get:function(){return this.save()},set:function(t){null==t&&(t=Object.create(null)),this.load(t)},enumerable:!1,configurable:!0}),r.prototype.canModifyItem=function(e){
return this.get_mode()===t.PropertyGridMode.insert?!1!==e.insertable&&(null==e.insertPermission||t.Authorization.hasPermission(e.insertPermission)):this.get_mode()!==t.PropertyGridMode.update||!1!==e.updatable&&(null==e.updatePermission||t.Authorization.hasPermission(e.updatePermission))},r.prototype.updateInterface=function(){for(var e=0;e<this.editors.length;e++){var n=this.items[e],i=this.editors[e],r=!0===n.readOnly||!this.canModifyItem(n);if(t.EditorUtils.setReadOnly(i,r),t.EditorUtils.setRequired(i,!r&&!!n.required&&"Boolean"!==n.editorType),!1===n.visible||null!=n.readPermission||null!=n.insertPermission||null!=n.updatePermission||!0===n.hideOnInsert||!0===n.hideOnUpdate){var o=null!=n.readPermission&&!t.Authorization.hasPermission(n.readPermission)||!1===n.visible||this.get_mode()===t.PropertyGridMode.insert&&!0===n.hideOnInsert||2===this.get_mode()&&!0===n.hideOnUpdate;i.getGridField().toggle(!o)}}},r.prototype.enumerateItems=function(t){for(var e=0;e<this.editors.length;e++){
t(this.items[e],this.editors[e])}},r=o=e.__decorate([t.Decorators.registerClass("Serenity.PropertyGrid")],r)}(lr);t.PropertyGridMode=void 0,(wr=t.PropertyGridMode||(t.PropertyGridMode={}))[wr.insert=1]="insert",wr[wr.update=2]="update";var kr=function(n){function i(t,e){var i=n.call(this,t,e)||this;return i.initPropertyGrid(),i.loadInitialEntity(),i}return e.__extends(i,n),i.prototype.destroy=function(){this.propertyGrid&&(this.propertyGrid.destroy(),this.propertyGrid=null),this.validator&&(this.byId("Form").remove(),this.validator=null),n.prototype.destroy.call(this)},i.prototype.initPropertyGrid=function(){var t=this.byId("PropertyGrid");if(!(t.length<=0)){var e=this.getPropertyGridOptions();this.propertyGrid=new Sr(t,e).init(null),this.element.closest(".ui-Panel").hasClass("s-Flexify")&&this.propertyGrid.element.children(".categories").flexHeightOnly(1)}},i.prototype.loadInitialEntity=function(){this.propertyGrid&&this.propertyGrid.load(new Object)},
i.prototype.getFormKey=function(){var t=F(S(this),Si,!0);if(t.length>=1)return t[0].value;var e=C(S(this)),n=e.indexOf(".");return n>=0&&(e=e.substring(n+1)),ot(e,"Panel")?e=e.substr(0,e.length-6):ot(e,"Panel")&&(e=e.substr(0,e.length-5)),e},i.prototype.getPropertyGridOptions=function(){return{idPrefix:this.idPrefix,items:this.getPropertyItems(),mode:1,useCategories:!1,localTextPrefix:"Forms."+this.getFormKey()+"."}},i.prototype.getPropertyItems=function(){return vn(this.getFormKey())},i.prototype.getSaveEntity=function(){var t=new Object;return this.propertyGrid&&this.propertyGrid.save(t),t},i.prototype.get_entity=function(){return this._entity},i.prototype.get_entityId=function(){return this._entityId},i.prototype.set_entity=function(t){this._entity=null!=t?t:new Object},i.prototype.set_entityId=function(t){this._entityId=t},i.prototype.validateBeforeSave=function(){return this.validator.form()},i=e.__decorate([t.Decorators.registerClass("Serenity.PropertyPanel")],i)}(br)
;t.SubDialogHelper=void 0,function(t){function e(t,e,n,i){var r=e.widgetName;return t.element.bind("ondatachange."+r,(function(t,e){i?window.setTimeout((function(){n(t,e)}),0):n(t,e)})).bind("remove."+r,(function(){t.element.unbind("ondatachange."+r)})),t}function n(t){return{my:"left top",at:"left+20 top+20",of:t[0]}}t.bindToDataChange=e,t.triggerDataChange=function(t){return t.element.triggerHandler("ondatachange"),t},t.triggerDataChanged=function(t){return t.triggerHandler("ondatachange"),t},t.bubbleDataChange=function(t,n,i){return e(t,n,(function(t,e){n.element.triggerHandler("ondatachange")}),i)},t.cascade=function(t,e){return t.element.one("dialogopen",(function(i){t.element.dialog().dialog("option","position",n(e))})),t},t.cascadedDialogOffset=n}(t.SubDialogHelper||(t.SubDialogHelper={}));var xr=function(n){function i(t){var e=n.call(this,t)||this;return e.useAsync()?e.initAsync():e.initSync(),e}var r;return e.__extends(i,n),r=i,i.prototype.internalInit=function(){
this.initPropertyGrid(),this.loadInitialEntity()},i.prototype.initSync=function(){this.propertyItemsData=this.getPropertyItemsData(),this.internalInit(),this.afterInit()},i.prototype.initAsync=function(){return e.__awaiter(this,void 0,void 0,(function(){var t;return e.__generator(this,(function(e){switch(e.label){case 0:return t=this,[4,this.getPropertyItemsDataAsync()];case 1:return t.propertyItemsData=e.sent(),this.internalInit(),this.afterInit(),[2]}}))}))},i.prototype.afterInit=function(){},i.prototype.useAsync=function(){return!1},i.prototype.destroy=function(){this.propertyGrid&&(this.propertyGrid.destroy(),this.propertyGrid=null),this.validator&&(this.byId("Form").remove(),this.validator=null),n.prototype.destroy.call(this)},i.prototype.getDialogOptions=function(){var t=n.prototype.getDialogOptions.call(this);return t.width=400,t},i.prototype.getDialogButtons=function(){var t=this;return n.prototype.getDialogButtons.call(this),[{text:vt("Dialogs.OkButton"),
cssClass:"btn btn-primary",click:function(){return t.okClick()}},{text:vt("Dialogs.CancelButton"),click:function(){return t.cancelClick()}}]},i.prototype.okClick=function(){this.validateBeforeSave()&&this.okClickValidated()},i.prototype.okClickValidated=function(){this.dialogClose()},i.prototype.cancelClick=function(){this.dialogClose()},i.prototype.initPropertyGrid=function(){var t=this.byId("PropertyGrid");if(!(t.length<=0)){var e=this.getPropertyGridOptions();this.propertyGrid=new Sr(t,e).init(null),this.element.closest(".ui-dialog").hasClass("s-Flexify")&&this.propertyGrid.element.children(".categories").flexHeightOnly(1)}},i.prototype.getFormKey=function(){var t=F(S(this),Si,!0);if(t.length>=1)return t[0].value;var e=C(S(this)),n=e.indexOf(".");return n>=0&&(e=e.substring(n+1)),ot(e,"Dialog")?e=e.substr(0,e.length-6):ot(e,"Panel")&&(e=e.substr(0,e.length-5)),e},i.prototype.getPropertyGridOptions=function(){return{idPrefix:this.idPrefix,items:this.getPropertyItems(),mode:1,
useCategories:!1,localTextPrefix:"Forms."+this.getFormKey()+"."}},i.prototype.getPropertyItems=function(){var t;return(null===(t=this.propertyItemsData)||void 0===t?void 0:t.items)||[]},i.prototype.getPropertyItemsData=function(){var e=this.getFormKey();return this.getFormKey!==r.prototype.getFormKey||this.getPropertyItems===r.prototype.getPropertyItems||t.ScriptData.canLoad("Form."+e)?at(e)?{items:[],additionalItems:[]}:yn(e):{items:this.getPropertyItems(),additionalItems:[]}},i.prototype.getPropertyItemsDataAsync=function(){return e.__awaiter(this,void 0,void 0,(function(){var t;return e.__generator(this,(function(e){switch(e.label){case 0:return at(t=this.getFormKey())?[3,2]:[4,_n(t)];case 1:return[2,e.sent()];case 2:return[2,{items:[],additionalItems:[]}]}}))}))},i.prototype.getSaveEntity=function(){var t=new Object;return this.propertyGrid&&this.propertyGrid.save(t),t},i.prototype.loadInitialEntity=function(){this.propertyGrid&&this.propertyGrid.load(new Object)},
i.prototype.get_entity=function(){return this.entity},i.prototype.set_entity=function(t){this.entity=null!=t?t:new Object},i.prototype.get_entityId=function(){return this.entityId},i.prototype.set_entityId=function(t){this.entityId=t},i.prototype.validateBeforeSave=function(){return this.validator.form()},i.prototype.updateTitle=function(){},i.prototype.getFallbackTemplate=function(){return'<div>\n    <div class="s-Form">\n        <form id="~_Form" action="">\n            <div class="fieldset">\n                <div id="~_PropertyGrid"></div>\n                <div class="clear"></div>\n            </div>\n        </form> \n    </div>\n</div>'},i=r=e.__decorate([t.Decorators.registerClass("Serenity.PropertyDialog")],i)}(_r),Ir=function(n){function i(t){return n.call(this,t)||this}return e.__extends(i,n),Object.defineProperty(i.prototype,"value",{get:function(){return this.element.val()},set:function(t){this.element.val(t)},enumerable:!1,configurable:!0}),
i.prototype.get_value=function(){return this.value},i.prototype.set_value=function(t){this.value=t},i=e.__decorate([t.Decorators.registerEditor("Serenity.StringEditor",[nr]),t.Decorators.element('<input type="text"/>')],i)}(lr),Tr=function(n){function i(t){var e=n.call(this,t)||this;return t.attr("type","password"),e}return e.__extends(i,n),i=e.__decorate([t.Decorators.registerEditor("Serenity.PasswordEditor")],i)}(Ir),Dr=function(n){function i(t,e){var i,r,o;return 0!==(i=n.call(this,t,e)||this).options.cols&&t.attr("cols",null!==(r=i.options.cols)&&void 0!==r?r:80),0!==i.options.rows&&t.attr("rows",null!==(o=i.options.rows)&&void 0!==o?o:6),i}return e.__extends(i,n),Object.defineProperty(i.prototype,"value",{get:function(){return this.element.val()},set:function(t){this.element.val(t)},enumerable:!1,configurable:!0}),i.prototype.get_value=function(){return this.value},i.prototype.set_value=function(t){this.value=t},
i=e.__decorate([t.Decorators.registerEditor("Serenity.TextAreaEditor",[nr]),t.Decorators.element("<textarea />")],i)}(lr),Fr=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return e.__extends(i,n),Object.defineProperty(i.prototype,"value",{get:function(){return this.element.is(":checked")},set:function(t){this.element.prop("checked",!!t)},enumerable:!1,configurable:!0}),i.prototype.get_value=function(){return this.value},i.prototype.set_value=function(t){this.value=t},i=e.__decorate([t.Decorators.registerEditor("Serenity.BooleanEditor",[Qi]),t.Decorators.element('<input type="checkbox"/>')],i)}(lr),Pr=function(n){function i(t,e){var i,o,a;i=n.call(this,t,e)||this,t.addClass("decimalQ");var l=d(r.defaultAutoNumericOptions(),{vMin:null!==(o=i.options.minValue)&&void 0!==o?o:i.options.allowNegatives?null!=i.options.maxValue?"-"+i.options.maxValue:"-999999999999.99":"0.00",vMax:null!==(a=i.options.maxValue)&&void 0!==a?a:"999999999999.99"})
;return null!=i.options.decimals&&(l.mDec=i.options.decimals),null!=i.options.padDecimals&&(l.aPad=i.options.padDecimals),$.fn.autoNumeric&&t.autoNumeric(l),i}var r;return e.__extends(i,n),r=i,i.prototype.get_value=function(){var t;return $.fn.autoNumeric?null==(t=this.element.autoNumeric("get"))||""===t?null:parseFloat(t):Ue(t=this.element.val())},Object.defineProperty(i.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),i.prototype.set_value=function(t){null==t||""===t?this.element.val(""):$.fn.autoNumeric?this.element.autoNumeric("set",t):this.element.val(ze(t))},i.prototype.get_isValid=function(){return!isNaN(this.get_value())},i.defaultAutoNumericOptions=function(){return{aDec:Re.decimalSeparator,altDec:"."===Re.decimalSeparator?",":".",aSep:"."===Re.decimalSeparator?",":".",aPad:!0}},
i=r=e.__decorate([t.Decorators.registerEditor("Serenity.DecimalEditor",[Yi]),t.Decorators.element('<input type="text"/>')],i)}(lr),Or=function(n){function i(t,e){var i,r,o;i=n.call(this,t,e)||this,t.addClass("integerQ");var a=d(Pr.defaultAutoNumericOptions(),{vMin:(null!==(r=i.options.minValue)&&void 0!==r?r:i.options.allowNegatives)?null!=i.options.maxValue?"-"+i.options.maxValue:"-2147483647":"0",vMax:null!==(o=i.options.maxValue)&&void 0!==o?o:2147483647,aSep:null});return $.fn.autoNumeric&&t.autoNumeric(a),i}return e.__extends(i,n),i.prototype.get_value=function(){var t;return $.fn.autoNumeric?lt(t=this.element.autoNumeric("get"))?null:parseInt(t,10):null==(t=ht(this.element.val()))?null:je(t)},Object.defineProperty(i.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),i.prototype.set_value=function(t){
null==t||""===t?this.element.val(""):$.fn.autoNumeric?this.element.autoNumeric("set",t):this.element.val(ze(t))},i.prototype.get_isValid=function(){return!isNaN(this.get_value())},i=e.__decorate([t.Decorators.registerEditor("Serenity.IntegerEditor",[Yi]),t.Decorators.element('<input type="text"/>')],i)}(lr),Er='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 17 17"><g></g><path d="M14 2v-1h-3v1h-5v-1h-3v1h-3v15h17v-15h-3zM12 2h1v2h-1v-2zM4 2h1v2h-1v-2zM16 16h-15v-8.921h15v8.921zM1 6.079v-3.079h2v2h3v-2h5v2h3v-2h2v3.079h-15z" fill="currentColor"></path></svg>',Ar=function(n){function i(t){var e,i,o=this;return o=n.call(this,t)||this,"undefined"==typeof flatpickr||!r.useFlatpickr&&$.fn.datepicker?(null===(e=$.fn)||void 0===e?void 0:e.datepicker)?t.datepicker({showOn:"button",beforeShow:function(e,n){return!t.hasClass("readonly")&&(r.uiPickerZIndexWorkaround(o.element),!0)},
yearRange:null!==(i=o.yearRange)&&void 0!==i?i:"-100:+50"}):t.attr("type","date"):flatpickr(t[0],r.flatPickrOptions(t)),t.on("keyup."+o.uniqueName,(function(t){32!==t.which||o.get_readOnly()?r.dateInputKeyup(t):o.get_valueAsDate()!=c()&&(o.set_valueAsDate(c()),o.element.trigger("change"))})),t.on("change."+o.uniqueName,r.dateInputChange),Kn(t,o.uniqueName,(function(t){var e=o.get_value();return at(e)?null:!at(o.get_minValue())&&Ne.stringCompare(Qe(e,"yyyy-MM-dd"),Qe(o.get_minValue(),"yyyy-MM-dd"))<0?qe(vt("Validation.MinDate"),Qe(o.get_minValue(),null)):!at(o.get_maxValue())&&Ne.stringCompare(Qe(e,"yyyy-MM-dd"),Qe(o.get_maxValue(),"yyyy-MM-dd"))>0?qe(vt("Validation.MaxDate"),Qe(o.get_maxValue(),null)):null})),o.set_sqlMinMax(!0),o}var r;return e.__extends(i,n),r=i,i.flatPickrOptions=function(t){return{clickOpens:!0,allowInput:!0,dateFormat:Re.dateOrder.split("").join(Re.dateSeparator).replace("y","Y"),onChange:function(){t.triggerHandler("change")}}},i.prototype.get_value=function(){
var t,e=null===(t=this.element.val())||void 0===t?void 0:t.trim();return(null==e?void 0:e.length)?Qe(e,"yyyy-MM-dd"):null},Object.defineProperty(i.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),i.prototype.set_value=function(t){null==t?this.element.val(""):"today"===t.toLowerCase()||"now"===t.toLowerCase()?this.element.val(Qe(c(),"date"===this.element.attr("type")?"yyyy-MM-dd":null)):this.element.val(Qe(t,"date"===this.element.attr("type")?"yyyy-MM-dd":null))},i.prototype.get_valueAsDate=function(){return at(this.get_value())?null:Xe(this.get_value())},Object.defineProperty(i.prototype,"valueAsDate",{get:function(){return this.get_valueAsDate()},set:function(t){this.set_valueAsDate(t)},enumerable:!1,configurable:!0}),i.prototype.set_valueAsDate=function(t){null==t&&this.set_value(null),this.set_value(Qe(t,"yyyy-MM-dd"))},i.prototype.get_readOnly=function(){return this.element.hasClass("readonly")},
i.prototype.set_readOnly=function(t){t!==this.get_readOnly()&&(t?(this.element.addClass("readonly").attr("readonly","readonly"),this.element.nextAll(".ui-datepicker-trigger").css("opacity","0.1")):(this.element.removeClass("readonly").removeAttr("readonly"),this.element.nextAll(".ui-datepicker-trigger").css("opacity","1")))},i.prototype.get_minValue=function(){return this.minValue},i.prototype.set_minValue=function(t){this.minValue=t},i.prototype.get_maxValue=function(){return this.maxValue},i.prototype.set_maxValue=function(t){this.maxValue=t},i.prototype.get_minDate=function(){return Xe(this.get_minValue())},i.prototype.set_minDate=function(t){this.set_minValue(Qe(t,"yyyy-MM-dd"))},i.prototype.get_maxDate=function(){return Xe(this.get_maxValue())},i.prototype.set_maxDate=function(t){this.set_maxValue(Qe(t,"yyyy-MM-dd"))},i.prototype.get_sqlMinMax=function(){return"1753-01-01"===this.get_minValue()&&"9999-12-31"===this.get_maxValue()},i.prototype.set_sqlMinMax=function(t){
t?(this.set_minValue("1753-01-01"),this.set_maxValue("9999-12-31")):(this.set_minValue(null),this.set_maxValue(null))},i.flatPickrTrigger=function(t){return $('<i class="ui-datepicker-trigger" href="javascript:;">'+Er+"</i>").insertAfter(t).click((function(){t.hasClass("readonly")||t[0]._flatpickr.open()}))},i.dateInputKeyup=function(t){var e;if("dmy"===Re.dateOrder){var n=$(t.target);if(n.is(":input")&&"date"!=n.attr("type")&&!n.is("[readonly]")&&!n.is(":disabled")){var i=null!==(e=n.val())&&void 0!==e?e:"";if(0!==i.length&&n[0].selectionEnd===i.length)if(-1===i.indexOf(Re.dateSeparator+Re.dateSeparator)){if(47===t.which||111===t.which){if(i.length>=2&&i.charAt(i.length-1)===Re.dateSeparator&&i.charAt(i.length-2)===Re.dateSeparator)return void n.val(i.substr(0,i.length-1));if(i.charAt(i.length-1)!==Re.dateSeparator)return;switch(i.length){case 2:if(r(i.charCodeAt(0))){i="0"+i;break}return;case 4:if(r(i.charCodeAt(0))&&r(i.charCodeAt(2))&&i.charAt(1)==Re.dateSeparator){
i="0"+i.charAt(0)+Re.dateSeparator+"0"+i.charAt(2)+Re.dateSeparator;break}return;case 5:if(r(i.charCodeAt(0))&&r(i.charCodeAt(2))&&r(i.charCodeAt(3))&&i.charAt(1)===Re.dateSeparator){i="0"+i;break}if(r(i.charCodeAt(0))&&r(i.charCodeAt(1))&&r(i.charCodeAt(3))&&i.charAt(2)===Re.dateSeparator){i=i.charAt(0)+i.charAt(1)+Re.dateSeparator+"0"+i.charAt(3)+Re.dateSeparator;break}break;default:return}n.val(i)}if(i.length<6&&(t.which>=48&&t.which<=57||t.which>=96&&t.which<=105)&&r(i.charCodeAt(i.length-1))){switch(i.length){case 1:if(i.charCodeAt(0)<=51)return;i="0"+i;break;case 2:if(!r(i.charCodeAt(0)))return;break;case 3:if(!r(i.charCodeAt(0))||i.charAt(1)!==Re.dateSeparator||i.charCodeAt(2)<=49)return;i="0"+i.charAt(0)+Re.dateSeparator+"0"+i.charAt(2);break;case 4:if(i.charAt(1)==Re.dateSeparator){if(!r(i.charCodeAt(0))||!r(i.charCodeAt(2)))return;i="0"+i;break}if(i.charAt(2)==Re.dateSeparator){if(!r(i.charCodeAt(0))||!r(i.charCodeAt(1))||i.charCodeAt(3)<=49)return
;i=i.charAt(0)+i.charAt(1)+Re.dateSeparator+"0"+i.charAt(3);break}return;case 5:if(i.charAt(2)!==Re.dateSeparator||!r(i.charCodeAt(0))||!r(i.charCodeAt(1))||!r(i.charCodeAt(3)))return;break;default:return}n.val(i+Re.dateSeparator)}}else n.val(ft(i,Re.dateSeparator+Re.dateSeparator,Re.dateSeparator))}}function r(t){return t>=48&&t<=57}},i.uiPickerZIndexWorkaround=function(t){if(null==t?void 0:t.closest(".ui-dialog").length){var e=parseInt(t.closest(".ui-dialog").css("z-index"),10);null==e||isNaN(e)||setTimeout((function(){var n=t.datepicker("widget");if(null==n?void 0:n.length){var i=parseInt(n.css("z-index"));!isNaN(i)&&i<=e&&n.css("z-index",e+1)}}),0)}},i.dateInputChange=function(t){var e,n;if("dmy"===Re.dateOrder){var i=$(t.target);if(i.is(":input")&&"date"!=i.attr("type")){var r=null!==(e=i.val())&&void 0!==e?e:"";if(r.length>=6&&/^[0-9]*$/g.test(r)&&i.val(r.substr(0,2)+Re.dateSeparator+r.substr(2,2)+Re.dateSeparator+r.substr(4)),(r=null!==(n=i.val())&&void 0!==n?n:"").length>=5){
var o=en(r);o&&!isNaN(o.valueOf())&&i.val(Qe(o,null))}}}},e.__decorate([t.Decorators.option()],i.prototype,"yearRange",void 0),e.__decorate([t.Decorators.option()],i.prototype,"get_minValue",null),e.__decorate([t.Decorators.option()],i.prototype,"get_maxValue",null),e.__decorate([t.Decorators.option()],i.prototype,"get_maxDate",null),e.__decorate([t.Decorators.option()],i.prototype,"get_sqlMinMax",null),i=r=e.__decorate([t.Decorators.registerEditor("Serenity.DateEditor",[nr,tr]),t.Decorators.element('<input type="text"/>')],i)}(lr);function Nr(){var t,e;if(!(null===(e=null===(t=$.datepicker)||void 0===t?void 0:t.regional)||void 0===e?void 0:e.en))return!1;var n=Re.dateOrder,i=Re.dateSeparator,r=($("html").attr("lang")||"en").toLowerCase();return $.datepicker.regional[r]||(r=r.split("-")[0],$.datepicker.regional[r]||(r="en")),$.datepicker.setDefaults($.datepicker.regional.en),$.datepicker.setDefaults($.datepicker.regional[r]),$.datepicker.setDefaults({
dateFormat:"mdy"==n?"mm"+i+"dd"+i+"yy":"ymd"==n?"yy"+i+"mm"+i+"dd":"dd"+i+"mm"+i+"yy",buttonImage:"data:image/svg+xml,"+encodeURIComponent(Er),buttonImageOnly:!0,showOn:"both",showButtonPanel:!0,changeMonth:!0,changeYear:!0}),$.ui&&$.ui.version<="1.12.1"&&$.datepicker.setDefaults({buttonImage:null,buttonImageOnly:!1,buttonText:'<i class="fa fa-calendar"></i>'}),!0}"undefined"!=typeof $&&$.fn&&!Nr()&&$(Nr);var Mr=function(n){function i(t,e){var i,o,a,l,s,u=this;if(u=n.call(this,t,e)||this,t.addClass("s-DateTimeEditor"),u.options.inputOnly)t.addClass("dateTimeQ");else if("undefined"==typeof flatpickr||!Ar.useFlatpickr&&$.fn.datepicker&&!u.options.seconds)if(null===(i=$.fn)||void 0===i?void 0:i.datepicker){t.addClass("dateQ"),t.datepicker({showOn:"button",beforeShow:function(){return!t.hasClass("readonly")&&(Ar.uiPickerZIndexWorkaround(this.element),!0)},yearRange:null!==(o=u.options.yearRange)&&void 0!==o?o:"-100:+50"}),t.bind("change."+u.uniqueName,(function(t){u.lastSetValue=null,
Ar.dateInputChange(t)})),u.time=$("<select/>").addClass("editor s-DateTimeEditor time");var c=t.next(".ui-datepicker-trigger");c.length>0?u.time.insertAfter(c):(c=t.prev(".ui-datepicker-trigger")).length>0?u.time.insertBefore(c):u.time.insertAfter(t),u.time.on("change",(function(e){this.lastSetValue=null,t.triggerHandler("change")}));for(var d=0,p=r.getTimeOptions(null!==(a=u.options.startHour)&&void 0!==a?a:0,0,null!==(l=u.options.endHour)&&void 0!==l?l:23,59,null!==(s=u.options.intervalMinutes)&&void 0!==s?s:5);d<p.length;d++){var h=p[d];kt(u.time,h,h)}Kn(t,u.uniqueName,(function(t){var e=u.get_value();return at(e)?null:!at(u.get_minValue())&&Ne.stringCompare(e,u.get_minValue())<0?qe(vt("Validation.MinDate"),Qe(u.get_minValue(),null)):!at(u.get_maxValue())&&Ne.stringCompare(e,u.get_maxValue())>0?qe(vt("Validation.MaxDate"),Qe(u.get_maxValue(),null)):null}))}else t.attr("type","datetime").addClass("dateTimeQ");else t.addClass("dateTimeQ"),flatpickr(t[0],u.getFlatpickrOptions())
;return t.bind("keyup."+u.uniqueName,(function(t){if(!u.get_readOnly()&&u.time)if(32===t.which)u.get_valueAsDate()!==new Date&&(u.set_valueAsDate(new Date),u.element.trigger("change"));else{var e=u.element.val();Ar.dateInputKeyup(t),e!=u.element.val()&&(u.lastSetValue=null)}})),u.set_sqlMinMax(!0),u.options.inputOnly||$("<i class='inplace-button inplace-now'><b></b></div>").attr("title",u.getInplaceNowText()).insertAfter(u.time).click((function(e){u.element.hasClass("readonly")||(u.lastSetValue=null,u.set_valueAsDate(new Date),t.triggerHandler("change"))})),u}var r;return e.__extends(i,n),r=i,i.prototype.getFlatpickrOptions=function(){var t,e=this;return{clickOpens:!0,allowInput:!0,enableTime:!0,time_24hr:!0,enableSeconds:!!this.options.seconds,minuteIncrement:null!==(t=this.options.intervalMinutes)&&void 0!==t?t:5,dateFormat:Re.dateOrder.split("").join(Re.dateSeparator).replace("y","Y")+" H:i"+(this.options.seconds?":S":""),onChange:function(){e.lastSetValue=null,
e.element&&e.element.triggerHandler("change")}}},i.prototype.get_value=function(){var t,e=this.element.val().trim();if(null!=e&&0===e.length)return null;this.time?t=Qe(e,"yyyy-MM-dd")+"T"+this.time.val()+":00.000":t=Qe(en(this.element.val()),"yyyy-MM-ddTHH:mm:ss.fff");return this.options.useUtc&&(t=Ye(Xe(t))),null!=this.lastSetValue&&this.lastSetValueGet==t?this.lastSetValue:t},Object.defineProperty(i.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),i.prototype.set_value=function(t){var e;if(at(t))this.element.val(""),this.time&&this.time.val("00:00");else if("today"===t.toLowerCase())this.time?(this.element.val(Qe(c(),null)),this.time.val("00:00")):this.element.val(this.getDisplayFormat());else{var n="now"===t.toLowerCase()?new Date:Xe(t);this.time?(n=r.roundToMinutes(n,null!==(e=this.options.intervalMinutes)&&void 0!==e?e:5),this.element.val(Qe(n,null)),
this.time.val(Qe(n,"HH:mm"))):this.element.val(Qe(n,this.getDisplayFormat()))}this.lastSetValue=null,at(t)||"today"==t.toLowerCase()||"now"==t.toLowerCase()||(this.lastSetValueGet=this.get_value(),this.lastSetValue=t)},i.prototype.getInplaceNowText=function(){var t;return null!==(t=_t("Controls.DateTimeEditor.SetToNow"))&&void 0!==t?t:"set to now"},i.prototype.getDisplayFormat=function(){return this.options.seconds?Re.dateTimeFormat:Re.dateTimeFormat.replace(":ss","")},i.prototype.get_valueAsDate=function(){return at(this.get_value())?null:Xe(this.get_value())},Object.defineProperty(i.prototype,"valueAsDate",{get:function(){return this.get_valueAsDate()},set:function(t){this.set_valueAsDate(t)},enumerable:!1,configurable:!0}),i.prototype.set_valueAsDate=function(t){null==t&&this.set_value(null),this.set_value(Qe(t,"yyyy-MM-ddTHH:mm"+(this.options.seconds?":ss":"")))},i.prototype.get_minValue=function(){return this.minValue},i.prototype.set_minValue=function(t){this.minValue=t},
i.prototype.get_maxValue=function(){return this.maxValue},i.prototype.set_maxValue=function(t){this.maxValue=t},i.prototype.get_minDate=function(){return Xe(this.get_minValue())},i.prototype.set_minDate=function(t){this.set_minValue(Qe(t,"yyyy-MM-ddTHH:mm:ss"))},i.prototype.get_maxDate=function(){return Xe(this.get_maxValue())},i.prototype.set_maxDate=function(t){this.set_maxValue(Qe(t,"yyyy-MM-ddTHH:mm:ss"))},i.prototype.get_sqlMinMax=function(){return"1753-01-01"===this.get_minValue()&&"9999-12-31"===this.get_maxValue()},i.prototype.set_sqlMinMax=function(t){t?(this.set_minValue("1753-01-01"),this.set_maxValue("9999-12-31")):(this.set_minValue(null),this.set_maxValue(null))},i.prototype.get_readOnly=function(){return this.element.hasClass("readonly")},i.prototype.set_readOnly=function(e){e!==this.get_readOnly()&&(e?(this.element.addClass("readonly").attr("readonly","readonly"),this.element.nextAll(".ui-datepicker-trigger").css("opacity","0.1"),
this.element.nextAll(".inplace-now").css("opacity","0.1")):(this.element.removeClass("readonly").removeAttr("readonly"),this.element.nextAll(".ui-datepicker-trigger").css("opacity","1"),this.element.nextAll(".inplace-now").css("opacity","1")),this.time&&t.EditorUtils.setReadonly(this.time,e))},i.roundToMinutes=function(t,e){t=new Date(t.getTime());var n=Ge(He(t.getMinutes()/e)*e);return t.setMinutes(n),t.setSeconds(0),t.setMilliseconds(0),t},i.getTimeOptions=function(t,e,n,i,r){var o=[];n>=23&&(n=23),i>=60&&(i=59);for(var a=t,l=e;!(a>n||a===n&&l>i);){var s=(a>=10?"":"0")+a+":"+(l>=10?"":"0")+l;o.push(s),(l+=r)>=60&&(l-=60,a++)}return o},e.__decorate([t.Decorators.option()],i.prototype,"get_minValue",null),e.__decorate([t.Decorators.option()],i.prototype,"get_maxValue",null),e.__decorate([t.Decorators.option()],i.prototype,"get_maxDate",null),e.__decorate([t.Decorators.option()],i.prototype,"get_sqlMinMax",null),
i=r=e.__decorate([t.Decorators.registerEditor("Serenity.DateTimeEditor",[nr,tr]),t.Decorators.element('<input type="text"/>')],i)}(lr),Rr=function(n){function i(t,e){var i=n.call(this,t,e)||this;t.addClass("editor s-TimeEditor hour"),i.options.noEmptyOption||kt(t,"","--");for(var r=i.options.startHour||0;r<=(i.options.endHour||23);r++)kt(t,r.toString(),r<10?"0"+r:r.toString());i.minutes=$("<select/>").addClass("editor s-TimeEditor minute").insertAfter(t),i.minutes.change((function(){return i.element.trigger("change")}));for(var o=0;o<=59;o+=i.options.intervalMinutes||5)kt(i.minutes,o.toString(),o<10?"0"+o:o.toString());return i}return e.__extends(i,n),Object.defineProperty(i.prototype,"value",{get:function(){var t=We(this.element.val()),e=We(this.minutes.val());return null==t||null==e?null:60*t+e},set:function(t){t?(this.element.val(Math.floor(t/60).toString()),this.minutes.val(t%60)):this.options.noEmptyOption?(this.element.val(this.options.startHour),
this.minutes.val("0")):(this.element.val(""),this.minutes.val("0"))},enumerable:!1,configurable:!0}),i.prototype.get_value=function(){return this.value},i.prototype.set_value=function(t){this.value=t},i.prototype.get_readOnly=function(){return this.element.hasClass("readonly")},i.prototype.set_readOnly=function(e){e!==this.get_readOnly()&&(e?this.element.addClass("readonly").attr("readonly","readonly"):this.element.removeClass("readonly").removeAttr("readonly"),t.EditorUtils.setReadonly(this.minutes,e))},i=e.__decorate([t.Decorators.registerEditor("Serenity.TimeEditor",[Yi,tr]),t.Decorators.element("<select />")],i)}(lr),Br=function(n){function i(t,e){var i=n.call(this,t,e)||this;r.registerValidationMethods(),t.addClass("emailuser");var o=$("<span/>").text("@").addClass("emailat").insertAfter(t),a=$('<input type="text"/>').addClass("emaildomain").insertAfter(o);return a.bind("blur."+i.uniqueName,(function(){var e=a.closest("form").data("validator");null!=e&&e.element(t[0])})),
at(i.options.domain)||a.val(i.options.domain),i.options.readOnlyDomain&&a.attr("readonly","readonly").addClass("disabled").attr("tabindex","-1"),t.bind("keypress."+i.uniqueName,(function(t){64===t.which&&(t.preventDefault(),i.options.readOnlyDomain||(a.focus(),a.select()))})),a.bind("keypress."+i.uniqueName,(function(t){64===t.which&&t.preventDefault()})),i.options.readOnlyDomain||t.change((function(e){return i.set_value(t.val())})),i}var r;return e.__extends(i,n),r=i,i.registerValidationMethods=function(){var t;$.validator&&$.validator.methods&&null==$.validator.methods.emailuser&&$.validator.addMethod("emailuser",(function(t,e){var n=$(e).nextAll(".emaildomain");return n.length>0&&null==n.attr("readonly")?!(!this.optional(e)||!this.optional(n[0]))||$.validator.methods.email.call(this,t+"@"+n.val(),e):$.validator.methods.email.call(this,t+"@dummy.com",e)}),null!==(t=_t("Validation.Email"))&&void 0!==t?t:$.validator.messages.email)},i.prototype.get_value=function(){
var t=this.element.nextAll(".emaildomain"),e=this.element.val(),n=t.val();return at(e)?this.options.readOnlyDomain||at(n)?"":"@"+n:e+"@"+n},Object.defineProperty(i.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),i.prototype.set_value=function(t){var e=this.element.nextAll(".emaildomain");if(null==(t=ht(t)))this.options.readOnlyDomain||e.val(""),this.element.val("");else{var n=t.split("@");n.length>1?this.options.readOnlyDomain?at(this.options.domain)?this.element.val(n[0]):n[1]!==this.options.domain?this.element.val(t):this.element.val(n[0]):(e.val(n[1]),this.element.val(n[0])):this.element.val(n[0])}},i.prototype.get_readOnly=function(){var t=this.element.nextAll(".emaildomain");return!(null==this.element.attr("readonly")&&(!this.options.readOnlyDomain||null==t.attr("readonly")))},i.prototype.set_readOnly=function(t){var e=this.element.nextAll(".emaildomain")
;t?(this.element.attr("readonly","readonly").addClass("readonly"),this.options.readOnlyDomain||e.attr("readonly","readonly").addClass("readonly")):(this.element.removeAttr("readonly").removeClass("readonly"),this.options.readOnlyDomain||e.removeAttr("readonly").removeClass("readonly"))},i=r=e.__decorate([t.Decorators.registerEditor("Serenity.EmailEditor",[nr,tr]),t.Decorators.element('<input type="text"/>')],i)}(lr),Lr=function(n){function i(t){var e=n.call(this,t)||this;return t.attr("type","email").addClass("email"),e}return e.__extends(i,n),i=e.__decorate([t.Decorators.registerEditor("Serenity.EmailAddressEditor")],i)}(Ir),$r=function(n){function i(t){var e=n.call(this,t)||this;return t.addClass("url").attr("title","URL should be entered in format: 'http://www.site.com/page'."),t.on("blur."+e.uniqueName,(function(e){var n=t.closest("form").data("validator");if(null!=n&&t.hasClass("error")){var i=ht(t.val());i&&(i="http://"+i,1==$.validator.methods.url.call(n,i,t[0])&&(t.val(i),
n.element(t)))}})),e}return e.__extends(i,n),i=e.__decorate([t.Decorators.registerEditor("Serenity.URLEditor",[nr])],i)}(Ir),Vr=function(n){function i(e,i){var r,o=this;if(at((o=n.call(this,e,i)||this).options.enumKey)&&null==o.options.enumType&&at(o.options.lookupKey))return o;if(at(o.options.lookupKey)){var a=o.options.enumType||t.EnumTypeRegistry.get(o.options.enumKey),l=o.options.enumKey;if(null==l&&null!=a){var s=F(a,ui,!1);s.length>0&&(l=s[0].value)}for(var u=0,c=t.Enum.getValues(a);u<c.length;u++){var d=c[u],p=t.Enum.toString(a,d);o.addRadio(d.toString(),null!==(r=_t("Enums."+l+"."+p))&&void 0!==r?r:p)}}else for(var h=sn(o.options.lookupKey),f=0,g=h.items;f<g.length;f++){var v=g[f],y=v[h.textField],m=null==y?"":y.toString(),_=v[h.idField],b=null==_?"":_.toString();o.addRadio(b,m)}return o}return e.__extends(i,n),i.prototype.addRadio=function(t,e){var n=$("<label/>").text(e)
;$('<input type="radio"/>').attr("name",this.uniqueName).attr("id",this.uniqueName+"_"+t).attr("value",t).prependTo(n),n.appendTo(this.element)},i.prototype.get_value=function(){return this.element.find("input:checked").first().val()},Object.defineProperty(i.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),i.prototype.set_value=function(t){if(t!==this.get_value()){var e=this.element.find("input"),n=e.filter(":checked");n.length>0&&(n[0].checked=!1),at(t)||(n=e.filter("[value="+t+"]")).length>0&&(n[0].checked=!0)}},i.prototype.get_readOnly=function(){return null!=this.element.attr("disabled")},i.prototype.set_readOnly=function(t){this.get_readOnly()!==t&&(t?this.element.attr("disabled","disabled").find("input").attr("disabled","disabled"):this.element.removeAttr("disabled").find("input").removeAttr("disabled"))},
i=e.__decorate([t.Decorators.registerEditor("Serenity.RadioButtonEditor",[nr,tr]),t.Decorators.element("<div/>")],i)}(lr),qr="undefined"!=typeof Select2?Select2:void 0,Hr=function(n){function r(t,e){var i=n.call(this,t,e)||this;i._items=[],i._itemById={};var r=i.emptyItemText();null!=r&&t.attr("placeholder",r);var o=i.getSelect2Options();return t.select2(o),t.attr("type","text"),t.on("change."+i.uniqueName,(function(e,n){!0!==n&&t.closest("form").data("validator")&&t.valid()})),i.setCascadeFrom(i.options.cascadeFrom),i.useInplaceAdd()&&i.addInplaceCreate(vt("Controls.SelectEditor.InplaceAdd"),null),i}var o;return e.__extends(r,n),o=r,r.prototype.destroy=function(){var t,e,i,r;null===(e=null===(t=this.initSelectionPromise)||void 0===t?void 0:t.abort)||void 0===e||e.call(t),this.abortPendingQuery(),null===(r=null===(i=this.element)||void 0===i?void 0:i.select2)||void 0===r||r.call(i,"destroy"),n.prototype.destroy.call(this)},r.prototype.hasAsyncSource=function(){return!1},
r.prototype.asyncSearch=function(t,e){return e({items:[],more:!1}),null},r.prototype.getTypeDelay=function(){var t;return null!==(t=this.options.typeDelay)&&void 0!==t?t:200},r.prototype.emptyItemText=function(){var t;return null!==(t=this.element.attr("placeholder"))&&void 0!==t?t:vt("Controls.SelectEditor.EmptyItemText")},r.prototype.getPageSize=function(){var t;return null!==(t=this.options.pageSize)&&void 0!==t?t:100},r.prototype.getIdField=function(){return this.options.idField},r.prototype.itemId=function(t){var e=t[this.getIdField()];return null==e?"":e.toString()},r.prototype.getTextField=function(){var t;return null!==(t=this.options.textField)&&void 0!==t?t:this.getIdField()},r.prototype.itemText=function(t){var e=t[this.getTextField()];return null==e?"":e.toString()},r.prototype.itemDisabled=function(t){return!1},r.prototype.mapItem=function(t){return{id:this.itemId(t),text:this.itemText(t),disabled:this.itemDisabled(t),source:t}},r.prototype.mapItems=function(t){
return t.map(this.mapItem.bind(this))},r.prototype.allowClear=function(){return null!=this.options.allowClear?!!this.options.allowClear:null!=this.emptyItemText()},r.prototype.isMultiple=function(){return!!this.options.multiple},r.prototype.abortPendingQuery=function(){var t,e;null===(e=null===(t=this.queryPromise)||void 0===t?void 0:t.abort)||void 0===e||e.call(t),this.queryPromise=null,this.typeTimeout&&(clearTimeout(this.typeTimeout),this.typeTimeout=null)},r.prototype.getSelect2Options=function(){var t=this,e=this.emptyItemText(),n={multiple:this.isMultiple(),placeHolder:at(e)?null:e,allowClear:this.allowClear(),createSearchChoicePosition:"bottom"};return this.hasAsyncSource()?(n.query=function(e){var n,i,r=t.getPageSize(),o={searchTerm:ht(e.term),skip:(e.page-1)*r,take:r,checkMore:!0};t.abortPendingQuery();var a=$(t.element).data("select2")
;null===(i=null===(n=null==a?void 0:a.search)||void 0===n?void 0:n.removeClass)||void 0===i||i.call(n,"select2-active").parent().removeClass("select2-active"),t.typeTimeout=setTimeout((function(){var n,i,r,l,s;t.abortPendingQuery(),null===(i=null===(n=null==a?void 0:a.search)||void 0===n?void 0:n.addClass)||void 0===i||i.call(n,"select2-active").parent().addClass("select2-active"),t.queryPromise=t.asyncSearch(o,(function(n){var i,r;null===(r=null===(i=null==a?void 0:a.search)||void 0===i?void 0:i.removeClass)||void 0===r||r.call(i,"select2-active").parent().removeClass("select2-active"),t.queryPromise=null,e.callback({results:t.mapItems(n.items),more:n.more})})),null===(s=(null===(r=t.queryPromise)||void 0===r?void 0:r.catch)||(null===(l=t.queryPromise)||void 0===l?void 0:l.fail))||void 0===s||s.call(t.queryPromise,(function(){var e,n;t.queryPromise=null,
null===(n=null===(e=null==a?void 0:a.search)||void 0===e?void 0:e.removeClass)||void 0===n||n.call(e,"select2-active").parent().removeClass("select2-active")}))}),e.term?t.getTypeDelay():0)},n.initSelection=function(e,n){var r,o,a,l=e.val();if(null!=l&&""!=l){var s=t.isMultiple(),u=s?l.split(","):[l],c={idList:u};null===(o=null===(r=t.initSelectionPromise)||void 0===r?void 0:r.abort)||void 0===o||o.call(r),t.initSelectionPromise=t.asyncSearch(c,(function(e){if(t.initSelectionPromise=null,s){var r=(e.items||[]).map((function(e){return t.mapItem(e)}));t._itemById=t._itemById||{};for(var o=0,a=r;o<a.length;o++){var c=a[o];t._itemById[c.id]=c}if(t.isAutoComplete&&r.length!=u.length)for(var d=0,p=u;d<p.length;d++){var h=p[d];i(r,(function(t){return t.id==h}))||r.push({id:h,text:h})}n(r)}else if(e.items&&e.items.length){c=t.mapItem(e.items[0]);t._itemById=t._itemById||{},t._itemById[c.id]=c,n(c)}else t.isAutoComplete?n({id:l,text:l}):n(null)})),
null===(a=t.initSelectionPromise.catch||t.initSelectionPromise.fail)||void 0===a||a.call(t.initSelectionPromise,(function(){t.initSelectionPromise=null}))}else n(null)}):(n.data=this._items,n.query=function(e){var n=o.filterByText(t._items,(function(t){return t.text}),e.term),i=t.getPageSize();e.callback({results:n.slice((e.page-1)*i,e.page*i),more:n.length>=e.page*i})},n.initSelection=function(e,n){var i=e.val(),r=t.isAutoComplete();if(t.isMultiple()){for(var o=[],a=0,l=i.split(",");a<l.length;a++){var s=l[a],u=t._itemById[s];null==u&&r&&(u={id:s,text:s},t.addItem(u)),null!=u&&o.push(u)}n(o)}else{var c=t._itemById[i];null==c&&r&&(c={id:i,text:i},t.addItem(c)),n(c)}}),null!=this.options.minimumResultsForSearch&&(n.minimumResultsForSearch=this.options.minimumResultsForSearch),(this.isAutoComplete()||this.useInplaceAdd())&&(n.createSearchChoice=this.getCreateSearchChoice(null)),n},r.prototype.get_delimited=function(){return!!this.options.delimited},
Object.defineProperty(r.prototype,"items",{get:function(){if(this.hasAsyncSource())throw new Error("Can't read items property of an async select editor!");return this._items||[]},set:function(t){if(this.hasAsyncSource())throw new Error("Can't set items of an async select editor!");this._items=t||[],this._itemById={};for(var e=0,n=this._items;e<n.length;e++){var i=n[e];this._itemById[i.id]=i}},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"itemById",{get:function(){if(this.hasAsyncSource())throw new Error("Can't read items property of an async select editor!");return this._itemById},set:function(t){if(this.hasAsyncSource())throw new Error("Can't set itemById of an async select editor!");this._itemById=t||{}},enumerable:!1,configurable:!0}),r.prototype.clearItems=function(){if(this.hasAsyncSource())throw new Error("Can't clear items of an async select editor!");this._items.length=0,this._itemById={}},r.prototype.addItem=function(t){
if(this.hasAsyncSource())throw new Error("Can't add item to an async select editor!");this._items.push(t),this._itemById[t.id]=t},r.prototype.addOption=function(t,e,n,i){this.addItem({id:t,text:e,source:n,disabled:i})},r.prototype.addInplaceCreate=function(t,e){var n=this,i=this;t=null!=t?t:vt("Controls.SelectEditor.InplaceAdd"),e=null!=e?e:vt("Controls.SelectEditor.InplaceEdit");var r=$("<a><b/></a>").addClass("inplace-button inplace-create").attr("title",t).insertAfter(this.element).click((function(t){i.inplaceCreateClick(t)}));this.get_select2Container().add(this.element).addClass("has-inplace-button"),this.element.change((function(){var i=n.isMultiple()||at(n.get_value());r.attr("title",i?t:e).toggleClass("edit",!i)})),this.element.change((function(t,e){if(!0!==e)if(n.isMultiple()){var i=n.get_values();i.length>0&&i[i.length-1]==(-2147483648).toString()&&(n.set_values(i.slice(0,i.length-1)),n.inplaceCreateClick(t))}else n.get_value()==(-2147483648).toString()&&(n.set_value(null),
n.inplaceCreateClick(t))})),this.isMultiple()&&this.get_select2Container().on("dblclick."+this.uniqueName,".select2-search-choice",(function(t){var e=$(t.target);e.hasClass("select2-search-choice")||(e=e.closest(".select2-search-choice"));var i=e.index(),r=n.get_values();i<0||i>=n.get_values().length||(t.editItem=r[i],n.inplaceCreateClick(t))}))},r.prototype.useInplaceAdd=function(){return!this.isAutoComplete()&&this.options.inplaceAdd&&(null==this.options.inplaceAddPermission||t.Authorization.hasPermission(this.options.inplaceAddPermission))},r.prototype.isAutoComplete=function(){return!!this.options.autoComplete},r.prototype.getCreateSearchChoice=function(t){var e=this;return function(n){var r;return e.lastCreateTerm=n,lt(n=(null!==(r=qr.util.stripDiacritics(n))&&void 0!==r?r:"").toLowerCase())||i(e._items||[],(function(e){var i=t?t(e.source):e.text;return qr.util.stripDiacritics(null!=i?i:"").toLowerCase()==n}))?null:i(e._items||[],(function(t){var e
;return-1!==(null!==(e=qr.util.stripDiacritics(t.text))&&void 0!==e?e:"").toLowerCase().indexOf(n)}))?e.isAutoComplete()?{id:e.lastCreateTerm,text:e.lastCreateTerm}:{id:(-2147483648).toString(),text:vt("Controls.SelectEditor.ClickToDefine")}:e.isAutoComplete()?{id:e.lastCreateTerm,text:e.lastCreateTerm}:{id:(-2147483648).toString(),text:vt("Controls.SelectEditor.NoResultsClickToDefine")}}},r.prototype.setEditValue=function(t,e){var n=t[e.name];Array.isArray(n)?this.set_values(n):this.set_value(null==n?null:n.toString())},r.prototype.getEditValue=function(t,e){!this.isMultiple()||this.get_delimited()?e[t.name]=this.get_value():e[t.name]=this.get_values()},r.prototype.get_select2Container=function(){return this.element.prevAll(".select2-container")},r.prototype.get_items=function(){return this.items},r.prototype.get_itemByKey=function(){return this.itemById},r.filterByText=function(t,e,n){if(null==n||0==n.length)return t;n=qr.util.stripDiacritics(n).toUpperCase();var i=[]
;return t.filter((function(t){var r=e(t);return!(null==r||!r.length)&&(!!ut(r=qr.util.stripDiacritics(r).toUpperCase(),n)||(r.indexOf(n)>=0&&i.push(t),!1))})).concat(i)},r.prototype.get_value=function(){var t;if(this.element.data("select2")){if(null!=(t=this.element.select2("val"))&&Array.isArray(t))return t.join(",")}else t=this.element.val();return t},Object.defineProperty(r.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),r.prototype.set_value=function(t){if(t!=this.get_value()){var e=t;!at(t)&&this.isMultiple()&&(e=t.split(String.fromCharCode(44)).map((function(t){return ht(t)})).filter((function(t){return null!=t})));var n=this.element;n.select2("val",e),n.data("select2-change-triggered",!0);try{n.triggerHandler("change",[!0])}finally{n.data("select2-change-triggered",!1)}this.updateInplaceReadOnly()}},Object.defineProperty(r.prototype,"selectedItem",{get:function(){var t=this.get_value()
;if(t&&this._itemById){var e=this._itemById[t];if(e)return e.source}return null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"selectedItems",{get:function(){for(var t=[],e=0,n=this.values;e<n.length;e++){var i=n[e];if(i&&this._itemById){var r=this._itemById[i];r&&r.source?t.push(r.source):t.push(null)}}return t},enumerable:!1,configurable:!0}),r.prototype.get_values=function(){var t=this.element.select2("val");if(null==t)return[];if(Array.isArray(t))return t;var e=t;return at(e)?[]:[e]},Object.defineProperty(r.prototype,"values",{get:function(){return this.get_values()},set:function(t){this.set_values(t)},enumerable:!1,configurable:!0}),r.prototype.set_values=function(t){null!=t&&0!==t.length?this.set_value(t.join(",")):this.set_value(null)},r.prototype.get_text=function(){var t;return(null!==(t=this.element.select2("data"))&&void 0!==t?t:{}).text},Object.defineProperty(r.prototype,"text",{get:function(){return this.get_text()},enumerable:!1,configurable:!0}),
r.prototype.get_readOnly=function(){return!at(this.element.attr("readonly"))},Object.defineProperty(r.prototype,"readOnly",{get:function(){return this.get_readOnly()},set:function(t){this.set_readOnly(t)},enumerable:!1,configurable:!0}),r.prototype.updateInplaceReadOnly=function(){var t=this.get_readOnly()&&(this.isMultiple()||!this.value);this.element.nextAll(".inplace-create").attr("disabled",t?"disabled":"").css("opacity",t?"0.1":"").css("cursor",t?"default":"")},r.prototype.set_readOnly=function(t){t!==this.get_readOnly()&&(this.element.attr("readonly",t?"readonly":null),this.updateInplaceReadOnly())},r.prototype.getCascadeFromValue=function(e){return t.EditorUtils.getValue(e)},r.prototype.setCascadeFrom=function(t){var e=this;if(at(t))return null!=this.cascadeLink&&(this.cascadeLink.set_parentID(null),this.cascadeLink=null),void(this.options.cascadeFrom=null);this.cascadeLink=new Cr(lr,this,(function(t){e.set_cascadeValue(e.getCascadeFromValue(t))})),
this.cascadeLink.set_parentID(t),this.options.cascadeFrom=t},r.prototype.get_cascadeFrom=function(){return this.options.cascadeFrom},Object.defineProperty(r.prototype,"cascadeFrom",{get:function(){return this.get_cascadeFrom()},set:function(t){this.set_cascadeFrom(t)},enumerable:!1,configurable:!0}),r.prototype.set_cascadeFrom=function(t){t!==this.options.cascadeFrom&&(this.setCascadeFrom(t),this.updateItems())},r.prototype.get_cascadeField=function(){var t;return null!==(t=this.options.cascadeField)&&void 0!==t?t:this.options.cascadeFrom},Object.defineProperty(r.prototype,"cascadeField",{get:function(){return this.get_cascadeField()},set:function(t){this.set_cascadeField(t)},enumerable:!1,configurable:!0}),r.prototype.set_cascadeField=function(t){this.options.cascadeField=t},r.prototype.get_cascadeValue=function(){return this.options.cascadeValue},Object.defineProperty(r.prototype,"cascadeValue",{get:function(){return this.get_cascadeValue()},set:function(t){this.set_cascadeValue(t)},
enumerable:!1,configurable:!0}),r.prototype.set_cascadeValue=function(t){this.options.cascadeValue!==t&&(this.options.cascadeValue=t,this.set_value(null),this.updateItems())},r.prototype.get_filterField=function(){return this.options.filterField},Object.defineProperty(r.prototype,"filterField",{get:function(){return this.get_filterField()},set:function(t){this.set_filterField(t)},enumerable:!1,configurable:!0}),r.prototype.set_filterField=function(t){this.options.filterField=t},r.prototype.get_filterValue=function(){return this.options.filterValue},Object.defineProperty(r.prototype,"filterValue",{get:function(){return this.get_filterValue()},set:function(t){this.set_filterValue(t)},enumerable:!1,configurable:!0}),r.prototype.set_filterValue=function(t){this.options.filterValue!==t&&(this.options.filterValue=t,this.set_value(null),this.updateItems())},r.prototype.cascadeItems=function(e){var n=this.get_cascadeValue();if(null==n||""===n)return at(this.get_cascadeField())?e:[]
;var i=n.toString(),r=this.get_cascadeField();return e.filter((function(e){var n,o=null!==(n=e[r])&&void 0!==n?n:t.ReflectionUtils.getPropertyValue(e,r);return!(null==o||o.toString()!==i)}))},r.prototype.filterItems=function(e){var n=this.get_filterValue();if(null==n||""===n)return e;var i=n.toString(),r=this.get_filterField();return e.filter((function(e){var n,o=null!==(n=e[r])&&void 0!==n?n:t.ReflectionUtils.getPropertyValue(e,r);return!(null==o||o.toString()!==i)}))},r.prototype.updateItems=function(){},r.prototype.getDialogTypeKey=function(){return null!=this.options.dialogType?this.options.dialogType:null},r.prototype.createEditDialog=function(e){var n=this.getDialogTypeKey(),i=t.DialogTypeRegistry.get(n);lr.create({type:i,init:function(t){return e(t)}})},r.prototype.initNewEntity=function(t){at(this.get_cascadeField())||(t[this.get_cascadeField()]=this.get_cascadeValue()),at(this.get_filterField())||(t[this.get_filterField()]=this.get_filterValue()),
null!=this.onInitNewEntity&&this.onInitNewEntity(t)},r.prototype.setEditDialogReadOnly=function(t){t.element&&t.element.find(".tool-button.delete-button").addClass("disabled").unbind("click")},r.prototype.editDialogDataChange=function(){},r.prototype.setTermOnNewEntity=function(t,e){},r.prototype.inplaceCreateClick=function(e){var n=this;this.get_readOnly()&&(this.isMultiple()&&!e.editItem||!this.value)||this.createEditDialog((function(i){n.get_readOnly()&&n.setEditDialogReadOnly(i),t.SubDialogHelper.bindToDataChange(i,n,(function(t,e){if(n.editDialogDataChange(),n.updateItems(),n.lastCreateTerm=null,"create"!==e.type&&"update"!==e.type||null==e.entityId)if(n.isMultiple()&&"delete"===e.type&&null!=e.entityId){var i=e.entityId.toString(),r=n.get_values().slice(),o=r.indexOf(i);o>=0&&r.splice(o,1),n.set_values(r.slice())}else n.isMultiple()||n.set_value(null);else{var a=e.entityId.toString();if(n.isMultiple()){var l=n.get_values().slice();l.indexOf(a)<0&&l.push(a),n.set_values(null),
n.set_values(l.slice())}else n.set_value(null),n.set_value(a)}}),!0);var r=e.editItem;if(null!=r)i.load(r,(function(){i.dialogOpen(n.openDialogAsPanel)}),null);else if(n.isMultiple()||at(n.get_value())){var o={};n.setTermOnNewEntity(o,pt(n.lastCreateTerm)),n.initNewEntity(o),i.load(o,(function(){i.dialogOpen(n.openDialogAsPanel)}),null)}else i.load(n.get_value(),(function(){i.dialogOpen(n.openDialogAsPanel)}),null)}))},r=o=e.__decorate([t.Decorators.registerClass("Serenity.Select2Editor",[er,Zi,nr,tr]),t.Decorators.element('<input type="hidden"/>')],r)}(lr),Gr=function(n){function i(t,e){var i=n.call(this,t,e)||this;return i.updateItems(),i}return e.__extends(i,n),i.prototype.getItems=function(){return this.options.items||[]},i.prototype.emptyItemText=function(){return at(this.options.emptyOptionText)?n.prototype.emptyItemText.call(this):this.options.emptyOptionText},i.prototype.updateItems=function(){var t,e=this.getItems();if(this.clearItems(),
e.length>0)for(var n="string"==typeof e[0],i=0,r=e;i<r.length;i++){var o=r[i],a=n?o:o[0],l=n?o:null!==(t=o[1])&&void 0!==t?t:o[0];this.addOption(a,l,o,!1)}},i=e.__decorate([t.Decorators.registerClass("Serenity.SelectEditor")],i)}(Hr),zr=function(n){function i(t,e){var i=n.call(this,t,e)||this;return i.updateItems(),i}return e.__extends(i,n),i.prototype.getItems=function(){var t,e,n=this.options;if(null!=n.items&&n.items.length>=1)return n.items;var i=[],r=(new Date).getFullYear(),o=(new Date).getFullYear();if(n.minYear=(null!==(t=n.minYear)&&void 0!==t?t:"-10").toString(),ut(n.minYear,"-")?r-=parseInt(n.minYear.substr(1),10):ut(n.minYear,"+")?r+=parseInt(n.minYear.substr(1),10):r=parseInt(n.minYear,10),n.maxYear=(null!==(e=n.maxYear)&&void 0!==e?e:"+10").toString(),ut(n.maxYear,"-")?o-=parseInt(n.maxYear.substr(1),10):ut(n.maxYear,"+")?o+=parseInt(n.maxYear.substr(1),10):o=parseInt(n.maxYear,10),
n.descending)for(var a=o;a>=r;a--)i.push(a.toString());else for(var l=r;l<=o;l++)i.push(l.toString());return i},i=e.__decorate([t.Decorators.registerEditor("Serenity.DateYearEditor")],i)}(Gr),jr=function(n){function i(t,e){var i=n.call(this,t,e)||this;return i.updateItems(),i}return e.__extends(i,n),i.prototype.updateItems=function(){var e;this.clearItems();var n=this.options.enumType||t.EnumTypeRegistry.get(this.options.enumKey),i=this.options.enumKey;if(null==i&&null!=n){var r=F(n,ui,!1);r.length>0&&(i=r[0].value)}for(var o=0,a=t.Enum.getValues(n);o<a.length;o++){var l=a[o],s=t.Enum.toString(n,l);this.addOption(parseInt(l,10).toString(),null!==(e=_t("Enums."+i+"."+s))&&void 0!==e?e:s,null,!1)}},i.prototype.allowClear=function(){var t;return null===(t=this.options.allowClear)||void 0===t||t},i=e.__decorate([t.Decorators.registerEditor("Serenity.EnumEditor")],i)}(Hr),Ur=function(n){function i(e,i){var r=n.call(this,e,i)||this;if(!r.hasAsyncSource()){r.updateItems();var o=r
;t.ScriptData.bindToChange("Lookup."+r.getLookupKey(),r.uniqueName,(function(){o.hasAsyncSource()||o.updateItems()}))}return r}return e.__extends(i,n),i.prototype.hasAsyncSource=function(){return!!this.options.async},i.prototype.destroy=function(){this.hasAsyncSource()||t.ScriptData.unbindFromChange(this.uniqueName),n.prototype.destroy.call(this)},i.prototype.getLookupKey=function(){if(null!=this.options.lookupKey)return this.options.lookupKey;var t=C(S(this)),e=t.indexOf(".");return e>=0&&(t=t.substring(e+1)),ot(t,"Editor")&&(t=t.substr(0,t.length-6)),t},i.prototype.getLookupAsync=function(){return un(this.getLookupKey())},i.prototype.getLookup=function(){return sn(this.getLookupKey())},i.prototype.getItems=function(t){return this.filterItems(this.cascadeItems(t.items))},i.prototype.getIdField=function(){return null!=this.lookup?this.lookup.idField:n.prototype.getIdField.call(this)},i.prototype.getItemText=function(t,e){if(null==e)return n.prototype.itemText.call(this,t)
;var i=e.textFormatter?e.textFormatter(t):t[e.textField];return null==i?"":i.toString()},i.prototype.mapItem=function(t){return{id:this.itemId(t),text:this.getItemText(t,this.lookup),disabled:this.getItemDisabled(t,this.lookup),source:t}},i.prototype.getItemDisabled=function(t,e){return n.prototype.itemDisabled.call(this,t)},i.prototype.updateItems=function(){if(!this.hasAsyncSource()){this.clearItems(),this.lookup=this.getLookup();for(var t=0,e=this.getItems(this.lookup);t<e.length;t++){var n=e[t];this.addItem(this.mapItem(n))}}},i.prototype.asyncSearch=function(t,e){var n=this;return this.getLookupAsync().then((function(i){n.lookup=i;var r=n.getItems(n.lookup);null!=t.idList&&(r=r.filter((function(e){return t.idList.indexOf(n.itemId(e))>=0}))),r=Hr.filterByText(r,function(t){return this.getItemText(t,this.lookup)}.bind(n),t.searchTerm),e({items:r.slice(t.skip,t.take),more:r.length>=t.take})}))},i.prototype.getDialogTypeKey=function(){var t=n.prototype.getDialogTypeKey.call(this)
;return t||this.getLookupKey()},i.prototype.setCreateTermOnNewEntity=function(t,e){t[this.getLookup().textField]=e},i.prototype.editDialogDataChange=function(){cn(this.getLookupKey())},i=e.__decorate([t.Decorators.registerEditor("Serenity.LookupEditorBase")],i)}(Hr),Wr=function(n){function i(t,e){return n.call(this,t,e)||this}return e.__extends(i,n),i=e.__decorate([t.Decorators.registerEditor("Serenity.LookupEditor")],i)}(Ur),Kr=function(n){function i(t,e){return n.call(this,t,e)||this}return e.__extends(i,n),i.prototype.getDialogTypeKey=function(){var t=n.prototype.getDialogTypeKey.call(this);if(t)return t;var e=this.getService();return ut(e,"~/Services/")&&(e=e.substr("~/Services/".length)),3==e.split("/").length&&(e=e.substr(0,e.lastIndexOf("/"))),e.replace("/",".")},i.prototype.getService=function(){return this.options.service},i.prototype.getServiceUrl=function(){var t=this.getService();if(null==t)throw new Error("ServiceLookupEditor requires 'service' option to be configured!")
;return!ut(t,"~")&&!ut(t,"/")&&t.indexOf("://")<0&&(t="~/Services/"+t),ut(t,"~")&&(t=Ae(t)),t},i.prototype.getIncludeColumns=function(){var t=this.options.includeColumns||[],e=this.getIdField();e&&t.indexOf(e)<0&&t.push(e);var n=this.getTextField();return n&&t.indexOf(n)<0&&t.push(n),t},i.prototype.getSort=function(){return this.options.sort||(this.getTextField()?[this.getTextField()]:null)},i.prototype.getCascadeCriteria=function(){var t=this.get_cascadeValue();return null==t||""===t?at(this.get_cascadeField())?null:["0","=","1"]:ai(this.get_cascadeField()).eq(t)},i.prototype.getFilterCriteria=function(){var t=this.get_filterValue();return null==t||""===t?null:[[this.get_filterField()],"=",t]},i.prototype.getIdListCriteria=function(t){if(null==t)return null;if(0==t.length)return["0","=","1"];var e=this.getIdField();if(null==e)throw new Error("ServiceLookupEditor requires 'idField' option to be configured!");return ai(e).in(t)},i.prototype.getCriteria=function(t){
return ai.and(ai.and(this.getIdListCriteria(t.idList),this.options.criteria),ai.and(this.getCascadeCriteria(),this.getFilterCriteria()))},i.prototype.getListRequest=function(e){var n={};return e.searchTerm&&(n.ContainsText=e.searchTerm),n.Sort=this.getSort(),n.ColumnSelection=this.options.columnSelection||t.ColumnSelection.KeyOnly,n.IncludeColumns=this.getIncludeColumns(),n.ExcludeColumns=this.options.excludeColumns,n.ContainsField=this.options.containsField,n.EqualityFilter=this.options.equalityFilter,n.Criteria=this.getCriteria(e),n.Skip=e.skip||0,n.Take=e.take?e.checkMore?e.take+1:e.take:0,n.IncludeDeleted=this.options.includeDeleted,n.ExcludeTotalCount=!0,n},i.prototype.getServiceCallOptions=function(t,e){return{blockUI:!1,url:this.getServiceUrl(),request:this.getListRequest(t),onSuccess:function(n){var i=n.Entities||[];i&&t.take&&t.checkMore&&n.Entities.length>i.length&&(i=i.slice(0,t.take)),e({items:i.slice(0,t.take),more:t.checkMore&&t.take&&i.length>t.take})}}},
i.prototype.hasAsyncSource=function(){return!0},i.prototype.asyncSearch=function(t,e){return Pe(this.getServiceCallOptions(t,e))},i=e.__decorate([t.Decorators.registerEditor("Serenity.ServiceLookupEditorBase")],i)}(Hr),Qr=function(n){function i(t,e){return n.call(this,t,e)||this}return e.__extends(i,n),i=e.__decorate([t.Decorators.registerEditor("Serenity.ServiceLookupEditor")],i)}(Kr),Yr=function(n){function i(e,i){var o=n.call(this,e,i)||this;o._instanceReady=!1,r.includeCKEditor();var a=e.attr("id");return lt(a)&&(e.attr("id",o.uniqueName),a=o.uniqueName),null!=o.options.cols&&e.attr("cols",o.options.cols),null!=o.options.rows&&e.attr("rows",o.options.rows),o.addValidationRule(o.uniqueName,(function(t){if(t.hasClass("required")&&null==ht(o.get_value()))return vt("Validation.Required");return null})),t.LazyLoadHelper.executeOnceWhenShown(o.element,(function(){var t=o.getConfig();window.CKEDITOR&&window.CKEDITOR.replace(a,t)})),o}var r;return e.__extends(i,n),r=i,
i.prototype.instanceReady=function(t){this._instanceReady=!0,$(t.editor.container.$).addClass(this.element.attr("class")),this.element.addClass("select2-offscreen").css("display","block"),t.editor.setData(this.element.val()),t.editor.setReadOnly(this.get_readOnly())},i.prototype.getLanguage=function(){var t;if(!window.CKEDITOR)return"en";var e=window.CKEDITOR,n=null!==(t=ht($("html").attr("lang")))&&void 0!==t?t:"en";return e.lang.languages[n]?n:(n.indexOf(String.fromCharCode(45))>=0&&(n=n.split(String.fromCharCode(45))[0]),e.lang.languages[n]?n:"en")},i.prototype.getConfig=function(){var t=this;return{customConfig:"",language:this.getLanguage(),bodyClass:"s-HtmlContentBody",on:{instanceReady:function(e){return t.instanceReady(e)},change:function(e){e.editor.updateElement(),t.element.triggerHandler("change")}},toolbarGroups:[{name:"clipboard",groups:["clipboard","undo"]},{name:"editing",groups:["find","selection","spellchecker"]},{name:"insert",
groups:["links","insert","blocks","bidi","list","indent"]},{name:"forms",groups:["forms","mode","document","doctools","others","about","tools"]},{name:"colors"},{name:"basicstyles",groups:["basicstyles","cleanup"]},{name:"align"},{name:"styles"}],removeButtons:"SpecialChar,Anchor,Subscript,Styles",format_tags:"p;h1;h2;h3;pre",removeDialogTabs:"image:advanced;link:advanced",removePlugins:"uploadimage,image2",contentsCss:Ae("~/Content/site/site.htmlcontent.css"),entities:!1,entities_latin:!1,entities_greek:!1,autoUpdateElement:!0,height:null==this.options.rows||0===this.options.rows?null:20*this.options.rows+"px"}},i.prototype.getEditorInstance=function(){var t=this.element.attr("id");return window.CKEDITOR.instances[t]},i.prototype.destroy=function(){var t=this.getEditorInstance();t&&t.destroy(!0),n.prototype.destroy.call(this)},i.prototype.get_value=function(){var t=this.getEditorInstance();return this._instanceReady&&t?t.getData():this.element.val()},
Object.defineProperty(i.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),i.prototype.set_value=function(t){var e=this.getEditorInstance();this.element.val(t),this._instanceReady&&e&&e.setData(t)},i.prototype.get_readOnly=function(){return!at(this.element.attr("disabled"))},i.prototype.set_readOnly=function(t){if(this.get_readOnly()!==t){t?this.element.attr("disabled","disabled"):this.element.removeAttr("disabled");var e=this.getEditorInstance();this._instanceReady&&e&&e.setReadOnly(t)}},i.getCKEditorBasePath=function(){var t=r.CKEditorBasePath;if(null==t){if("undefined"==typeof CKEDITOR_BASEPATH||!CKEDITOR_BASEPATH)return"~/Serenity.Assets/Scripts/ckeditor/";t=CKEDITOR_BASEPATH}return ot(t,"/")?t:t+"/"},i.includeCKEditor=function(){
window.CKEDITOR||($("#CKEditorScript").length>0||$("<script/>").attr("type","text/javascript").attr("id","CKEditorScript").attr("src",Ae(r.getCKEditorBasePath()+"ckeditor.js?v="+r.CKEditorVer)).appendTo(window.document.head))},i.CKEditorVer="4.7.1",i=r=e.__decorate([t.Decorators.registerEditor("Serenity.HtmlContentEditor",[nr,tr]),t.Decorators.element("<textarea/>")],i)}(lr),Jr=function(n){function i(t,e){return n.call(this,t,e)||this}return e.__extends(i,n),i.prototype.getConfig=function(){var t=n.prototype.getConfig.call(this);return t.removeButtons+=",Cut,Copy,Paste,BulletedList,NumberedList,Indent,Outdent,SpecialChar,Subscript,Superscript,Styles,PasteText,PasteFromWord,Strike,Link,Unlink,CreatePlaceholder,Image,Table,HorizontalRule,Source,Maximize,Format,Font,FontSize,Anchor,Blockquote,CreatePlaceholder,BGColor,JustifyLeft,JustifyCenter,JustifyRight,JustifyBlock,Superscript,RemoveFormat",t.removePlugins="elementspath,uploadimage,image2",t},
i=e.__decorate([t.Decorators.registerEditor("Serenity.HtmlNoteContentEditor")],i)}(Yr),Xr=function(n){function i(t,e){return n.call(this,t,e)||this}return e.__extends(i,n),i.prototype.getConfig=function(){var t=n.prototype.getConfig.call(this);return t.removeButtons+=",Cut,Copy,Paste,BulletedList,NumberedList,Indent,Outdent,SpecialChar,Subscript,Superscript,Styles,PasteText,PasteFromWord,Strike,Link,Unlink,CreatePlaceholder,Image,Table,HorizontalRule,Source,Maximize,Format,Font,FontSize,Anchor,Blockquote,CreatePlaceholder,BGColor,JustifyLeft,JustifyCenter,JustifyRight,JustifyBlock,Superscript,RemoveFormat",t.removePlugins="elementspath,uploadimage,image2",t},i=e.__decorate([t.Decorators.registerEditor("Serenity.HtmlReportContentEditor")],i)}(Yr),Zr=function(n){function i(t,e){var i,r;return i=n.call(this,t,e)||this,t.mask(i.options.mask||"",{placeholder:null!==(r=i.options.placeholder)&&void 0!==r?r:"_"}),i}return e.__extends(i,n),Object.defineProperty(i.prototype,"value",{
get:function(){return this.element.triggerHandler("blur.mask"),this.element.val()},set:function(t){this.element.val(t)},enumerable:!1,configurable:!0}),i.prototype.get_value=function(){return this.value},i.prototype.set_value=function(t){this.value=t},i=e.__decorate([t.Decorators.registerEditor("Serenity.MaskedEditor",[nr]),t.Decorators.element('<input type="text"/>')],i)}(lr),to=function(n){function i(t,e){var i,r=this;if((r=n.call(this,t,e)||this).element.addClass("g-recaptcha").attr("data-sitekey",r.options.siteKey),null==window.grecaptcha&&0===$("script#RecaptchaInclude").length){var o="https://www.google.com/recaptcha/api.js",a=r.options.language;null==a&&(a=null!==(i=$("html").attr("lang"))&&void 0!==i?i:""),o+="?hl="+a,$("<script/>").attr("id","RecaptchaInclude").attr("src",o).appendTo(document.body)}var l={visibility:"hidden",width:"0px",height:"0px",padding:"0px"}
;return Kn($("<input />").insertBefore(r.element).attr("id",r.uniqueName+"_validate").val("x").css(l),r.uniqueName,(function(t){return at(r.get_value())?vt("Validation.Required"):null})),r}return e.__extends(i,n),i.prototype.get_value=function(){return this.element.find(".g-recaptcha-response").val()},i.prototype.set_value=function(t){},i=e.__decorate([t.Decorators.registerEditor("Serenity.Recaptcha",[nr]),t.Decorators.element("<div/>")],i)}(lr);t.UploadHelper=void 0,function(t){function e(t){var e=.01*He(100*t/1024),n="KB";e>=1024&&(e=.01*He(100*e/1024),n="MB");var i=e.toString().split(String.fromCharCode(46));return(i.length>1?i[0]+"."+i[1].substr(0,2):i[0])+" "+n}function n(t){return!at(t)&&(ot(t=t.toLowerCase(),".jpg")||ot(t,".jpeg")||ot(t,".gif")||ot(t,".png"))}function i(t){var e=(t=null!=t?t:"").lastIndexOf(".");return e>=0&&(t=t.substr(0,e)),t+"_t.jpg"}function r(t){return t=ft(null!=t?t:"","\\","/"),Ae("~/upload/")+t}function o(t,e){t.colorbox({
current:Ft(vt("Controls.ImageUpload.ColorboxCurrent")),previous:Ft(vt("Controls.ImageUpload.ColorboxPrior")),next:Ft(vt("Controls.ImageUpload.ColorboxNext")),close:Ft(vt("Controls.ImageUpload.ColorboxClose"))})}t.addUploadInput=function(t){t.container.addClass("fileinput-button");var e=t.uploadUrl||"~/File/TemporaryUpload";t.uploadIntent&&(e.indexOf("?")<0?e+="?":e+="&",e+="uploadIntent=",e+=encodeURIComponent(t.uploadIntent));var n=$("<input/>").attr("type","file").attr("name",t.inputName+"[]").attr("data-url",Ae(e)).appendTo(t.container);return t.allowMultiple&&n.attr("multiple","multiple"),n.fileupload({dataType:"json",dropZone:t.zone,pasteZone:t.zone,done:function(e,n){var i=n.result;i.Error?qt(i.Error.Message):null!=t.fileDone&&t.fileDone(i,n.files[0].name,n)},fail:function(t,e){var n,i=null===(n=null==e?void 0:e._response)||void 0===n?void 0:n.jqXHR;if(i){if((i.getResponseHeader("content-type")||"").toLowerCase().indexOf("application/json")>=0){var r=$.parseJSON(i.responseText)
;if(r&&r.Error&&r.Error.Message)return void qt(r.Error.Message)}var o=i.responseText;o?ge({html:o}):i.status?500!=i.status?qt("HTTP "+i.status+" error! Check browser console for details."):qt("HTTP 500: Connection refused! Check browser console for details."):"abort"!=i.statusText&&qt("An unknown connection error occurred! Check browser console for details.")}else qt("An error occurred during file upload.")},start:function(){Te(null),null!=t.progress&&t.progress.show()},stop:function(){De(),null!=t.progress&&t.progress.hide()},progress:function(e,n){if(null!=t.progress){var i=n.loaded/n.total*100;t.progress.children().css("width",i.toString()+"%")}}}),n},t.checkImageConstraints=function(t,n){return t.IsImage||n.allowNonImage?n.minSize>0&&t.Size<n.minSize?(de(qe(vt("Controls.ImageUpload.UploadFileTooSmall"),e(n.minSize))),!1):n.maxSize>0&&t.Size>n.maxSize?(de(qe(vt("Controls.ImageUpload.UploadFileTooBig"),e(n.maxSize))),
!1):!t.IsImage||(n.minWidth>0&&t.Width<n.minWidth?(de(qe(vt("Controls.ImageUpload.MinWidth"),n.minWidth)),!1):n.maxWidth>0&&t.Width>n.maxWidth?(de(qe(vt("Controls.ImageUpload.MaxWidth"),n.maxWidth)),!1):n.minHeight>0&&t.Height<n.minHeight?(de(qe(vt("Controls.ImageUpload.MinHeight"),n.minHeight)),!1):!(n.maxHeight>0&&t.Height>n.maxHeight)||(de(qe(vt("Controls.ImageUpload.MaxHeight"),n.maxHeight)),!1)):(de(vt("Controls.ImageUpload.NotAnImageFile")),!1)},t.fileNameSizeDisplay=function(t,n){return t+" ("+e(n)+")"},t.fileSizeDisplay=e,t.hasImageExtension=n,t.thumbFileName=i,t.dbFileUrl=r,t.colorBox=o,t.populateFileSymbols=function(t,e,a,l){var s;e=e||[],t.html("");for(var u=0;u<e.length;u++){var c=e[u],d=$("<li/>").addClass("file-item").data("index",u),p=n(c.Filename);p?d.addClass("file-image"):d.addClass("file-binary");var h=$("<a/>").addClass("thumb").appendTo(d),f=null!==(s=c.OriginalName)&&void 0!==s?s:"",g=c.Filename;null==l||null==g||ut(g,"temporary/")||(g=l+g),h.attr("href",r(g)),
h.attr("target","_blank"),at(f)||h.attr("title",f),p&&(h.css("backgroundImage","url('"+r(i(c.Filename))+"')"),o(h)),a&&$("<div/>").addClass("filename").text(f).attr("title",f).appendTo(d),d.appendTo(t)}}}(t.UploadHelper||(t.UploadHelper={}));var eo,no=function(n){function i(e,i){var r=n.call(this,e,i)||this;i&&null!=i.allowNonImage||(r.options.allowNonImage=!0),e.addClass("s-FileUploadEditor"),at(r.options.originalNameProperty)&&e.addClass("hide-original-name"),r.toolbar=new dr($("<div/>").appendTo(r.element),{buttons:r.getToolButtons()}),r.progress=$("<div><div></div></div>").addClass("upload-progress").prependTo(r.toolbar.element);var o=r.getUploadInputOptions();return r.uploadInput=t.UploadHelper.addUploadInput(o),r.fileSymbols=$("<ul/>").appendTo(r.element),r.element.attr("id")||r.element.attr("id",r.uniqueName),r.hiddenInput=$('<input type="text" class="s-offscreen" name="'+r.uniqueName+'_Validator" data-vx-highlight="'+r.element.attr("id")+'"/>').appendTo(r.element),
r.updateInterface(),r}return e.__extends(i,n),i.prototype.getUploadInputOptions=function(){var e=this;return{container:this.toolbar.findButton("add-file-button"),zone:this.element,inputName:this.uniqueName,progress:this.progress,uploadIntent:this.options.uploadIntent,uploadUrl:this.options.uploadUrl,fileDone:function(n,i,r){if(t.UploadHelper.checkImageConstraints(n,e.options)){var o={OriginalName:i,Filename:n.TemporaryFile};e.entity=o,e.populate(),e.updateInterface();var a=e.hiddenInput.closest("form").data("validator");null!=a&&a.element(e.hiddenInput)}}}},i.prototype.addFileButtonText=function(){return vt("Controls.ImageUpload.AddFileButton")},i.prototype.getToolButtons=function(){var t=this;return[{title:this.addFileButtonText(),action:"add-file",cssClass:"add-file-button",onClick:function(){}},{title:"",hint:vt("Controls.ImageUpload.DeleteButtonHint"),action:"delete",cssClass:"delete-button",onClick:function(){t.entity=null,t.populate(),t.updateInterface()
;var e=t.hiddenInput.closest("form").data("validator");null!=e&&e.element(t.hiddenInput)}}]},i.prototype.populate=function(){var e=this.options.displayFileName||!lt(this.options.originalNameProperty);null==this.entity?t.UploadHelper.populateFileSymbols(this.fileSymbols,null,e,this.options.urlPrefix):t.UploadHelper.populateFileSymbols(this.fileSymbols,[this.entity],e,this.options.urlPrefix),this.hiddenInput.val(ht((this.get_value()||{}).Filename))},i.prototype.updateInterface=function(){var t=this.toolbar.findButton("add-file-button"),e=this.toolbar.findButton("delete-button");t.toggleClass("disabled",this.get_readOnly()),e.toggleClass("disabled",this.get_readOnly()||null==this.entity)},i.prototype.get_readOnly=function(){return null!=this.uploadInput.attr("disabled")},i.prototype.set_readOnly=function(t){if(this.get_readOnly()!==t){if(t){this.uploadInput.attr("disabled","disabled");try{this.uploadInput.fileupload("disable")}catch(t){}}else{this.uploadInput.removeAttr("disabled");try{
this.uploadInput.fileupload("enable")}catch(t){}}this.updateInterface()}},i.prototype.get_required=function(){return this.hiddenInput.hasClass("required")},i.prototype.set_required=function(t){this.hiddenInput.toggleClass("required",!!t)},i.prototype.get_value=function(){return null==this.entity?null:d({},this.entity)},Object.defineProperty(i.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),i.prototype.set_value=function(t){if("string"==typeof(e=t)){var e=ht(e);if(null!=t){var n=e.indexOf("/");n<0&&(n=e.indexOf("\\")),t={Filename:t,OriginalName:e.substring(n+1)}}}else null!=t&&lt(t.Filename)&&(t=null);null!=t?null==t.Filename?this.entity=null:this.entity=d({},t):this.entity=null,this.populate();var i=this.hiddenInput.closest("form").data("validator");null!=i&&i.element(this.hiddenInput),this.updateInterface()},i.prototype.getEditValue=function(t,e){e[t.name]=null==this.entity?null:ht(this.entity.Filename)},
i.prototype.setEditValue=function(t,e){var n,i={};if(i.Filename=t[e.name],at(this.options.originalNameProperty)){if(this.options.displayFileName){var r=null!==(n=i.Filename)&&void 0!==n?n:"",o=ft(r,"\\","/").lastIndexOf("/");i.OriginalName=o>=0?r.substr(o+1):r}}else i.OriginalName=t[this.options.originalNameProperty];this.set_value(i)},i=e.__decorate([t.Decorators.registerEditor("Serenity.FileUploadEditor",[tr,Zi,er,ir]),t.Decorators.element("<div/>")],i)}(lr),io=function(n){function i(t,e){var i=n.call(this,t,e)||this;return e&&null==e.allowNonImage&&(i.options.allowNonImage=!1),t.addClass("s-ImageUploadEditor"),i}return e.__extends(i,n),i=e.__decorate([t.Decorators.registerEditor("Serenity.ImageUploadEditor")],i)}(no),ro=function(n){function i(e,i){var r=n.call(this,e,i)||this;return r.entities=[],e.addClass("s-MultipleFileUploadEditor"),r.toolbar=new dr($("<div/>").appendTo(r.element),{buttons:r.getToolButtons()}),
r.progress=$("<div><div></div></div>").addClass("upload-progress").prependTo(r.toolbar.element),r.uploadInput=t.UploadHelper.addUploadInput(r.getUploadInputOptions()),r.fileSymbols=$("<ul/>").appendTo(r.element),r.element.attr("id")||r.element.attr("id",r.uniqueName),r.hiddenInput=$('<input type="text" class="s-offscreen" name="'+r.uniqueName+'_Validator" data-vx-highlight="'+r.element.attr("id")+'" multiple="multiple"></input>').appendTo(r.element),r.updateInterface(),r}return e.__extends(i,n),i.prototype.getUploadInputOptions=function(){var e=this;return{container:this.toolbar.findButton("add-file-button"),zone:this.element,inputName:this.uniqueName,progress:this.progress,uploadIntent:this.options.uploadIntent,uploadUrl:this.options.uploadUrl,allowMultiple:!0,fileDone:function(n,i){if(t.UploadHelper.checkImageConstraints(n,e.options)){var r={OriginalName:i,Filename:n.TemporaryFile};e.entities.push(r),e.populate();var o=e.hiddenInput.closest("form").data("validator")
;null!=o&&o.element(e.hiddenInput),e.updateInterface()}}}},i.prototype.addFileButtonText=function(){return vt("Controls.ImageUpload.AddFileButton")},i.prototype.getToolButtons=function(){return[{title:this.addFileButtonText(),action:"add-file",cssClass:"add-file-button",onClick:function(){}}]},i.prototype.populate=function(){var e=this;t.UploadHelper.populateFileSymbols(this.fileSymbols,this.entities,!0,this.options.urlPrefix),this.fileSymbols.children().each((function(t,n){var i=t;$("<a class='delete'></a>").appendTo($(n).children(".filename")).click((function(t){t.preventDefault(),e.entities.splice(i,1),e.populate();var n=e.hiddenInput.closest("form").data("validator");null!=n&&n.element(e.hiddenInput)}))})),this.hiddenInput.val(ht((this.get_value()[0]||{}).Filename))},i.prototype.updateInterface=function(){this.toolbar.findButton("add-file-button").toggleClass("disabled",this.get_readOnly()),this.fileSymbols.find("a.delete").toggle(!this.get_readOnly())},
i.prototype.get_readOnly=function(){return null!=this.uploadInput.attr("disabled")},i.prototype.set_readOnly=function(t){if(this.get_readOnly()!==t){if(t){this.uploadInput.attr("disabled","disabled");try{this.uploadInput.fileupload("disable")}catch(t){}}else{this.uploadInput.removeAttr("disabled");try{this.uploadInput.fileupload("enable")}catch(t){}}this.updateInterface()}},i.prototype.get_required=function(){return this.hiddenInput.hasClass("required")},i.prototype.set_required=function(t){this.hiddenInput&&this.hiddenInput.toggleClass("required",!!t)},i.prototype.get_value=function(){return this.entities.map((function(t){return d({},t)}))},Object.defineProperty(i.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),i.prototype.set_value=function(t){this.entities=(t||[]).map((function(t){return d({},t)})),this.populate(),this.updateInterface()},i.prototype.getEditValue=function(t,e){
this.jsonEncodeValue?e[t.name]=JSON.stringify(this.get_value()):e[t.name]=this.get_value()},i.prototype.setEditValue=function(t,e){var n,i=t[e.name];if(x(i,String)){var r=null!==(n=ht(i))&&void 0!==n?n:"[]";ut(r,"[")&&ot(r,"]")?this.set_value($.parseJSON(r)):this.set_value([{Filename:r,OriginalName:"UnknownFile"}])}else this.set_value(i)},e.__decorate([t.Decorators.option()],i.prototype,"jsonEncodeValue",void 0),i=e.__decorate([t.Decorators.registerEditor("Serenity.MultipleFileUploadEditor",[tr,Zi,er,ir]),t.Decorators.element("<div/>")],i)}(lr),oo=function(n){function i(t,e){var i=n.call(this,t,e)||this;return t.addClass("s-MultipleImageUploadEditor"),i}return e.__extends(i,n),i=e.__decorate([t.Decorators.registerEditor("Serenity.MultipleImageUploadEditor")],i)}(ro),ao=function(n){function i(t,e){var i,r=this;r=n.call(this,t,e)||this,t.addClass("quick-filters-bar").addClass("clear");for(var o=r.options.filters,a=0;a<o.length;a++){var l=o[a];r.add(l)}
return r.options.idPrefix=null!==(i=r.options.idPrefix)&&void 0!==i?i:r.uniqueName+"_",r}var r;return e.__extends(i,n),r=i,i.prototype.addSeparator=function(){this.element.append($("<hr/>"))},i.prototype.add=function(e){var n,i=this;if(null==e)throw new it("opt");e.separator&&this.addSeparator();var r=$("<div class='quick-filter-item'><span class='quick-filter-label'></span></div>").appendTo(this.element).data("qffield",e.field).children(),o=null!==(n=_t(e.title))&&void 0!==n?n:e.title;null==o&&null==(o=this.options.getTitle?this.options.getTitle(e):null)&&(o=e.field);var a=r.text(o).parent();null!=e.displayText&&a.data("qfdisplaytext",e.displayText),null!=e.saveState&&a.data("qfsavestate",e.saveState),null!=e.loadState&&a.data("qfloadstate",e.loadState),at(e.cssClass)||a.addClass(e.cssClass);var l=lr.create({type:e.type,element:function(t){at(e.field)||t.attr("id",i.options.idPrefix+e.field),t.attr("placeholder"," "),t.appendTo(a),null!=e.element&&e.element(t)},options:e.options,
init:e.init}),s=function(n){if(!a.hasClass("ignore")){n.EqualityFilter=n.EqualityFilter||{};var i=t.EditorUtils.getValue(l),r=null!=i&&!at(i.toString());if(null!=e.handler){var o={field:e.field,request:n,equalityFilter:n.EqualityFilter,value:i,active:r,widget:l,handled:!0};e.handler(o),a.toggleClass("quick-filter-active",o.active),o.handled||(n.EqualityFilter[e.field]=i)}else n.EqualityFilter[e.field]=i,a.toggleClass("quick-filter-active",r)}};return l.changeSelect2((function(t){window.setTimeout((function(){return i.onChange&&i.onChange(t)}),0)})),this.add_submitHandlers(s),l.element.bind("remove."+this.uniqueName,(function(t){i.remove_submitHandlers(s)})),l},i.prototype.addDateRange=function(t,e){return this.add(r.dateRange(t,e))},i.dateRange=function(e,n){var i=null;return{field:e,type:Ar,title:n,element:function(t){(i=lr.create({type:Ar,element:function(e){e.insertAfter(t)},options:null,init:null})).element.change((function(e){t.triggerHandler("change")})),
$("<span/>").addClass("range-separator").text("-").insertAfter(t)},handler:function(t){var e=en(t.widget.value);e&&(isNaN(e.valueOf())?($t(vt("Validation.DateInvalid"),"",null),t.widget.element.val(""),e=null):t.request.Criteria=ai.and(t.request.Criteria,ai(t.field).ge(t.widget.value)));var n=en(i.value);if(n)if(isNaN(null==n?void 0:n.valueOf()))$t(vt("Validation.DateInvalid"),"",null),i.element.val(""),n=null;else{var r=new Date(i.valueAsDate.valueOf());r.setDate(r.getDate()+1),t.request.Criteria=ai.and(t.request.Criteria,ai(t.field).lt(Qe(r,"yyyy-MM-dd")))}t.active=!(!e&&!n)},displayText:function(e,n){var r,o=t.EditorUtils.getDisplayText(e),a=t.EditorUtils.getDisplayText(i);if(at(o)&&at(a))return null;var l=n+" >= "+o,s=n+" <= "+a;return at(o)||at(a)?at(o)?s:l:l+" "+(null!==(r=_t("Controls.FilterPanel.And"))&&void 0!==r?r:"and")+" "+s},saveState:function(e){return[t.EditorUtils.getValue(e),t.EditorUtils.getValue(i)]},loadState:function(e,n){
null!=n&&Array.isArray(n)&&2===n.length||(n=[null,null]),t.EditorUtils.setValue(e,n[0]),t.EditorUtils.setValue(i,n[1])}}},i.prototype.addDateTimeRange=function(t,e){return this.add(r.dateTimeRange(t,e))},i.dateTimeRange=function(e,n,i){var r=null;return{field:e,type:Mr,title:n,element:function(t){(r=lr.create({type:Mr,element:function(e){e.insertAfter(t)},options:null==i?null:{useUtc:i},init:null})).element.change((function(e){t.triggerHandler("change")})),$("<span/>").addClass("range-separator").text("-").insertAfter(t)},init:function(t){t.element.parent().find(".time").change((function(e){t.element.triggerHandler("change")}))},handler:function(t){var e=en(t.widget.value);e&&(isNaN(null==e?void 0:e.valueOf())?($t(vt("Validation.DateInvalid"),"",null),t.widget.element.val(""),e=null):t.request.Criteria=ai.and(t.request.Criteria,ai(t.field).ge(t.widget.value)));var n=en(r.value);n&&(isNaN(null==n?void 0:n.valueOf())?($t(vt("Validation.DateInvalid"),"",null),r.element.val(""),
n=null):t.request.Criteria=ai.and(t.request.Criteria,ai(t.field).le(r.value))),t.active=!(!e&&!n)},displayText:function(e,n){var i,o=t.EditorUtils.getDisplayText(e),a=t.EditorUtils.getDisplayText(r);if(at(o)&&at(a))return null;var l=n+" >= "+o,s=n+" <= "+a;return at(o)||at(a)?at(o)?s:l:l+" "+(null!==(i=_t("Controls.FilterPanel.And"))&&void 0!==i?i:"and")+" "+s},saveState:function(e){return[t.EditorUtils.getValue(e),t.EditorUtils.getValue(r)]},loadState:function(e,n){null!=n&&Array.isArray(n)&&2===n.length||(n=[null,null]),t.EditorUtils.setValue(e,n[0]),t.EditorUtils.setValue(r,n[1])},options:null==i?null:{useUtc:i}}},i.prototype.addBoolean=function(t,e,n,i){return this.add(r.boolean(t,e,n,i))},i.boolean=function(t,e,n,i){var r={},o=[],a=n;null==a&&(a=vt("Controls.FilterPanel.OperatorNames.true")),o.push(["1",a]);var l=i;return null==l&&(l=vt("Controls.FilterPanel.OperatorNames.false")),o.push(["0",l]),r.items=o,{field:t,type:Gr,title:e,options:r,handler:function(t){
t.equalityFilter[t.field]=null==t.value||at(t.value.toString())?null:!!We(t.value)}}},i.prototype.destroy=function(){this.submitHandlers=null,n.prototype.destroy.call(this)},i.prototype.onSubmit=function(t){this.submitHandlers&&this.submitHandlers(t)},i.prototype.add_submitHandlers=function(t){this.submitHandlers=N(this.submitHandlers,t)},i.prototype.remove_submitHandlers=function(t){this.submitHandlers=q(this.submitHandlers,t)},i.prototype.clear_submitHandlers=function(){},i.prototype.find=function(t,e){return $("#"+this.options.idPrefix+e).getWidget(t)},i.prototype.tryFind=function(t,e){var n=$("#"+this.options.idPrefix+e);return n.length?n.tryGetWidget(t):null},i=r=e.__decorate([t.Decorators.registerClass("Serenity.QuickFilterBar"),t.Decorators.element("<div/>")],i)}(lr),lo=function(n){function i(t,e){var i,r,o=this;o=n.call(this,t,e)||this,t.attr("title",vt("Controls.QuickSearch.Hint")).attr("placeholder",vt("Controls.QuickSearch.Placeholder")),
o.lastValue=dt(null!==(i=t.val())&&void 0!==i?i:"");var a=o;if(o.element.bind("keyup."+o.uniqueName,(function(){a.checkIfValueChanged()})),o.element.bind("change."+o.uniqueName,(function(){a.checkIfValueChanged()})),$("<span><i></i></span>").addClass("quick-search-icon").insertBefore(t),u(o.options.fields)&&o.options.fields.length>0){for(var l=$("<a/>").addClass("quick-search-field").attr("title",vt("Controls.QuickSearch.FieldSelection")).insertBefore(t),s=$("<ul></ul>").css("width","120px"),c=0,d=o.options.fields;c<d.length;c++){var p=d[c],h={$:p};$("<li><a/></li>").appendTo(s).children().attr("href","#").text(null!==(r=p.title)&&void 0!==r?r:"").click(function(t){t.preventDefault(),this.$this.fieldChanged=a.field!==this.field.$,a.field=this.field.$,this.$this.updateInputPlaceHolder(),this.$this.checkIfValueChanged()}.bind({field:h,$this:o}))}new ur(l,{positionMy:"right top",positionAt:"right bottom",menu:s}),o.field=o.options.fields[0],o.updateInputPlaceHolder()}
return o.element.bind("execute-search."+o.uniqueName,(function(t){var e;o.timer&&window.clearTimeout(o.timer),o.searchNow(dt(null!==(e=o.element.val())&&void 0!==e?e:""))})),o}return e.__extends(i,n),i.prototype.checkIfValueChanged=function(){var t;if(!this.element.hasClass("ignore-change")){var e=this.get_value();if(e!=this.lastValue||this.fieldChanged&&!at(e)){this.fieldChanged=!1,this.timer&&window.clearTimeout(this.timer);var n=this;this.timer=window.setTimeout((function(){n.searchNow(e)}),null!==(t=this.options.typeDelay)&&void 0!==t?t:500),this.lastValue=e}else this.fieldChanged=!1}},i.prototype.get_value=function(){var t;return dt(null!==(t=this.element.val())&&void 0!==t?t:"")},i.prototype.get_field=function(){return this.field},i.prototype.set_field=function(t){this.field!==t&&(this.fieldChanged=!0,this.field=t,this.updateInputPlaceHolder(),this.checkIfValueChanged())},i.prototype.updateInputPlaceHolder=function(){var t=this.element.prevAll(".quick-search-field")
;this.field?t.text(this.field.title):t.text("")},i.prototype.restoreState=function(t,e){this.fieldChanged=!1,this.field=e;t=dt(null!=t?t:"");this.element.val(t),this.lastValue=t,this.timer&&(window.clearTimeout(this.timer),this.timer=null),this.updateInputPlaceHolder()},i.prototype.searchNow=function(t){var e,n,i,r=this;this.element.parent().toggleClass(null!==(e=this.options.filteredParentClass)&&void 0!==e?e:"s-QuickSearchFiltered",!!(t.length>0)),this.element.parent().addClass(null!==(n=this.options.loadingParentClass)&&void 0!==n?n:"s-QuickSearchLoading").addClass(null!==(i=this.options.loadingParentClass)&&void 0!==i?i:"s-QuickSearchLoading");var o=function(t){var e,n;if(r.element.removeClass(null!==(e=r.options.loadingParentClass)&&void 0!==e?e:"s-QuickSearchLoading").parent().removeClass(null!==(n=r.options.loadingParentClass)&&void 0!==n?n:"s-QuickSearchLoading"),!t){var i=r.element.closest(".s-QuickSearchBar").find(".quick-search-icon i")[0]
;i&&(i.classList.add("s-shake-effect"),setTimeout((function(){return i.classList.remove("s-shake-effect")}),2e3))}};null!=this.options.onSearch?this.options.onSearch(null==this.field||at(this.field.name)?null:this.field.name,t,o):o(!0)},i=e.__decorate([t.Decorators.registerClass("Serenity.QuickSearchInput")],i)}(lr);t.FilterOperators=void 0,(eo=t.FilterOperators||(t.FilterOperators={})).isTrue="true",eo.isFalse="false",eo.contains="contains",eo.startsWith="startswith",eo.EQ="eq",eo.NE="ne",eo.GT="gt",eo.GE="ge",eo.LT="lt",eo.LE="le",eo.BW="bw",eo.IN="in",eo.isNull="isnull",eo.isNotNull="isnotnull",eo.toCriteriaOperator={eq:"=",ne:"!=",gt:">",ge:">=",lt:"<",le:"<="};var so=function(){function n(t){if(this.items=[],null==t)throw new it("source");this.fields=t.slice(),this.get_fields().sort((function(t,e){var n=_t(t.title);null==n&&null==(n=t.title)&&(n=t.name);var i=_t(e.title);return null==i&&null==(i=e.title)&&(i=e.name),Re.stringCompare(n,i)})),this.fieldByName={}
;for(var e=0,n=t;e<n.length;e++){var i=n[e];this.get_fieldByName()[i.name]=i}}var i;return i=n,n.getCriteriaFor=function(t){if(null==t)return[""];for(var e=!1,n=[""],i=!1,r=[""],o=0;o<t.length;o++){var a=t[o];(a.leftParen||e&&a.rightParen)&&(ai.isEmpty(n)||(e&&(n=ai.paren(n)),r=i?ai.or(r,n):ai.and(r,n),n=[""]),e=!1),a.leftParen&&(i=a.isOr,e=!0),n=a.isOr?ai.or(n,a.criteria):ai.and(n,a.criteria)}return ai.isEmpty(n)||(r=i?ai.or(r,ai.paren(n)):ai.and(r,ai.paren(n))),r},n.getDisplayTextFor=function(t){if(null==t)return"";for(var e=!1,n="",i=0;i<t.length;i++){var r=t[i];e&&(r.rightParen||r.leftParen)&&(n+=")",e=!1),n.length>0&&(n+=" "+vt("Controls.FilterPanel."+(r.isOr?"Or":"And"))+" "),r.leftParen&&(n+="(",e=!0),n+=r.displayText}return e&&(n+=")"),n},n.prototype.get_fields=function(){return this.fields},n.prototype.get_fieldByName=function(){return this.fieldByName},n.prototype.get_items=function(){return this.items},n.prototype.raiseChanged=function(){this.displayText=null,
this.changed&&this.changed(this,{})},n.prototype.add_changed=function(t){this.changed=N(this.changed,t)},n.prototype.remove_changed=function(t){this.changed=q(this.changed,t)},n.prototype.get_activeCriteria=function(){return i.getCriteriaFor(this.items)},n.prototype.get_displayText=function(){return null==this.displayText&&(this.displayText=i.getDisplayTextFor(this.items)),this.displayText},n=i=e.__decorate([t.Decorators.registerClass("Serenity.FilterStore")],n)}(),uo=function(){function n(){}return n=e.__decorate([t.Decorators.registerInterface("Serenity.IFiltering")],n)}(),co=function(){function n(){}return n=e.__decorate([t.Decorators.registerInterface("Serenity.IQuickFiltering")],n)}(),po=function(){function n(){}return n.prototype.get_field=function(){return this.field},n.prototype.set_field=function(t){this.field=t},n.prototype.get_container=function(){return this.container},n.prototype.set_container=function(t){this.container=t},n.prototype.get_operator=function(){
return this.operator},n.prototype.set_operator=function(t){this.operator=t},n.prototype.appendNullableOperators=function(e){return this.isNullable()?(e.push({key:t.FilterOperators.isNotNull}),e.push({key:t.FilterOperators.isNull}),e):e},n.prototype.appendComparisonOperators=function(e){return e.push({key:t.FilterOperators.EQ}),e.push({key:t.FilterOperators.NE}),e.push({key:t.FilterOperators.LT}),e.push({key:t.FilterOperators.LE}),e.push({key:t.FilterOperators.GT}),e.push({key:t.FilterOperators.GE}),e},n.prototype.isNullable=function(){return!0!==this.get_field().required},n.prototype.createEditor=function(){switch(this.get_operator().key){case"true":case"false":case"isnull":case"isnotnull":return;case"contains":case"startswith":case"eq":case"ne":case"lt":case"le":case"gt":case"ge":return void this.get_container().html('<input type="text"/>')}throw new nt(qe("Filtering '{0}' has no editor for '{1}' operator",C(S(this)),this.get_operator().key))},n.prototype.operatorFormat=function(t){
var e,n;return null!==(n=null!==(e=t.format)&&void 0!==e?e:_t("Controls.FilterPanel.OperatorFormats."+t.key))&&void 0!==n?n:t.key},n.prototype.getTitle=function(t){var e,n;return null!==(e=_t(t.title))&&void 0!==e?e:null!==(n=t.title)&&void 0!==n?n:t.name},n.prototype.displayText=function(t,e){return e&&0!==e.length?1===e.length?qe(this.operatorFormat(t),this.getTitle(this.field),e[0]):qe(this.operatorFormat(t),this.getTitle(this.field),e[0],e[1]):qe(this.operatorFormat(t),this.getTitle(this.field))},n.prototype.getCriteriaField=function(){return this.field.name},n.prototype.getCriteria=function(){var t,e={},n=ai(this.getCriteriaField()),i=this.get_operator().key;switch(i){case"true":return e.displayText=this.displayText(this.get_operator(),[]),e.criteria=n.eq(!0),e;case"false":return e.displayText=this.displayText(this.get_operator(),[]),e.criteria=n.eq(!1),e;case"isnull":return e.displayText=this.displayText(this.get_operator(),[]),e.criteria=n.isNull(),e;case"isnotnull":
return e.displayText=this.displayText(this.get_operator(),[]),e.criteria=n.isNotNull(),e;case"contains":return t=this.getEditorText(),e.displayText=this.displayText(this.get_operator(),[t]),e.criteria=n.contains(t),e;case"startswith":return t=this.getEditorText(),e.displayText=this.displayText(this.get_operator(),[t]),e.criteria=n.startsWith(t),e;case"eq":case"ne":case"lt":case"le":case"gt":case"ge":return t=this.getEditorText(),e.displayText=this.displayText(this.get_operator(),[t]),e.criteria=n[i](this.getEditorValue()),e}throw new nt(qe("Filtering '{0}' has no handler for '{1}' operator",C(S(this)),this.get_operator().key))},n.prototype.loadState=function(t){this.get_container().find(":input").first().val(t)},n.prototype.saveState=function(){switch(this.get_operator().key){case"contains":case"startswith":case"eq":case"ne":case"lt":case"le":case"gt":case"ge":return this.get_container().find(":input").first().val()}return null},n.prototype.argumentNull=function(){
return new Error(vt("Controls.FilterPanel.ValueRequired"))},n.prototype.validateEditorValue=function(t){if(0===t.length)throw this.argumentNull();return t},n.prototype.getEditorValue=function(){var t,e,n=this.get_container().find(":input").not(".select2-focusser").first();if(1!==n.length)throw new nt(qe("Couldn't find input in filter container for {0}",null!==(t=this.field.title)&&void 0!==t?t:this.field.name));return e=(null!=(e=null!=n.data("select2")?n.select2("val"):n.val())?e:"").trim(),this.validateEditorValue(e)},n.prototype.getEditorText=function(){var t,e=this.get_container().find(":input").not(".select2-focusser").not(".select2-input").first();return 0===e.length?this.get_container().text().trim():null!=e.data("select2")?(null!==(t=e.select2("data"))&&void 0!==t?t:{}).text:e.val()},n.prototype.initQuickFilter=function(t){t.field=this.getCriteriaField(),t.type=Ir,t.title=this.getTitle(this.field),t.options=p(this.get_field().quickFilterParams)},
n=e.__decorate([t.Decorators.registerClass("Serenity.BaseFiltering",[uo,co])],n)}();function ho(e){return t.Decorators.registerClass("Serenity."+e+"Filtering")}var fo=function(n){function i(t){var e=n.call(this)||this;return e.editorType=t,e}return e.__extends(i,n),i.prototype.useEditor=function(){switch(this.get_operator().key){case"eq":case"ne":case"lt":case"le":case"gt":case"ge":return!0}return!1},i.prototype.createEditor=function(){this.useEditor()?this.editor=lr.create({type:this.editorType,container:this.get_container(),options:this.getEditorOptions(),init:null}):(this.editor=null,n.prototype.createEditor.call(this))},i.prototype.useIdField=function(){return!1},i.prototype.getCriteriaField=function(){return this.useEditor()&&this.useIdField()&&!at(this.get_field().filteringIdField)?this.get_field().filteringIdField:n.prototype.getCriteriaField.call(this)},i.prototype.getEditorOptions=function(){var t=p(this.get_field().editorParams||{});return delete t.cascadeFrom,
d(t,this.get_field().filteringParams)},i.prototype.loadState=function(e){if(this.useEditor()){if(null==e)return;t.EditorUtils.setValue(this.editor,e)}else n.prototype.loadState.call(this,e)},i.prototype.saveState=function(){return this.useEditor()?t.EditorUtils.getValue(this.editor):n.prototype.saveState.call(this)},i.prototype.getEditorValue=function(){if(this.useEditor()){var e=t.EditorUtils.getValue(this.editor);if(null==e||"string"==typeof e&&0===e.trim().length)throw this.argumentNull();return e}return n.prototype.getEditorValue.call(this)},i.prototype.initQuickFilter=function(t){n.prototype.initQuickFilter.call(this,t),t.type=this.editorType,t.options=d(d({},p(this.getEditorOptions())),p(this.get_field().quickFilterParams))},i=e.__decorate([ho("BaseEditor")],i)}(po),go=function(t){function n(){return t.call(this,Ar)||this}return e.__extends(n,t),n.prototype.getOperators=function(){return this.appendNullableOperators(this.appendComparisonOperators([]))},
n=e.__decorate([ho("Date")],n)}(fo),vo=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return e.__extends(i,n),i.prototype.getOperators=function(){return this.appendNullableOperators([{key:t.FilterOperators.isTrue},{key:t.FilterOperators.isFalse}])},i=e.__decorate([ho("Boolean")],i)}(po),yo=function(t){function n(){return t.call(this,Mr)||this}return e.__extends(n,t),n.prototype.getOperators=function(){return this.appendNullableOperators(this.appendComparisonOperators([]))},n.prototype.getCriteria=function(){var e={};switch(this.get_operator().key){case"eq":case"ne":case"lt":case"le":case"gt":case"ge":var n=this.getEditorText();e.displayText=this.displayText(this.get_operator(),[n]);var i=Xe(this.getEditorValue());i=new Date(i.getFullYear(),i.getMonth(),i.getDate());var r=new Date(i.getFullYear(),i.getMonth(),i.getDate()+1),o=ai(this.getCriteriaField()),a=Qe(i,"yyyy-MM-dd"),l=Qe(r,"yyyy-MM-dd");switch(this.get_operator().key){case"eq":
return e.criteria=ai.and(o.ge(a),o.lt(l)),e;case"ne":return e.criteria=ai.paren(ai.or(o.lt(a),o.gt(l))),e;case"lt":return e.criteria=o.lt(a),e;case"le":e.criteria=o.lt(l);case"gt":return e.criteria=o.ge(l),e;case"ge":return e.criteria=o.ge(a),e}}return t.prototype.getCriteria.call(this)},n=e.__decorate([ho("DateTime")],n)}(fo),mo=function(t){function n(){return t.call(this,Pr)||this}return e.__extends(n,t),n.prototype.getOperators=function(){return this.appendNullableOperators(this.appendComparisonOperators([]))},n=e.__decorate([ho("Decimal")],n)}(fo),_o=function(n){function i(){return n.call(this,lr)||this}return e.__extends(i,n),i.prototype.getOperators=function(){var e=[];return e.push({key:t.FilterOperators.EQ}),e.push({key:t.FilterOperators.NE}),this.useRelative&&(e.push({key:t.FilterOperators.LT}),e.push({key:t.FilterOperators.LE}),e.push({key:t.FilterOperators.GT}),e.push({key:t.FilterOperators.GE})),this.useLike&&(e.push({key:t.FilterOperators.contains}),e.push({
key:t.FilterOperators.startsWith})),this.appendNullableOperators(e),e},i.prototype.useEditor=function(){var e=this.get_operator().key;return e===t.FilterOperators.EQ||e===t.FilterOperators.NE||this.useRelative&&(e===t.FilterOperators.LT||e===t.FilterOperators.LE||e===t.FilterOperators.GT||e===t.FilterOperators.GE)},i.prototype.getEditorOptions=function(){var t,e=n.prototype.getEditorOptions.call(this);return this.useEditor()&&this.editorType===(null!==(t=this.get_field().editorType)&&void 0!==t?t:"String")&&(e=d(e,this.get_field().editorParams)),e},i.prototype.createEditor=function(){var e=this;if(this.useEditor()){var i=t.EditorTypeRegistry.get(this.editorType);this.editor=lr.create({type:i,element:function(t){return t.appendTo(e.get_container())},options:this.getEditorOptions()})}else n.prototype.createEditor.call(this)},i.prototype.useIdField=function(){return this.useEditor()},i.prototype.initQuickFilter=function(e){n.prototype.initQuickFilter.call(this,e),
e.type=t.EditorTypeRegistry.get(this.editorType)},e.__decorate([t.Decorators.option()],i.prototype,"editorType",void 0),e.__decorate([t.Decorators.option()],i.prototype,"useRelative",void 0),e.__decorate([t.Decorators.option()],i.prototype,"useLike",void 0),i=e.__decorate([ho("Editor")],i)}(fo),bo=function(n){function i(){return n.call(this,jr)||this}return e.__extends(i,n),i.prototype.getOperators=function(){var e=[{key:t.FilterOperators.EQ},{key:t.FilterOperators.NE}];return this.appendNullableOperators(e)},i=e.__decorate([ho("Enum")],i)}(fo),Co=function(t){function n(){return t.call(this,Or)||this}return e.__extends(n,t),n.prototype.getOperators=function(){return this.appendNullableOperators(this.appendComparisonOperators([]))},n=e.__decorate([ho("Integer")],n)}(fo),wo=function(n){function i(){return n.call(this,Wr)||this}return e.__extends(i,n),i.prototype.getOperators=function(){var e=[{key:t.FilterOperators.EQ},{key:t.FilterOperators.NE},{key:t.FilterOperators.contains},{
key:t.FilterOperators.startsWith}];return this.appendNullableOperators(e)},i.prototype.useEditor=function(){var e=this.get_operator().key;return e==t.FilterOperators.EQ||e==t.FilterOperators.NE},i.prototype.useIdField=function(){return this.useEditor()},i.prototype.getEditorText=function(){return this.useEditor()?this.editor.text:n.prototype.getEditorText.call(this)},i=e.__decorate([ho("Lookup")],i)}(fo),So=function(n){function i(){return n.call(this,Qr)||this}return e.__extends(i,n),i.prototype.getOperators=function(){var e=[{key:t.FilterOperators.EQ},{key:t.FilterOperators.NE},{key:t.FilterOperators.contains},{key:t.FilterOperators.startsWith}];return this.appendNullableOperators(e)},i.prototype.useEditor=function(){var e=this.get_operator().key;return e==t.FilterOperators.EQ||e==t.FilterOperators.NE},i.prototype.useIdField=function(){return this.useEditor()},i.prototype.getEditorText=function(){return this.useEditor()?this.editor.text:n.prototype.getEditorText.call(this)},
i=e.__decorate([ho("ServiceLookup")],i)}(fo),ko=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return e.__extends(i,n),i.prototype.getOperators=function(){var e=[{key:t.FilterOperators.contains},{key:t.FilterOperators.startsWith},{key:t.FilterOperators.EQ},{key:t.FilterOperators.NE}];return this.appendNullableOperators(e)},i.prototype.validateEditorValue=function(t){return 0===t.length?t:n.prototype.validateEditorValue.call(this,t)},i=e.__decorate([ho("String")],i)}(po);t.FilteringTypeRegistry=void 0,function(t){var e;function n(){if(null==e){e={};for(var t=0,n=E();t<n.length;t++){var i=n[t];if(k(uo,i)){var r=C(i).toLowerCase();e[r]=i;for(var o=0,a=Gt.rootNamespaces;o<a.length;o++){var l=a[o];if(ut(r,l.toLowerCase()+".")){var s=r.substr(l.length+1).toLowerCase();null==e[s]&&(e[s]=i)}}}}!function(){for(var t="filtering",n=0,i=Object.keys(e);n<i.length;n++){var r=i[n];if(ot(r,t)){var o=r.substr(0,r.length-t.length);at(o)||null==e[o]&&(e[o]=e[r])}}}()}}
t.get=function(t){if(at(t))throw new it("key");n();var i=e[t.toLowerCase()];if(null==i)throw new nt(qe("Can't find {0} filter handler type!",t));return i}}(t.FilteringTypeRegistry||(t.FilteringTypeRegistry={}));var xo=function(n){function i(t,e){var i=n.call(this,t,e)||this;return i.store=new so([]),i.onFilterStoreChanged=function(){return i.filterStoreChanged()},i.store.add_changed(i.onFilterStoreChanged),i}return e.__extends(i,n),i.prototype.destroy=function(){this.store&&(this.store.remove_changed(this.onFilterStoreChanged),this.onFilterStoreChanged=null,this.store=null),n.prototype.destroy.call(this)},i.prototype.filterStoreChanged=function(){},i.prototype.get_store=function(){return this.store},i.prototype.set_store=function(t){this.store!==t&&(null!=this.store&&this.store.remove_changed(this.onFilterStoreChanged),this.store=t||new so([]),this.store.add_changed(this.onFilterStoreChanged),this.filterStoreChanged())},
i=e.__decorate([t.Decorators.registerClass("Serenity.FilterWidgetBase")],i)}(pr),Io=function(n){function i(t,e){var i,r,o=this;o=n.call(this,t)||this;for(var a=0,l=e;a<l.length;a++){var s=l[a];o.addOption(s.name,null!==(r=null!==(i=_t(s.title))&&void 0!==i?i:s.title)&&void 0!==r?r:s.name,s)}return o}return e.__extends(i,n),i.prototype.emptyItemText=function(){return at(this.value)?vt("Controls.FilterPanel.SelectField"):null},i.prototype.getSelect2Options=function(){var t=n.prototype.getSelect2Options.call(this);return t.allowClear=!1,t},i=e.__decorate([t.Decorators.registerClass("Serenity.FilterFieldSelect")],i)}(Hr),To=function(n){function i(t,e){var i,r,o=this;o=n.call(this,t)||this;for(var a=0,l=e;a<l.length;a++){var s=l[a],u=null!==(i=s.title)&&void 0!==i?i:null!==(r=_t("Controls.FilterPanel.OperatorNames."+s.key))&&void 0!==r?r:s.key;o.addOption(s.key,u,s)}return e.length&&e[0]&&(o.value=e[0].key),o}return e.__extends(i,n),i.prototype.emptyItemText=function(){return null},
i.prototype.getSelect2Options=function(){var t=n.prototype.getSelect2Options.call(this);return t.allowClear=!1,t},i=e.__decorate([t.Decorators.registerClass("Serenity.FilterOperatorSelect")],i)}(Hr),Do=function(n){function i(t){var e=n.call(this,t)||this;return e.element.addClass("s-FilterPanel"),e.rowsDiv=e.byId("Rows"),e.initButtons(),e.updateButtons(),e}return e.__extends(i,n),i.prototype.get_showInitialLine=function(){return this.showInitialLine},i.prototype.set_showInitialLine=function(t){this.showInitialLine!==t&&(this.showInitialLine=t,this.showInitialLine&&0===this.rowsDiv.children().length&&this.addEmptyRow(!1))},i.prototype.filterStoreChanged=function(){n.prototype.filterStoreChanged.call(this),this.updateRowsFromStore()},i.prototype.updateRowsFromStore=function(){this.rowsDiv.empty();for(var t=0,e=this.get_store().get_items();t<e.length;t++){var n=e[t];this.addEmptyRow(!1);var i=this.rowsDiv.children().last(),r=i.children("div.l")
;r.children(".leftparen").toggleClass("active",!!n.leftParen),r.children(".rightparen").toggleClass("active",!!n.rightParen),r.children(".andor").toggleClass("or",!!n.isOr).text(vt(n.isOr?"Controls.FilterPanel.Or":"Controls.FilterPanel.And")),i.children("div.f").find("input.field-select").getWidget(Io).value=n.field,this.rowFieldChange(i),i.children("div.o").find("input.op-select").getWidget(To).set_value(n.operator),this.rowOperatorChange(i);var o=this.getFilteringFor(i);null!=o&&(o.set_operator({key:n.operator}),o.loadState(n.state))}this.get_showInitialLine()&&0===this.rowsDiv.children().length&&this.addEmptyRow(!1),this.updateParens()},i.prototype.get_showSearchButton=function(){return this.showSearchButton},i.prototype.set_showSearchButton=function(t){this.showSearchButton!==t&&(this.showSearchButton=t,this.updateButtons())},i.prototype.get_updateStoreOnReset=function(){return this.updateStoreOnReset},i.prototype.set_updateStoreOnReset=function(t){
this.updateStoreOnReset!==t&&(this.updateStoreOnReset=t)},i.prototype.getTemplate=function(){return"<div id='~_Rows' class='filter-lines'></div><div id='~_Buttons' class='buttons'><button id='~_AddButton' class='btn btn-primary add'></button><button id='~_SearchButton' class='btn btn-success search'></button><button id='~_ResetButton' class='btn btn-danger reset'></button></div><div style='clear: both'></div>"},i.prototype.initButtons=function(){var t=this;this.byId("AddButton").text(vt("Controls.FilterPanel.AddFilter")).click((function(e){return t.addButtonClick(e)})),this.byId("SearchButton").text(vt("Controls.FilterPanel.SearchButton")).click((function(e){return t.searchButtonClick(e)})),this.byId("ResetButton").text(vt("Controls.FilterPanel.ResetButton")).click((function(e){return t.resetButtonClick(e)}))},i.prototype.searchButtonClick=function(t){t.preventDefault(),this.search()},i.prototype.get_hasErrors=function(){
return this.rowsDiv.children().children("div.v").children("span.error").length>0},i.prototype.search=function(){var t;this.rowsDiv.children().children("div.v").children("span.error").remove();for(var e=[],n=null,i=null,r=0;r<this.rowsDiv.children().length;r++){i=this.rowsDiv.children().eq(r);var o=this.getFilteringFor(i);if(null!=o){var a=this.getFieldFor(i),l=i.children("div.o").find("input.op-select").getWidget(To).value;if(null==l||0===l.length){n=vt("Controls.FilterPanel.InvalidOperator");break}var s,u={};u.field=a.name,u.operator=l,u.isOr=i.children("div.l").children("a.andor").hasClass("or"),u.leftParen=i.children("div.l").children("a.leftparen").hasClass("active"),u.rightParen=i.children("div.l").children("a.rightparen").hasClass("active"),o.set_operator({key:l});try{s=o.getCriteria()}catch(e){n=null!==(t=e.message)&&void 0!==t?t:e.toString();break}u.criteria=s.criteria,u.state=o.saveState(),u.displayText=s.displayText,e.push(u)}}
if(null!=n)return $("<span/>").addClass("error").attr("title",n).appendTo(i.children("div.v")),void i.children("div.v").find("input:first").focus();var c=this.get_store().get_items();c.length=0,c.push.apply(c,e),this.get_store().raiseChanged()},i.prototype.addButtonClick=function(t){this.addEmptyRow(!0),t.preventDefault()},i.prototype.resetButtonClick=function(t){t.preventDefault(),this.get_updateStoreOnReset()&&this.get_store().get_items().length>0&&(this.get_store().get_items().length=0,this.get_store().raiseChanged()),this.rowsDiv.empty(),this.updateButtons(),this.get_showInitialLine()&&this.addEmptyRow(!1)},i.prototype.findEmptyRow=function(){var t=null;return this.rowsDiv.children().each((function(e,n){var i=$(n).children("div.f").children("input.field-select").first();if(0===i.length)return!0;var r=i.val();return null!=r&&0!==r.length||(t=$(n),!1)})),t},i.prototype.addEmptyRow=function(t){var e=this,n=this.findEmptyRow()
;if(null!=n)return n.find("input.field-select").select2("focus"),t&&n.find("input.field-select").select2("open"),n;var i=this.rowsDiv.children().last().children("a.andor").hasClass("or"),r=$("<div class='filter-line'><a class='delete'><span></span></a><div class='l'><a class='rightparen' href='#'>)</a><a class='andor' href='#'></a><a class='leftparen' href='#'>(</a></div><div class='f'><input type='hidden' class='field-select'></div><div class='o'></div><div class='v'></div><div style='clear: both'></div></div>").appendTo(this.rowsDiv),o=r.children("div.l").hide();o.children("a.leftparen, a.rightparen").click((function(t){return e.leftRightParenClick(t)}));var a=o.children("a.andor").attr("title",vt("Controls.FilterPanel.ChangeAndOr"));return i?a.addClass("or").text(vt("Controls.FilterPanel.Or")):a.text(vt("Controls.FilterPanel.And")),a.click((function(t){return e.andOrClick(t)})),r.children("a.delete").attr("title",vt("Controls.FilterPanel.RemoveField")).click((function(t){
return e.deleteRowClick(t)})),new Io(r.children("div.f").children("input"),this.get_store().get_fields()).changeSelect2((function(t){return e.onRowFieldChange(t)})),this.updateParens(),this.updateButtons(),r.find("input.field-select").select2("focus"),t&&r.find("input.field-select").select2("open"),r},i.prototype.onRowFieldChange=function(t){var e=$(t.target).closest("div.filter-line");this.rowFieldChange(e),e.children("div.o").find("input.op-select").select2("focus")},i.prototype.rowFieldChange=function(t){t.removeData("Filtering"),t.children("div.f").find("input.field-select").getWidget(Io).get_value(),this.removeFiltering(t),this.populateOperatorList(t),this.rowOperatorChange(t),this.updateParens(),this.updateButtons()},i.prototype.removeFiltering=function(t){t.data("Filtering",null),t.data("FilteringField",null)},i.prototype.populateOperatorList=function(t){var e=this;t.children("div.o").html("");var n=this.getFilteringFor(t);if(null!=n){
var i=t.children("div.o").html("<input/>").children().attr("type","hidden").addClass("op-select"),r=n.getOperators();new To(i,r).changeSelect2((function(t){return e.onRowOperatorChange(t)}))}},i.prototype.getFieldFor=function(t){if(0===t.length)return null;var e=t.children("div.f").find("input.field-select").getWidget(Io);return at(e.value)?null:this.get_store().get_fieldByName()[e.get_value()]},i.prototype.getFilteringFor=function(e){var n,i=this.getFieldFor(e);if(null==i)return null;var r=T(e.data("Filtering"),uo);if(null!=r)return r;var o=t.FilteringTypeRegistry.get(null!==(n=i.filteringType)&&void 0!==n?n:"String"),a=e.children("div.v");return r=new o,t.ReflectionOptionsSetter.set(r,i.filteringParams),r.set_container(a),r.set_field(i),e.data("Filtering",r),r},i.prototype.onRowOperatorChange=function(t){var e=$(t.target).closest("div.filter-line");this.rowOperatorChange(e);var n=e.children("div.v").find(":input:visible").first();try{n.focus()}catch(t){}},
i.prototype.rowOperatorChange=function(t){if(0!==t.length){t.children("div.v").html("");var e=this.getFilteringFor(t);if(null!=e){var n=t.children("div.o").find("input.op-select").getWidget(To);if(!at(n.get_value())){var i=e.getOperators().filter((function(t){return t.key===n.value})),r=i.length>0?i[0]:null;null!=r&&(e.set_operator(r),e.createEditor())}}}},i.prototype.deleteRowClick=function(t){t.preventDefault(),$(t.target).closest("div.filter-line").remove(),0===this.rowsDiv.children().length&&this.search(),this.updateParens(),this.updateButtons()},i.prototype.updateButtons=function(){this.byId("SearchButton").toggle(this.rowsDiv.children().length>=1&&this.showSearchButton),this.byId("ResetButton").toggle(this.rowsDiv.children().length>=1)},i.prototype.andOrClick=function(t){t.preventDefault();var e=$(t.target).toggleClass("or");e.text(vt("Controls.FilterPanel."+(e.hasClass("or")?"Or":"And")))},i.prototype.leftRightParenClick=function(t){t.preventDefault(),
$(t.target).toggleClass("active"),this.updateParens()},i.prototype.updateParens=function(){var t=this.rowsDiv.children();if(0!==t.length){t.removeClass("paren-start"),t.removeClass("paren-end"),t.children("div.l").css("display",1===t.length?"none":"block"),t.first().children("div.l").children("a.rightparen, a.andor").css("visibility","hidden");for(var e=1;e<t.length;e++){t.eq(e).children("div.l").css("display","block").children("a.lefparen, a.andor").css("visibility","visible")}for(var n=!1,i=0;i<t.length;i++){var r=t.eq(i),o=r.children("div.l"),a=o.children("a.leftparen");o.children("a.rightparen").hasClass("active")&&n&&(n=!1,i>0&&t.eq(i-1).addClass("paren-end")),a.hasClass("active")&&(n=!0,i>0&&r.addClass("paren-start"))}}},i=e.__decorate([t.Decorators.registerClass("Serenity.FilterPanel")],i)}(xo),Fo=function(n){function i(){var t=n.call(this)||this;return t.filterPanel=new Do(t.byId("FilterPanel")),t.filterPanel.set_showInitialLine(!0),t.filterPanel.set_showSearchButton(!1),
t.filterPanel.set_updateStoreOnReset(!1),t.dialogTitle=vt("Controls.FilterPanel.DialogTitle"),t}return e.__extends(i,n),i.prototype.get_filterPanel=function(){return this.filterPanel},i.prototype.getTemplate=function(){return'<div id="~_FilterPanel"/>'},i.prototype.getDialogButtons=function(){var t=this;return[{text:vt("Dialogs.OkButton"),click:function(){t.filterPanel.search(),t.filterPanel.get_hasErrors()?qt(vt("Controls.FilterPanel.FixErrorsMessage"),"",null):t.dialogClose()}},{text:vt("Dialogs.CancelButton"),click:function(){return t.dialogClose()}}]},i=e.__decorate([t.Decorators.registerClass("Serenity.FilterDialog")],i)}(_r),Po=function(n){function i(t){var e=n.call(this,t)||this;e.element.find(".cap").text(vt("Controls.FilterPanel.EffectiveFilter")),e.element.find(".edit").text(vt("Controls.FilterPanel.EditFilter")),e.element.find(".reset").attr("title",vt("Controls.FilterPanel.ResetFilterHint"));var i=function(t){t.preventDefault();var n=new Fo
;n.get_filterPanel().set_store(e.get_store()),n.dialogOpen(null)};return e.element.find(".edit").click(i),e.element.find(".txt").click(i),e.element.find(".reset").click((function(t){t.preventDefault(),e.get_store().get_items().length=0,e.get_store().raiseChanged()})),e}return e.__extends(i,n),i.prototype.filterStoreChanged=function(){n.prototype.filterStoreChanged.call(this);var t=ht(this.get_store().get_displayText());this.element.find(".current").toggle(null!=t),this.element.find(".reset").toggle(null!=t),null==t&&(t=vt("Controls.FilterPanel.EffectiveEmpty")),this.element.find(".txt").text("["+t+"]")},i.prototype.getTemplate=function(){return"<div><a class='reset'></a><a class='edit'></a><div class='current'><span class='cap'></span><a class='txt'></a></div></div>"},i=e.__decorate([t.Decorators.registerClass("Serenity.FilterDisplayBar")],i)}(xo),Oo=function(n){function i(t,e){var i=n.call(this,t,d({showRowsPerPage:!0,rowsPerPageOptions:[20,100,500,2e3]},e))||this,r=(e=i.options).view
;if(!r)throw"SlickPager requires view option to be set!"
;i.element.addClass("s-SlickPager slick-pg").html('<div class="slick-pg-in">\n    <div class="slick-pg-grp slick-pg-grp-firstprev">\n        <div class="slick-pg-first slick-pg-btn"><span class="slick-pg-btn-span"></span></div>\n        <div class="slick-pg-prev slick-pg-btn"><span class="slick-pg-btn-span"></span></div>\n    </div>\n    <div class="slick-pg-grp slick-pg-grp-control">\n        <span class="slick-pg-control">\n            <span class="slick-pg-pagetext">'.concat(Ft(vt("Controls.Pager.Page")),'</span>\n            <input id="').concat(i.idPrefix,'CurrentPage" class="slick-pg-current" type="text" size="4" value="1" />\n            <span class="slick-pg-pagesep">/</span>\n            <span class="slick-pg-total">1</span>\n        </span>\n    </div>\n    <div class="slick-pg-grp slick-pg-grp-nextlast">\n        <div class="slick-pg-next slick-pg-btn"><span class="slick-pg-btn-span"></span></div>\n        <div class="slick-pg-last slick-pg-btn"><span class="slick-pg-btn-span"></span></div>\n    </div>\n    <div class="slick-pg-grp slick-pg-grp-reload">\n        <div class="slick-pg-reload slick-pg-btn"><span class="slick-pg-btn-span"></span></div>\n    </div>\n    <div class="slick-pg-grp slick-pg-grp-stat">\n        <span class="slick-pg-stat"></span>\n    </div>\n</div>'))
;var o=i;if($(".slick-pg-reload",i.element).click((function(){r.populate()})),$(".slick-pg-first",i.element).click((function(){o._changePage("first")})),$(".slick-pg-prev",i.element).click((function(){o._changePage("prev")})),$(".slick-pg-next",i.element).click((function(){o._changePage("next")})),$(".slick-pg-last",i.element).click((function(){o._changePage("last")})),$(".slick-pg-current",i.element).keydown((function(t){13==t.keyCode&&o._changePage("input")})),o.options.showRowsPerPage){for(var a="",l="",s=0;s<e.rowsPerPageOptions.length;s++)l=r.rowsPerPage==e.rowsPerPageOptions[s]?'selected="selected"':"",a+="<option value='"+e.rowsPerPageOptions[s]+"' "+l+" >"+e.rowsPerPageOptions[s]+"&nbsp;&nbsp;</option>";$(".slick-pg-in",i.element).prepend('<div class="slick-pg-grp"><select class="slick-pg-size" name="rp">'+a+"</select></div>"),$("select.slick-pg-size",i.element).change((function(){e.onRowsPerPageChange?e.onRowsPerPageChange(+this.value):(r.newp=1,r.setPagingOptions({page:1,
rowsPerPage:+this.value}))}))}return r.onPagingInfoChanged.subscribe((function(){o._updatePager()})),i}return e.__extends(i,n),i.prototype._changePage=function(t){var e=this.options.view;if(!e||e.loading)return!0;var n,i=e.getPagingInfo(),r=i.rowsPerPage&&i.totalCount?Math.ceil(i.totalCount/i.rowsPerPage):1;switch(t){case"first":n=1;break;case"prev":i.page>1&&(n=parseInt(i.page)-1);break;case"next":i.page<r&&(n=parseInt(i.page)+1);break;case"last":n=r;break;case"input":var o=parseInt($("input.slick-pg-current",this.element).val());isNaN(o)||o<1?o=1:o>r&&(o=r),$(".slick-pg-current",this.element).val(o),n=o}if(n==i.page)return!1;this.options.onChangePage?this.options.onChangePage(n):e.setPagingOptions({page:n})},i.prototype._updatePager=function(){var t=this.options.view.getPagingInfo(),e=t.rowsPerPage&&t.totalCount?Math.ceil(t.totalCount/t.rowsPerPage):1;$(".slick-pg-current",this.element).val(t.page),$(".slick-pg-total",this.element).html(e)
;var n,i=(t.page-1)*t.rowsPerPage+1,r=i+t.rowsPerPage-1;t.totalCount<r&&(r=t.totalCount),n=t.loading?Ft(vt("Controls.Pager.LoadingStatus")):t.error?t.error:t.totalCount>0?(n=(n=(n=Ft(vt("Controls.Pager.PageStatus"))).replace(/{from}/,i)).replace(/{to}/,r)).replace(/{total}/,t.totalCount):Ft(vt("Controls.Pager.NoRowStatus")),$(".slick-pg-stat",this.element).html(n),$(".slick-pg-size",this.element).val((t.rowsPerPage||0).toString())},i=e.__decorate([t.Decorators.registerClass("Serenity.SlickPager")],i)}(lr),Eo=function(){function n(){}return n=e.__decorate([t.Decorators.registerInterface("Serenity.IInitializeColumn")],n)}(),Ao=function(){function n(){}return n.prototype.format=function(t){var e,n,i;return null==t.value?"":(t.value?null==(i=_t(this.trueText))&&null==(i=this.trueText)&&(i=null!==(e=_t("Dialogs.YesButton"))&&void 0!==e?e:"Yes"):null==(i=_t(this.falseText))&&null==(i=this.falseText)&&(i=null!==(n=_t("Dialogs.NoButton"))&&void 0!==n?n:"No"),Ft(i))},
e.__decorate([t.Decorators.option()],n.prototype,"falseText",void 0),e.__decorate([t.Decorators.option()],n.prototype,"trueText",void 0),n=e.__decorate([t.Decorators.registerFormatter("Serenity.BooleanFormatter")],n)}(),No=function(){function n(){}return n.prototype.format=function(t){return'<span class="check-box no-float readonly slick-edit-preclick '+(t.value?" checked":"")+'"></span>'},n=e.__decorate([t.Decorators.registerFormatter("Serenity.CheckboxFormatter")],n)}(),Mo=function(){function n(){this.displayFormat=Re.dateFormat}var i;return i=n,n.format=function(t,e){if(null==t)return"";var n;if(t instanceof Date)n=t;else{if("string"!=typeof t)return t.toString();if(null==(n=Xe(t))||isNaN(n.valueOf()))return Ft(t)}return Ft(Qe(n,e))},n.prototype.format=function(t){return i.format(t.value,this.displayFormat)},e.__decorate([t.Decorators.option()],n.prototype,"displayFormat",void 0),n=i=e.__decorate([t.Decorators.registerFormatter("Serenity.DateFormatter")],n)}(),Ro=function(n){
function i(){var t=n.call(this)||this;return t.displayFormat=Re.dateTimeFormat,t}return e.__extends(i,n),i=e.__decorate([t.Decorators.registerFormatter("Serenity.DateTimeFormatter")],i)}(Mo),Bo=function(){function n(){}var i;return i=n,n.prototype.format=function(e){return i.format(t.EnumTypeRegistry.get(this.enumKey),e.value)},n.format=function(e,n){if(null==n)return"";var r=t.Enum.toString(e,n),o=F(e,ui,!1),a=o.length>0?o[0].value:C(e);return i.getText(a,r)},n.getText=function(t,e){var n;return at(e)?"":Ft(null!==(n=_t("Enums."+t+"."+e))&&void 0!==n?n:e)},n.getName=function(e,n){return null==n?"":t.Enum.toString(e,n)},e.__decorate([t.Decorators.option()],n.prototype,"enumKey",void 0),n=i=e.__decorate([t.Decorators.registerFormatter("Serenity.EnumFormatter")],n)}(),Lo=function(){function n(){}var i;return i=n,n.prototype.format=function(t){var e,n,r=I(t.value,String);if(at(r))return"";var o=i.dbFileUrl(r),a=at(this.originalNameProperty)?null:I(t.item[this.originalNameProperty],String)
;a=null!=a?a:"";var l=qe(null!==(e=this.displayFormat)&&void 0!==e?e:"{0}",a,r,o),s=null!==(n=this.iconClass)&&void 0!==n?n:"fa fa-download";return s.startsWith("fa-")&&(s="fa "+s),"<a class='file-download-link' target='_blank' href='"+Ft(o)+"'><i class='"+s+"'></i> "+Ft(l)+"</a>"},n.dbFileUrl=function(t){return t=ft(null!=t?t:"","\\","/"),Ae("~/upload/")+t},n.prototype.initializeColumn=function(t){t.referencedFields=t.referencedFields||[],at(this.originalNameProperty)||t.referencedFields.push(this.originalNameProperty)},e.__decorate([t.Decorators.option()],n.prototype,"displayFormat",void 0),e.__decorate([t.Decorators.option()],n.prototype,"originalNameProperty",void 0),e.__decorate([t.Decorators.option()],n.prototype,"iconClass",void 0),n=i=e.__decorate([t.Decorators.registerFormatter("Serenity.FileDownloadFormatter",[Z,Eo])],n)}(),$o=function(){function n(){}var i;return i=n,n.prototype.format=function(t){return i.format(t.value)},n.format=function(t){var e=Math.floor(t/60),n=t-60*e
;return null==t||isNaN(t)?"":qe("{0}:{1}",e<10?"0"+e:e.toString(),n<10?"0"+n:n.toString())},n=i=e.__decorate([t.Decorators.registerFormatter("Serenity.MinuteFormatter")],n)}(),Vo=function(){function n(){}var i;return i=n,n.prototype.format=function(t){return i.format(t.value,this.displayFormat)},n.format=function(t,e){var n;if(e=null!=e?e:"0.##",null==t)return"";if("number"==typeof t)return isNaN(t)?"":Ft(ze(t,e));var i=Ue(t.toString());return null==i||isNaN(i)?null!==(n=null==t?void 0:t.toString())&&void 0!==n?n:"":Ft(ze(i,e))},e.__decorate([t.Decorators.option()],n.prototype,"displayFormat",void 0),n=i=e.__decorate([t.Decorators.registerFormatter("Serenity.NumberFormatter")],n)}(),qo=function(){function n(){}return n.prototype.format=function(t){var e,n,i,r,o=at(this.urlProperty)?(null!==(n=t.value)&&void 0!==n?n:"").toString():(null!==(e=t.item[this.urlProperty])&&void 0!==e?e:"").toString();if(at(o))return"";at(this.urlFormat)||(o=qe(this.urlFormat,o)),
null!=o&&ut(o,"~/")&&(o=Ae(o));var a=at(this.displayProperty)?(null!==(r=t.value)&&void 0!==r?r:"").toString():(null!==(i=t.item[this.displayProperty])&&void 0!==i?i:"").toString();at(this.displayFormat)||(a=qe(this.displayFormat,a));var l="<a href='"+Ft(o)+"'";return at(this.target)||(l+=" target='"+this.target+"'"),l+=">"+Ft(a)+"</a>"},n.prototype.initializeColumn=function(t){t.referencedFields=t.referencedFields||[],at(this.displayProperty)||t.referencedFields.push(this.displayProperty),at(this.urlProperty)||t.referencedFields.push(this.urlProperty)},e.__decorate([t.Decorators.option()],n.prototype,"displayProperty",void 0),e.__decorate([t.Decorators.option()],n.prototype,"displayFormat",void 0),e.__decorate([t.Decorators.option()],n.prototype,"urlProperty",void 0),e.__decorate([t.Decorators.option()],n.prototype,"urlFormat",void 0),e.__decorate([t.Decorators.option()],n.prototype,"target",void 0),n=e.__decorate([t.Decorators.registerFormatter("Serenity.UrlFormatter",[Z,Eo])],n)}()
;t.FormatterTypeRegistry=void 0,function(t){var e=rr((function(t){return k(Z,t)}),null,"Formatter");t.get=function(t){if(at(t))throw new it("key");var n=e.tryGet(t);if(n)return n;var i='"'.concat(Ft(t),'" formatter class not found! \nMake sure there is such a formatter type under the project root namespace,\nand its namespace parts start with capital letters like MyProject.MyModule.MyFormatter.\n\nIf using ES modules, make sure the formatter type has a decorator like \n@Decorators.registerFormatter(\'MyProject.MyModule.MyFormatter\') with the full name \nof your formatter type and "side-effect-import" this formatter class from the current \n"page.ts/grid.ts/dialog.ts file (import "./path/to/MyFormatter.ts").\n\nAfter applying fixes, build and run "node ./tsbuild.js" (or "tsc" if using namespaces) \nfrom the project folder.');throw qt(i.replace(/\r?\n\r?\n/g,"<br/><br/>"),"",{escapeHtml:!1,timeOut:5e3}),new nt(i)},t.reset=function(){e.reset()},t.tryGet=function(t){return e.tryGet(t)}
}(t.FormatterTypeRegistry||(t.FormatterTypeRegistry={}));var Ho,Go,zo=function(){function n(t,e){var n=this;this.include={},this.grid=t,this.idField=t.getView().idField,this.options=e||{},t.getGrid().onClick.subscribe((function(e,i){if($(e.target).hasClass("select-item")){e.preventDefault();var r=t.getView().getItem(i.row)[n.idField].toString();n.include[r]?delete n.include[r]:n.include[r]=!0;for(var o=0;o<t.getView().getLength();o++)t.getGrid().updateRow(o);n.updateSelectAll()}})),t.getGrid().onHeaderClick.subscribe((function(e,i){if(!e.isDefaultPrevented()&&$(e.target).hasClass("select-all-items")){if(e.preventDefault(),Object.keys(n.include).length>0)A(n.include);else for(var r=0,o=t.getView().getItems().filter(n.isSelectable.bind(n));r<o.length;r++){var a=o[r][n.idField];n.include[a]=!0}n.updateSelectAll(),t.getView().setItems(t.getView().getItems(),!0),setTimeout(n.updateSelectAll.bind(n),0)}})),t.getView().onRowsChanged.subscribe((function(){return n.updateSelectAll()}))}
return n.prototype.updateSelectAll=function(){var t=this.grid.getElement().find(".select-all-header .slick-column-name .select-all-items");if(t){var e=Object.keys(this.include);t.toggleClass("checked",e.length>0&&this.grid.getView().getItems().filter(this.isSelectable.bind(this)).length<=e.length)}},n.prototype.clear=function(){A(this.include),this.updateSelectAll()},n.prototype.resetCheckedAndRefresh=function(){this.include={},this.updateSelectAll(),this.grid.getView().populate()},n.prototype.selectKeys=function(t){for(var e=0,n=t;e<n.length;e++){var i=n[e];this.include[i]=!0}this.updateSelectAll()},n.prototype.getSelectedKeys=function(){return Object.keys(this.include)},n.prototype.getSelectedAsInt32=function(){return Object.keys(this.include).map((function(t){return parseInt(t,10)}))},n.prototype.getSelectedAsInt64=function(){return Object.keys(this.include).map((function(t){return parseInt(t,10)}))},n.prototype.setSelectedKeys=function(t){this.clear()
;for(var e=0,n=t;e<n.length;e++){var i=n[e];this.include[i]=!0}this.updateSelectAll()},n.prototype.isSelectable=function(t){return t&&(null==this.options.selectable||this.options.selectable(t))},n.createSelectColumn=function(t){return{name:'<span class="select-all-items check-box no-float "></span>',nameIsHtml:!0,toolTip:" ",field:"__select__",width:27,minWidth:27,headerCssClass:"select-all-header",sortable:!1,format:function(e){var n=e.item,i=t();return i&&i.isSelectable(n)?'<span class="select-item check-box no-float '+(i.include[e.item[i.idField]]?" checked":"")+'"></span>':""}}},n=e.__decorate([t.Decorators.registerClass("Serenity.GridRowSelectionMixin")],n)}(),jo=function(){function n(t,e){var n=this;this.include={},this.grid=t,this.idField=t.getView().idField,this.options=e||{},t.getGrid().onClick.subscribe((function(e,i){if($(e.target).hasClass("rad-select-item")){e.preventDefault();var r=t.getView().getItem(i.row);if(!n.isSelectable(r))return;var o=r[n.idField].toString()
;1==n.include[o]?A(n.include):(A(n.include),n.include[o]=!0);for(var a=0;a<t.getView().getLength();a++)t.getGrid().updateRow(a)}}))}return n.prototype.isSelectable=function(t){return t&&(null==this.options.selectable||this.options.selectable(t))},n.prototype.clear=function(){A(this.include)},n.prototype.resetCheckedAndRefresh=function(){this.include={},this.grid.getView().populate()},n.prototype.getSelectedKey=function(){var t=Object.keys(this.include);return null!=t&&t.length>0?t[0]:null},n.prototype.getSelectedAsInt32=function(){var t=Object.keys(this.include).map((function(t){return parseInt(t,10)}));return null!=t&&t.length>0?t[0]:null},n.prototype.getSelectedAsInt64=function(){var t=Object.keys(this.include).map((function(t){return parseInt(t,10)}));return null!=t&&t.length>0?t[0]:null},n.prototype.setSelectedKey=function(t){this.clear(),this.include[t]=!0},n.createSelectColumn=function(t){return{name:"",toolTip:" ",field:"__select__",width:27,minWidth:27,headerCssClass:"",
sortable:!1,formatter:function(e,n,i,r,o){var a=t();return a&&a.isSelectable(o)?'<input type="radio" name="radio-selection-group" class="rad-select-item no-float" style="cursor: pointer;width: 13px; height:13px;" '+(a.include[o[a.idField]]?" checked":"")+" /> ":""}}},n=e.__decorate([t.Decorators.registerClass("GridRadioSelectionMixin")],n)}();t.GridSelectAllButtonHelper=void 0,(Ho=t.GridSelectAllButtonHelper||(t.GridSelectAllButtonHelper={})).update=function(t,e){var n=t.element.children(".s-Toolbar");if(0!==n.length){var i=n.getWidget(dr).findButton("select-all-button"),r=t.getView().getItems();i.toggleClass("checked",r.length>0&&!r.some((function(t){return!e(t)})))}},Ho.define=function(t,e,n,i,r,o){var a;return null==r&&(r=null!==(a=_t("Controls.CheckTreeEditor.SelectAll"))&&void 0!==a?a:"Select All"),{title:r,action:"select-all",cssClass:"select-all-button",onClick:function(){
var n=t(),r=n.getView(),a=n.element.children(".s-Toolbar").getWidget(dr).findButton("select-all-button"),l=!a.hasClass("checked");r.beginUpdate();try{for(var s=0,u=r.getItems();s<u.length;s++){var c=u[s];i(c,l),r.updateItem(e(c),c)}o&&o()}finally{r.endUpdate()}a.toggleClass("checked",l)}}},t.GridUtils=void 0,function(t){function e(t,e,n,i,r){var o=$('<div><a href="#"></a></div>').addClass("s-ToggleButton").addClass(e).prependTo(t);o.children("a").click((function(t){t.preventDefault(),o.toggleClass("pressed");var e=o.hasClass("pressed");n&&n(e)})).attr("title",null!=i?i:""),r&&o.addClass("pressed")}function n(t,e,n){var i=$('<div><input type="text"/></div>').addClass("s-QuickSearchBar").prependTo(t);return null!=n&&n.length>0&&i.addClass("has-quick-search-fields"),new lo(i.children(),{fields:n,onSearch:e})}function i(t,e){var n=new Slick.RowMoveManager({cancelEditOnDrag:!0});n.onBeforeMoveRows.subscribe((function(t,e){
for(var n=0;n<e.rows.length;n++)if(e.rows[n]===e.insertBefore||e.rows[n]===e.insertBefore-1)return t.stopPropagation(),!1;return!0})),n.onMoveRows.subscribe((function(n,i){e(i.rows,i.insertBefore);try{t.setSelectedRows([])}catch(t){}})),t.registerPlugin(n)}t.addToggleButton=e,t.addIncludeDeletedToggle=function(t,n,i,r){var o=!1,a=n.onSubmit;n.onSubmit=function(t){return t.params.IncludeDeleted=o,null==a||a(t)},null==i&&(i=vt("Controls.EntityGrid.IncludeDeletedToggle")),e(t,"s-IncludeDeletedToggle",(function(t){o=t,n.seekToPage=1,n.populate()}),i,r),t.bind("remove",(function(){n.onSubmit=null,a=null}))},t.addQuickSearchInput=function(t,e,i,r){var o,a=e.onSubmit;e.onSubmit=function(t){var e;if(o){var n=o.get_value();n&&n.length>0?t.params.ContainsText=n:delete t.params.ContainsText;var i=null===(e=o.get_field())||void 0===e?void 0:e.name;null!=i&&i.length>0?t.params.ContainsField=i:delete t.params.ContainsField}return null==a||a(t)};var l=null;return o=n(t,(function(t,n,i){r&&r(),
e.seekToPage=1,l=i,e.populate()}),i),e.onDataLoaded.subscribe((function(t,n){null!=l&&(l(e.getLength()>0),l=null)})),o},t.addQuickSearchInputCustom=n,t.makeOrderable=i,t.makeOrderableWithUpdateRequest=function(t,e,n,r,o){i(t.getGrid(),(function(i,a){var l,s;if(0!==i.length){var u;a<0?u=1:a>=t.getGrid().getDataLength()?0===(u=null!==(l=n(t.getGrid().getDataItem(t.getGrid().getDataLength()-1)))&&void 0!==l?l:0)?u=a+1:u+=1:0===(u=null!==(s=n(t.getGrid().getDataItem(a)))&&void 0!==s?s:0)&&(u=a+1);var c=0,d=null;(d=function(){Pe({service:r,request:o(e(t.getGrid().getDataItem(i[c])),u++),onSuccess:function(e){++c<i.length?d():t.getView().populate()}})})()}}))}}(t.GridUtils||(t.GridUtils={})),t.PropertyItemSlickConverter=void 0,(Go=t.PropertyItemSlickConverter||(t.PropertyItemSlickConverter={})).toSlickColumns=function(t){var e=[];if(null==t)return e;for(var n=0;n<t.length;n++)e.push(Go.toSlickColumn(t[n]));return e},Go.toSlickColumn=function(e){var n,i,r={field:e.name,sourceItem:e,
cssClass:e.cssClass,headerCssClass:e.headerCssClass,sortable:!1!==e.sortable,sortOrder:null!==(n=e.sortOrder)&&void 0!==n?n:0,width:null!=e.width?e.width:80,minWidth:null!==(i=e.minWidth)&&void 0!==i?i:30,maxWidth:null==e.maxWidth||0===e.maxWidth?null:e.maxWidth,resizable:null==e.resizable||!!e.resizable};r.visible=!1!==e.visible&&!0!==e.filterOnly&&(null==e.readPermission||t.Authorization.hasPermission(e.readPermission));var o=_t(e.title);if(null==o&&(o=e.title),r.name=o,null!=e.alignment&&e.alignment.length>0&&(at(r.cssClass)?r.cssClass="align-"+e.alignment:r.cssClass+=" align-"+e.alignment),null!=e.formatterType&&e.formatterType.length>0){var a=new(t.FormatterTypeRegistry.get(e.formatterType));null!=e.formatterParams&&t.ReflectionOptionsSetter.set(a,e.formatterParams);var l=I(a,Eo);null!=l&&l.initializeColumn(r),r.format=function(t){return a.format(t)}}return r},t.SlickFormatting=void 0,function(t){function e(t,e,n,i,r){
return"<a"+(null!=e?' href="#'+ft(t,".","-")+"/"+e+'"':"")+' data-item-type="'+Ft(t)+'" data-item-id="'+Ft(e)+'" class="s-EditLink s-'+ft(t,".","-")+"Link"+(at(i)?"":" "+i)+'">'+(r?Ft(null!=n?n:""):null!=n?n:"")+"</a>"}t.getEnumText=function(t,e){return Bo.getText(t,e)},t.treeToggle=function(t,e,n){return function(i){var r,o,a=n(i),l=t(),s=null!==(r=i.item._indent)&&void 0!==r?r:0,u='<span class="s-TreeIndent" style="width:'+15*s+'px"></span>',c=e(i.item),d=l.getIdxById(c),p=l.getItemByIdx(d+1);if(null!=p&&(null!==(o=p._indent)&&void 0!==o?o:0)>s)return i.item._collapsed?u+'<span class="s-TreeToggle s-TreeExpand"></span>'+a:u+'<span class="s-TreeToggle s-TreeCollapse"></span>'+a;return u+'<span class="s-TreeToggle"></span>'+a}},t.date=function(t){return null==t&&(t=Re.dateFormat),function(e){return Ft(Mo.format(e.value,t))}},t.dateTime=function(t){return null==t&&(t=Re.dateTimeFormat),function(e){return Ft(Mo.format(e.value,t))}},t.checkBox=function(){return function(t){
return'<span class="check-box no-float '+(t.value?" checked":"")+'"></span>'}},t.number=function(t){return function(e){return Vo.format(e.value,t)}},t.getItemType=function(t){return t.data("item-type")},t.getItemId=function(t){var e=t.data("item-id");return null==e?null:e.toString()},t.itemLinkText=e,t.itemLink=function(t,n,i,r,o){return function(a){var l,s,u=null!==(l=null==i?a.value:i(a))&&void 0!==l?l:"";return(null===(s=a.item)||void 0===s?void 0:s.__nonDataRow)?o?Ft(u):u:e(t,a.item[n],null==i?a.value:i(a),null==r?"":r(a),o)}}}(t.SlickFormatting||(t.SlickFormatting={})),t.SlickHelper=void 0,(t.SlickHelper||(t.SlickHelper={})).setDefaults=function(t,e){for(var n=0,i=t;n<i.length;n++){var r=i[n];r.sortable=null==r.sortable||r.sortable;var o=r.id;if(null==o&&(o=r.field),r.id=o,null!=e&&null!=r.id&&(null==r.name||ut(r.name,"~"))){var a=null!=r.name?r.name.substr(1):r.id;r.name=vt(e+a)}}return t},t.SlickTreeHelper=void 0,function(t){function e(t,e){for(var n=e(t),i=0;null!=n;){
if(n._collapsed)return!1;if(n=e(n),i++>1e3)throw new Error("Possible infinite loop, check parents has no circular reference!")}return!0}function n(t,e){if(null!=t)for(var n=0,i=t;n<i.length;n++){i[n]._collapsed=e}}t.filterCustom=e,t.filterById=function(t,n,i){return e(t,(function(t){var e=i(t);return null==e?null:n.getItemById(e)}))},t.setCollapsed=n,t.setCollapsedFlag=function(t,e){t._collapsed=e},t.setIndents=function(t,e,n,i){for(var r=0,o={},a=0;a<t.length;a++){var l=t[a];if(a>0){var s=n(l);null!=s&&s===e(t[a-1])?r+=1:null==s?r=0:s!==n(t[a-1])&&(r=null!=o[s]?o[s]+1:0)}o[e(l)]=r,l._indent=r,null!=i&&(l._collapsed=i)}},t.toggleClick=function(t,e,i,r,o){var a=$(t.target);if(a.hasClass("s-TreeToggle")&&(a.hasClass("s-TreeCollapse")||a.hasClass("s-TreeExpand"))){var l=r.getItem(e);if(null!=l&&(l._collapsed?l._collapsed=!1:l._collapsed=!0,r.updateItem(o(l),l)),t.shiftKey){r.beginUpdate();try{n(r.getItems(),!!l._collapsed),r.setItems(r.getItems(),!0)}finally{r.endUpdate()}}}}
}(t.SlickTreeHelper||(t.SlickTreeHelper={}));var Uo=function(){function t(t){var e;this.__items=t;for(var n=0,i=t;n<i.length;n++){(u=(s=i[n]).id)&&!this[u]&&(this[u]=s)}for(var r=0,o=t;r<o.length;r++){(u=null===(e=(s=o[r]).sourceItem)||void 0===e?void 0:e.name)&&!this[u]&&(this[u]=s)}for(var a=0,l=t;a<l.length;a++){var s,u;(u=(s=l[a]).field)&&!this[u]&&(this[u]=s)}}return t.prototype.valueOf=function(){return this.__items},t}(),Wo=function(i){function o(e,n){var r=i.call(this,e,n)||this;r.restoringSettings=0;var o=r;r.element.addClass("s-DataGrid").html("");var a=function(){o.layout(),null!=o._layoutTimer&&t.LayoutTimer.store(o._layoutTimer)};r.element.addClass("require-layout").on("layout."+r.uniqueName,a),r.useLayoutTimer()&&(r._layoutTimer=t.LayoutTimer.onSizeChange((function(){return r.element&&r.element[0]}),Tn(a,50))),r.setTitle(r.getInitialTitle());var l=r.getButtons();return null!=l&&r.createToolbar(l),r.slickContainer=r.createSlickContainer(),r.view=r.createView(),
r.useAsync()?r.initAsync():r.initSync(),r}var a;return e.__extends(o,i),a=o,o.prototype.internalInit=function(){var t,e=this;this.allColumns=null!==(t=this.allColumns)&&void 0!==t?t:this.getColumns(),this.slickGrid=this.createSlickGrid(),this.enableFiltering()&&this.createFilterBar(),this.usePager()&&this.createPager(),this.bindToSlickEvents(),this.bindToViewEvents(),this.toolbar&&this.createToolbarExtensions(),this.createQuickFilters(),this.updateDisabledState(),this.updateInterface(),this.initialSettings=this.getCurrentSettings(null);var n=this.restoreSettings(null,null);(null==n?void 0:n.then)?n.then((function(){return window.setTimeout((function(){return e.initialPopulate()}),0)})):window.setTimeout((function(){return e.initialPopulate()}),0)},o.prototype.initSync=function(){this.propertyItemsData=this.getPropertyItemsData(),this.internalInit(),this.afterInit()},o.prototype.initAsync=function(){return e.__awaiter(this,void 0,void 0,(function(){var t
;return e.__generator(this,(function(e){switch(e.label){case 0:return t=this,[4,this.getPropertyItemsDataAsync()];case 1:return t.propertyItemsData=e.sent(),this.internalInit(),this.afterInit(),[2]}}))}))},o.prototype.afterInit=function(){},o.prototype.useAsync=function(){return!1},o.prototype.useLayoutTimer=function(){return!0},o.prototype.attrs=function(t){return F(S(this),t,!0)},o.prototype.layout=function(){if(this.element&&this.element.is(":visible")&&this.slickContainer&&this.slickGrid){var t=this.element.hasClass("responsive-height"),e=null!=this.slickGrid&&this.slickGrid.getOptions().autoHeight;t&&window.innerWidth<768?e||this.slickGrid.setOptions({autoHeight:!0}):e&&(this.slickContainer.css("height",""),this.slickContainer.children(".slick-viewport").css("height",""),this.slickGrid.setOptions({autoHeight:!1})),this.slickGrid.resizeCanvas()}},o.prototype.getInitialTitle=function(){return null},o.prototype.createToolbarExtensions=function(){},
o.prototype.ensureQuickFilterBar=function(){return null==this.quickFiltersDiv&&this.createQuickFilters([]),this.quickFiltersBar},o.prototype.createQuickFilters=function(t){var e=this;null==this.quickFiltersDiv&&(null!=t||(t=this.getQuickFilters())&&null!=t&&t.length)&&(this.quickFiltersDiv=$("<div/>").addClass("quick-filters-bar"),this.toolbar?($("<div/>").addClass("clear").appendTo(this.toolbar.element),this.quickFiltersDiv.appendTo(this.toolbar.element)):this.quickFiltersDiv.appendTo($("<div/>").addClass("s-Toolbar").insertBefore(this.slickContainer)),this.quickFiltersBar=new ao(this.quickFiltersDiv,{filters:t,getTitle:function(t){return e.determineText((function(e){return e+t.field}))},idPrefix:this.uniqueName+"_QuickFilter_"}),this.quickFiltersBar.onChange=function(t){return e.quickFilterChange(t)})},o.prototype.getQuickFilters=function(){return this.allColumns.filter((function(e){
return e.sourceItem&&!0===e.sourceItem.quickFilter&&(null==e.sourceItem.readPermission||t.Authorization.hasPermission(e.sourceItem.readPermission))})).map((function(t){return a.propertyItemToQuickFilter(t.sourceItem)})).filter((function(t){return null!=t}))},o.propertyItemToQuickFilter=function(e){var n,i,r={},o=e.name,a=_t(e.title);null==a&&null==(a=e.title)&&(a=o);var l=t.FilteringTypeRegistry.get(null!==(n=e.filteringType)&&void 0!==n?n:"String");if(l===go)r=ao.dateRange(o,a);else if(l===yo)r=ao.dateTimeRange(o,a,null===(i=e.editorParams)||void 0===i?void 0:i.useUtc);else if(l===vo){var s=e.quickFilterParams||{},u=e.filteringParams||{},c=s.trueText;null==c&&(c=u.trueText);var h=s.falseText;null==h&&(h=u.falseText),r=ao.boolean(o,a,c,h)}else{var f=new l;if(!f||!x(f,co))return null;t.ReflectionOptionsSetter.set(f,e.filteringParams),f.set_field(e),f.set_operator({key:t.FilterOperators.EQ}),f.initQuickFilter(r),r.options=d(p(r.options),e.quickFilterParams)}
return e.quickFilterSeparator&&(r.separator=!0),r.cssClass=e.quickFilterCssClass,r},o.prototype.findQuickFilter=function(t,e){return null!=this.quickFiltersBar?this.quickFiltersBar.find(t,e):$("#"+this.uniqueName+"_QuickFilter_"+e).getWidget(t)},o.prototype.tryFindQuickFilter=function(t,e){if(null!=this.quickFiltersBar)return this.quickFiltersBar.tryFind(t,e);var n=$("#"+this.uniqueName+"_QuickFilter_"+e);return n.length?n.tryGetWidget(t):null},o.prototype.createIncludeDeletedButton=function(){at(this.getIsActiveProperty())&&at(this.getIsDeletedProperty())||t.GridUtils.addIncludeDeletedToggle(this.toolbar.element,this.view,null,!1)},o.prototype.getQuickSearchFields=function(){return null},o.prototype.createQuickSearchInput=function(){var e,n=this,i=t.GridUtils.addQuickSearchInput(this.toolbar.element,this.view,this.getQuickSearchFields(),(function(){return n.persistSettings(null)}));null===(e=null==i?void 0:i.element)||void 0===e||e.attr("id",this.idPrefix+"QuickSearchInput")},
o.prototype.destroy=function(){this._layoutTimer&&(this._layoutTimer=t.LayoutTimer.off(this._layoutTimer)),this.quickFiltersBar&&(this.quickFiltersBar.destroy(),this.quickFiltersBar=null),this.toolbar&&(this.toolbar.destroy(),this.toolbar=null),this.slickGrid&&(this.slickGrid.onClick.clear(),this.slickGrid.onSort.clear(),this.slickGrid.onColumnsResized.clear(),this.slickGrid.onColumnsReordered.clear(),this.slickGrid.destroy(),this.slickGrid=null),this.view&&(this.view.onDataChanged.clear(),this.view.onSubmit=null,this.view.setFilter(null),this.view=null),this.titleDiv=null,i.prototype.destroy.call(this)},o.prototype.getItemCssClass=function(t,e){var n=this.getIsActiveProperty(),i=this.getIsDeletedProperty();if(at(n)&&at(i))return null;if(!n)return t[i]?"deleted":null;var r=t[n];if(null==r)return null;if("number"==typeof r){if(r<0)return"deleted";if(0===r)return"inactive"}else if("boolean"==typeof r&&!1===r)return"deleted";return null},o.prototype.getItemMetadata=function(t,e){
var n=this.getItemCssClass(t,e);return at(n)?new Object:{cssClasses:n}},o.prototype.postProcessColumns=function(e){t.SlickHelper.setDefaults(e,this.getLocalTextDbPrefix());var n=this.getColumnWidthDelta(),i=this.getColumnWidthScale();if(i<0&&(i=1),0!==n||1!==i)for(var r=0,o=e;r<o.length;r++){var a=o[r];"number"==typeof a.width&&(a.width=Math.round(a.width*i+n)),"number"==typeof a.minWidth&&(a.minWidth=Math.round(a.minWidth*i+n)),"number"==typeof a.maxWidth&&(a.maxWidth=Math.round(a.maxWidth*i+n))}return e},o.prototype.getColumnWidthDelta=function(){var t;return null!==(t=a.defaultColumnWidthDelta)&&void 0!==t?t:0},o.prototype.getColumnWidthScale=function(){var t;return null!==(t=a.defaultColumnWidthScale)&&void 0!==t?t:1},o.prototype.initialPopulate=function(){var e=this;this.populateWhenVisible()?(t.LazyLoadHelper.executeEverytimeWhenShown(this.element,(function(){e.refreshIfNeeded()}),!1),this.element.is(":visible")&&this.view&&this.view.populate()):this.view&&this.view.populate()},
o.prototype.canFilterColumn=function(e){return null!=e.sourceItem&&!0!==e.sourceItem.notFilterable&&(null==e.sourceItem.readPermission||t.Authorization.hasPermission(e.sourceItem.readPermission))},o.prototype.initializeFilterBar=function(){var t=this;this.filterBar.set_store(new so(this.allColumns.filter((function(e){return t.canFilterColumn(e)})).map((function(t){return t.sourceItem})))),this.filterBar.get_store().add_changed((function(e,n){t.restoringSettings<=0&&(t.persistSettings(null),t.view&&(t.view.seekToPage=1),t.refresh())}))},o.prototype.createSlickGrid=function(){var t=this.postProcessColumns(this.allColumns).filter((function(t){return!1!==t.visible})),e=this.getSlickOptions(),i=new n.Grid(this.slickContainer,this.view,t,e);return i.registerPlugin(new n.AutoTooltips({enableForHeaderCells:!0})),this.slickGrid=i,this.setInitialSortOrder(),i},o.prototype.setInitialSortOrder=function(){var t=this.getDefaultSortBy();this.view&&(this.view.sortBy=Array.prototype.slice.call(t))
;var e=t.map((function(t){return t&&ot(t.toLowerCase()," desc")?{columnId:ct(t.substr(0,t.length-5)),sortAsc:!1}:{columnId:t,sortAsc:!0}}));this.slickGrid.setSortColumns(e)},o.prototype.itemAt=function(t){return this.slickGrid.getDataItem(t)},o.prototype.rowCount=function(){return this.slickGrid.getDataLength()},o.prototype.getItems=function(){return this.view.getItems()},o.prototype.setItems=function(t){this.view.setItems(t,!0)},o.prototype.bindToSlickEvents=function(){var t=this,e=this;this._slickGridOnSort=function(n,i){e.view.populateLock();try{var r,o=[];if(i.multiColumnSort)for(var a=0;a<i.sortCols.length;a++){var l=i.sortCols[a];null==(r=l.sortCol)&&(r={}),o.push(r.field+(l.sortAsc?"":" DESC"))}else null==(r=i.sortCol)&&(r={}),o.push(r.field+(i.sortAsc?"":" DESC"));e.view.seekToPage=1,e.view.sortBy=o}finally{e.view.populateUnlock()}e.view.getLocalSort&&e.view.getLocalSort()?e.view.sort():e.view.populate(),t.persistSettings(null)},
this.slickGrid.onSort.subscribe(this._slickGridOnSort),this._slickGridOnClick=function(t,n){e.onClick(t,n.row,n.cell)},this.slickGrid.onClick.subscribe(this._slickGridOnClick),this.slickGrid.onColumnsReordered.subscribe((function(e,n){return t.persistSettings(null)})),this.slickGrid.onColumnsResized.subscribe((function(e,n){return t.persistSettings(null)}))},o.prototype.getAddButtonCaption=function(){var t;return null!==(t=_t("Controls.DataGrid.NewButton"))&&void 0!==t?t:"New"},o.prototype.getButtons=function(){return[]},o.prototype.editItem=function(t){throw new Error("Not Implemented!")},o.prototype.editItemOfType=function(t,e){if(t!==this.getItemType())throw new Error("Not Implemented!");this.editItem(e)},o.prototype.onClick=function(e,n,i){if(!e.isDefaultPrevented()){var r=$(e.target);r.hasClass("s-EditLink")||(r=r.closest("a")),r.hasClass("s-EditLink")&&(e.preventDefault(),this.editItemOfType(t.SlickFormatting.getItemType(r),t.SlickFormatting.getItemId(r)))}},
o.prototype.viewDataChanged=function(t,e){this.markupReady(),this.layout()},o.prototype.bindToViewEvents=function(){var t=this;this.view.onDataChanged.subscribe((function(e,n){return t.viewDataChanged(e,n)})),this.view.onSubmit=function(e){return t.onViewSubmit()},this.view.setFilter((function(e,n){return t.onViewFilter(e)})),this.view.onProcessData=function(e,n){return t.onViewProcessData(e)}},o.prototype.onViewProcessData=function(t){return t},o.prototype.onViewFilter=function(t){return!0},o.prototype.getIncludeColumns=function(t){for(var e=0,n=this.slickGrid.getColumns();e<n.length;e++){var i=n[e];if(i.field&&(t[i.field]=!0),i.referencedFields)for(var r=0,o=i.referencedFields;r<o.length;r++){t[o[r]]=!0}}},o.prototype.setCriteriaParameter=function(){if(delete this.view.params.Criteria,this.filterBar){var t=this.filterBar.get_store().get_activeCriteria();ai.isEmpty(t)||(this.view.params.Criteria=t)}},o.prototype.setEquality=function(t,e){Oe(this.view.params,t,e)},
o.prototype.setIncludeColumnsParameter=function(){var t={};this.getIncludeColumns(t);for(var e=[],n=0,i=Object.keys(t);n<i.length;n++){var r=i[n];e.push(r)}this.view.params.IncludeColumns=e},o.prototype.onViewSubmit=function(){return!(this._isDisabled||!this.getGridCanLoad())&&(this.setCriteriaParameter(),this.setIncludeColumnsParameter(),this.invokeSubmitHandlers(),!0)},o.prototype.markupReady=function(){},o.prototype.createSlickContainer=function(){return $('<div class="grid-container"></div>').appendTo(this.element)},o.prototype.createView=function(){var t=this.getViewOptions();return new li(t)},o.prototype.getDefaultSortBy=function(){if(this.slickGrid){var t=this.slickGrid.getColumns().filter((function(t){return t.sortOrder&&0!==t.sortOrder}));if(t.length>0){t.sort((function(t,e){return Math.abs(t.sortOrder)<Math.abs(e.sortOrder)?-1:Math.abs(t.sortOrder)>Math.abs(e.sortOrder)?1:0}));for(var e=[],n=0;n<t.length;n++){var i=t[n];e.push(i.field+(i.sortOrder<0?" DESC":""))}return e}}
return[]},o.prototype.usePager=function(){return!1},o.prototype.enableFiltering=function(){var t=this.attrs(Ci);return t.length>0&&t[0].value},o.prototype.populateWhenVisible=function(){return!1},o.prototype.createFilterBar=function(){var t=$("<div/>").appendTo(this.element);this.filterBar=new Po(t),this.initializeFilterBar()},o.prototype.getPagerOptions=function(){return{view:this.view,rowsPerPage:20,rowsPerPageOptions:[20,100,500,2500]}},o.prototype.createPager=function(){var t=$("<div></div>").appendTo(this.element);new Oo(t,this.getPagerOptions())},o.prototype.getViewOptions=function(){var t=this,e={};return e.idField=this.getIdProperty(),e.sortBy=this.getDefaultSortBy(),this.usePager()?this.element.hasClass("responsive-height")?e.rowsPerPage=$(window.window).width()<768?20:100:e.rowsPerPage=100:e.rowsPerPage=0,e.getItemMetadata=function(e,n){return t.getItemMetadata(e,n)},e},o.prototype.createToolbar=function(t){var e=$('<div class="grid-toolbar"></div>').appendTo(this.element)
;this.toolbar=new dr(e,{buttons:t,hotkeyContext:this.element[0]})},o.prototype.getTitle=function(){return this.titleDiv?this.titleDiv.children(".title-text").text():null},o.prototype.setTitle=function(t){t!==this.getTitle()&&(null==t?this.titleDiv&&(this.titleDiv.remove(),this.titleDiv=null):(this.titleDiv||(this.titleDiv=$('<div class="grid-title"><div class="title-text"></div></div>').prependTo(this.element)),this.titleDiv.children(".title-text").text(t)),this.layout())},o.prototype.getItemType=function(){return"Item"},o.prototype.itemLink=function(e,n,i,r,o){return void 0===o&&(o=!0),null==e&&(e=this.getItemType()),null==n&&(n=this.getIdProperty()),t.SlickFormatting.itemLink(e,n,i,r,o)},o.prototype.getColumnsKey=function(){var t=this.attrs(pi);return t&&t.length>0?t[0].value:null},o.prototype.getPropertyItems=function(){var t;return(null===(t=this.propertyItemsData)||void 0===t?void 0:t.items)||[]},o.prototype.getPropertyItemsData=function(){var e=this.getColumnsKey()
;return this.getColumnsKey!==a.prototype.getColumnsKey||this.getPropertyItems===a.prototype.getPropertyItems||t.ScriptData.canLoad("Columns."+e)?at(e)?{items:[],additionalItems:[]}:hn(e):{items:this.getPropertyItems(),additionalItems:[]}},o.prototype.getPropertyItemsDataAsync=function(){return e.__awaiter(this,void 0,void 0,(function(){var t;return e.__generator(this,(function(e){switch(e.label){case 0:return at(t=this.getColumnsKey())?[3,2]:[4,gn(t)];case 1:return[2,e.sent()];case 2:return[2,{items:[],additionalItems:[]}]}}))}))},o.prototype.getColumns=function(){return this.propertyItemsToSlickColumns(this.getPropertyItems())},o.prototype.propertyItemsToSlickColumns=function(e){for(var n=t.PropertyItemSlickConverter.toSlickColumns(e),i=0;i<e.length;i++){var r=e[i],o=n[i];if(!0===r.editLink){var a={$:o.format},l={$:null!=r.editLinkCssClass?r.editLinkCssClass:null}
;o.format=this.itemLink(null!=r.editLinkItemType?r.editLinkItemType:null,null!=r.editLinkIdField?r.editLinkIdField:null,function(t){return null!=this.oldFormat.$?this.oldFormat.$(t):Ft(t.value)}.bind({oldFormat:a}),function(t){var e;return null!==(e=this.css.$)&&void 0!==e?e:""}.bind({css:l}),!1),at(r.editLinkIdField)||(o.referencedFields=o.referencedFields||[],o.referencedFields.push(r.editLinkIdField))}}return n},o.prototype.getSlickOptions=function(){var t={multiSelect:!1,multiColumnSort:!0,enableCellNavigation:!1};return a.defaultHeaderHeight&&(t.headerRowHeight=a.defaultHeaderHeight),a.defaultRowHeight&&(t.rowHeight=a.defaultRowHeight),t},o.prototype.populateLock=function(){this.view.populateLock()},o.prototype.populateUnlock=function(){this.view.populateUnlock()},o.prototype.getGridCanLoad=function(){return!0},o.prototype.refresh=function(){if(this.populateWhenVisible())return this.slickContainer.is(":visible")?(this.slickContainer.data("needsRefresh",!1),
void this.internalRefresh()):void this.slickContainer.data("needsRefresh",!0);this.internalRefresh()},o.prototype.refreshIfNeeded=function(){this.slickContainer.data("needsRefresh")&&(this.slickContainer.data("needsRefresh",!1),this.internalRefresh())},o.prototype.internalRefresh=function(){this.view.populate()},o.prototype.setIsDisabled=function(t){this._isDisabled!==t&&(this._isDisabled=t,this._isDisabled&&this.view.setItems([],!0),this.updateDisabledState())},Object.defineProperty(o.prototype,"readOnly",{get:function(){return this.get_readOnly()},set:function(t){this.set_readOnly(t)},enumerable:!1,configurable:!0}),o.prototype.get_readOnly=function(){return!!this._readonly},o.prototype.set_readOnly=function(t){!!this._readonly!=!!t&&(this._readonly=!!t,this.updateInterface())},o.prototype.updateInterface=function(){this.toolbar&&this.toolbar.updateInterface()},o.prototype.getRowDefinition=function(){return null},o.prototype.getLocalTextDbPrefix=function(){var t
;return null!=this._localTextDbPrefix||(this._localTextDbPrefix=null!==(t=this.getLocalTextPrefix())&&void 0!==t?t:"",this._localTextDbPrefix.length>0&&!ot(this._localTextDbPrefix,".")&&(this._localTextDbPrefix="Db."+this._localTextDbPrefix+".")),this._localTextDbPrefix},o.prototype.getLocalTextPrefix=function(){var t=this.getRowDefinition();if(t)return t.localTextPrefix;var e=this.attrs(Oi);return e.length>=1?e[0].value:void 0},o.prototype.getIdProperty=function(){var t,e;if(null!=this._idProperty)return this._idProperty;var n=this.getRowDefinition();if(n)return this._idProperty=null!==(t=n.idProperty)&&void 0!==t?t:"";var i=this.attrs(Ti);return 1===i.length?this._idProperty=null!==(e=i[0].value)&&void 0!==e?e:"":this._idProperty="ID"},o.prototype.getIsDeletedProperty=function(){var t;return null===(t=this.getRowDefinition())||void 0===t?void 0:t.isDeletedProperty},o.prototype.getIsActiveProperty=function(){var t,e;if(null!=this._isActiveProperty)return this._isActiveProperty
;var n=this.getRowDefinition();if(n)return this._isActiveProperty=null!==(t=n.isActiveProperty)&&void 0!==t?t:"";var i=this.attrs(Fi);return 1===i.length?this._isActiveProperty=null!==(e=i[0].value)&&void 0!==e?e:"":this._isActiveProperty=""},o.prototype.updateDisabledState=function(){this.slickContainer.toggleClass("ui-state-disabled",!!this._isDisabled)},o.prototype.resizeCanvas=function(){var t;null===(t=this.slickGrid)||void 0===t||t.resizeCanvas()},o.prototype.subDialogDataChange=function(){this.refresh()},o.prototype.addFilterSeparator=function(){this.ensureQuickFilterBar().addSeparator()},o.prototype.determineText=function(t){var e=this.getLocalTextDbPrefix();if(!at(e)){var n=_t(t(e));if(null!=n)return n}return null},o.prototype.addQuickFilter=function(t){return this.ensureQuickFilterBar().add(t)},o.prototype.addDateRangeFilter=function(t,e){return this.ensureQuickFilterBar().addDateRange(t,e)},o.prototype.dateRangeQuickFilter=function(t,e){return ao.dateRange(t,e)},
o.prototype.addDateTimeRangeFilter=function(t,e){return this.ensureQuickFilterBar().addDateTimeRange(t,e)},o.prototype.dateTimeRangeQuickFilter=function(t,e){return ao.dateTimeRange(t,e)},o.prototype.addBooleanFilter=function(t,e,n,i){return this.ensureQuickFilterBar().addBoolean(t,e,n,i)},o.prototype.booleanQuickFilter=function(t,e,n,i){return ao.boolean(t,e,n,i)},o.prototype.invokeSubmitHandlers=function(){null!=this.quickFiltersBar&&this.quickFiltersBar.onSubmit(this.view.params)},o.prototype.quickFilterChange=function(t){this.persistSettings(null),this.view&&(this.view.seekToPage=1),this.refresh()},o.prototype.getPersistanceStorage=function(){return a.defaultPersistanceStorage},o.prototype.getPersistanceKey=function(){var t="GridSettings:",e=window.location.pathname;return at(e)||(t+=e.substr(1).split(String.fromCharCode(47)).slice(0,2).join("/")+":"),t+=C(S(this))},o.prototype.gridPersistanceFlags=function(){return{}},o.prototype.canShowColumn=function(e){if(null==e)return!1
;var n=e.sourceItem;return null==n||!0!==n.filterOnly&&(null==n.readPermission||t.Authorization.hasPermission(n.readPermission))},o.prototype.getPersistedSettings=function(){var t=this.getPersistanceStorage();if(null==t)return null;function e(t){return null!=(t=ht(t))&&ut(t,"{")&&ot(t,"}")?JSON.parse(t):null}var n=t.getItem(this.getPersistanceKey());return(null==n?void 0:n.then)?n.then((function(t){return e(t)})):e(n)},o.prototype.restoreSettings=function(t,e){var n=this;if(null!=t)return this.restoreSettingsFrom(t,e);var i=this.getPersistedSettings();if(null==i?void 0:i.then)return i.then((function(t){return n.restoreSettingsFrom(t)}));this.restoreSettingsFrom(i)},o.prototype.restoreSettingsFrom=function(e,n){var i=this;if(this.slickGrid&&e){var r=this.slickGrid.getColumns(),o=null,a=function(t){o={};for(var e=0;e<t.length;e++){var n=t[e];o[n.id]=n}};this.view.beginUpdate(),this.restoringSettings++;try{if(n=n||this.gridPersistanceFlags(),null!=e.columns){if(!1!==n.columnVisibility){
a(this.allColumns);for(var l=[],s=0;s<e.columns.length;s++){var u=e.columns[s];if(null!=u.id&&!0===u.visible){var c=o[u.id];this.canShowColumn(c)&&(c.visible=!0,l.push(c),delete o[u.id])}}for(var d=0;d<this.allColumns.length;d++){var p=this.allColumns[d];null!=o[p.id]&&(p.visible=!1,l.push(p))}this.allColumns=l,r=this.allColumns.filter((function(t){return!0===t.visible}))}if(!1!==n.columnWidths){a(r);for(var h=0;h<e.columns.length;h++){var f=e.columns[h];if(null!=f.id&&null!=f.width&&0!==f.width){var g=o[f.id];null!=g&&(g.width=f.width)}}}if(!1!==n.sortColumns){a(r);var v=[],y=e.columns.filter((function(t){var e;return null!=t.id&&0!==(null!==(e=t.sort)&&void 0!==e?e:0)}));y.sort((function(t,e){return Math.abs(t.sort)-Math.abs(e.sort)}));for(var m=0;m<y.length;m++){var _=y[m];null!=o[_.id]&&v.push({columnId:_.id,sortAsc:_.sort>0})}this.view.sortBy=v.map((function(t){return t.columnId+(!1===t.sortAsc?" DESC":"")})),this.slickGrid.setSortColumns(v)}this.slickGrid.setColumns(r),
this.slickGrid.invalidate()}if(null!=e.filterItems&&!1!==n.filterItems&&null!=this.filterBar&&null!=this.filterBar.get_store()){var b=this.filterBar.get_store().get_items();b.length=0,b.push.apply(b,e.filterItems),this.filterBar.get_store().raiseChanged()}if(null!=e.includeDeleted&&!1!==n.includeDeleted){var C=this.element.find(".s-IncludeDeletedToggle");!!e.includeDeleted!==C.hasClass("pressed")&&C.children("a").click()}if(null!=e.quickFilters&&!1!==n.quickFilters&&null!=this.quickFiltersDiv&&this.quickFiltersDiv.length>0&&this.quickFiltersDiv.find(".quick-filter-item").each((function(n,r){var o=$(r).data("qffield");if(!at(o)){var a=$("#"+i.uniqueName+"_QuickFilter_"+o).tryGetWidget(lr);if(null!=a){var l=e.quickFilters[o],s=$(r).data("qfloadstate");null!=s?s(a,l):t.EditorUtils.setValue(a,l)}}})),!0===n.quickSearch&&(void 0!==e.quickSearchField||void 0!==e.quickSearchText)){var w=this.toolbar.element.find(".s-QuickSearchInput").first();if(w.length>0){var S=w.tryGetWidget(lo)
;S&&S.restoreState(e.quickSearchText,e.quickSearchField)}}}finally{this.restoringSettings--,this.view.endUpdate()}}},o.prototype.persistSettings=function(t){var e=this.getPersistanceStorage();if(e){var n=this.getCurrentSettings(t);return e.setItem(this.getPersistanceKey(),JSON.stringify(n))}},o.prototype.getCurrentSettings=function(e){var n=this;e=e||this.gridPersistanceFlags();var i={};if(!1!==e.columnVisibility||!1!==e.columnWidths||!1!==e.sortColumns){i.columns=[];for(var o=this.slickGrid.getSortColumns(),a=0,l=this.slickGrid.getColumns();a<l.length;a++){var s=l[a],u={id:s.id};if(!1!==e.columnVisibility&&(u.visible=!0),!1!==e.columnWidths&&(u.width=s.width),!1!==e.sortColumns){var c=r(o,(function(t){return t.columnId==s.id}));u.sort=c>=0?!1!==o[c].sortAsc?c+1:-c-1:0}i.columns.push(u)}}if(!1!==e.includeDeleted&&(i.includeDeleted=this.element.find(".s-IncludeDeletedToggle").hasClass("pressed")),
!1!==e.filterItems&&null!=this.filterBar&&null!=this.filterBar.get_store()&&(i.filterItems=this.filterBar.get_store().get_items().slice()),!0===e.quickSearch){var d=this.toolbar.element.find(".s-QuickSearchInput").first();if(d.length>0){var p=d.tryGetWidget(lo);null!=p&&(i.quickSearchField=p.get_field(),i.quickSearchText=p.element.val())}}return!1!==e.quickFilters&&null!=this.quickFiltersDiv&&this.quickFiltersDiv.length>0&&(i.quickFilters={},this.quickFiltersDiv.find(".quick-filter-item").each((function(r,o){var a,l=$(o).data("qffield");if(!at(l)){var s=$("#"+n.uniqueName+"_QuickFilter_"+l).tryGetWidget(lr);if(null!=s){var u=$(o).data("qfsavestate"),c=null!=u?u(s):t.EditorUtils.getValue(s);if(i.quickFilters[l]=c,!0===e.quickFilterText&&$(o).hasClass("quick-filter-active")){var d,p=$(o).data("qfdisplaytext"),h=$(o).find(".quick-filter-label").text()
;at(d=null!=p?p(s,h):h+" = "+t.EditorUtils.getDisplayText(s))||(at(i.quickFilterText)?i.quickFilterText=d:(i.quickFilterText+=" "+(null!==(a=_t("Controls.FilterPanel.And"))&&void 0!==a?a:"and")+" ",i.quickFilterText+=d))}}}}))),i},o.prototype.getElement=function(){return this.element},o.prototype.getGrid=function(){return this.slickGrid},o.prototype.getView=function(){return this.view},o.prototype.getFilterStore=function(){return null==this.filterBar?null:this.filterBar.get_store()},o=a=e.__decorate([t.Decorators.registerClass("Serenity.DataGrid",[tr]),t.Decorators.element("<div/>")],o)}(lr),Ko=function(n){function i(){var t=n.call(this)||this;return new lo(t.byId("Search"),{onSearch:function(e,n,i){null!=(n=ht(n))&&(n=Select2.util.stripDiacritics(n.toLowerCase())),t.element.find("li").each((function(t,e){$(e).toggle(!n||Select2.util.stripDiacritics($(e).text().toLowerCase()).indexOf(n)>=0)})),i&&i(!0)}}),t.ulVisible=t.byId("VisibleCols"),t.ulHidden=t.byId("HiddenCols"),
t.dialogTitle=vt("Controls.ColumnPickerDialog.Title"),t}var r;return e.__extends(i,n),r=i,i.createToolButton=function(e){function n(){var n=new r;if(n.allColumns=e.allColumns,e.initialSettings){var i=e.initialSettings;i.columns&&i.columns.length&&(n.defaultColumns=i.columns.map((function(t){return t.id})))}n.visibleColumns=e.getGrid().getColumns().map((function(t){return t.id})),n.done=function(){e.allColumns=n.allColumns;var t=n.allColumns.filter((function(t){return!0===t.visible}));e.getGrid().setColumns(t),Promise.resolve(e.persistSettings()).then((function(){return e.getView().populate()}))},t.Router&&t.Router.dialog&&t.Router.dialog(e.element,n.element,(function(){return"columns"})),n.dialogOpen()}return e.element.on("handleroute."+e.uniqueName,(function(t,e){e&&!e.handled&&"columns"==e.route&&n()})),{hint:vt("Controls.ColumnPickerDialog.Title"),action:"column-picker",cssClass:"column-picker-button",icon:"fa-th-list text-blue",onClick:n}},i.prototype.getDialogButtons=function(){
var t=this;return[{text:vt("Controls.ColumnPickerDialog.RestoreDefaults"),click:function(){var e={};t.ulVisible.children().add(t.ulHidden.children()).each((function(t,n){var i=$(n);e[i.data("key")]=i}));for(var n=null,i=0,r=t.defaultColumns;i<r.length;i++){var o=r[i],a=e[o];if(a){null==n?a.prependTo(t.ulVisible):a.insertAfter(n),n=a;var l=a.data("key");delete e[l]}}for(var l in e)e[l].appendTo(t.ulHidden);t.updateListStates()}},{text:vt("Dialogs.OkButton"),click:function(){for(var e=[],n=0,i=t.allColumns;n<i.length;n++){(a=i[n]).visible=!1}t.visibleColumns=t.ulVisible.children().toArray().map((function(n){var i=$(n).data("key"),r=t.colById[i];return r.visible=!0,e.push(r),i}));for(var r=0,o=t.allColumns;r<o.length;r++){var a;(a=o[r]).visible||e.push(a)}t.allColumns=e,t.done&&t.done(),t.dialogClose()}},{text:vt("Dialogs.CancelButton"),click:function(){t.dialogClose()}}]},i.prototype.getDialogOptions=function(){var t=n.prototype.getDialogOptions.call(this);return t.width=600,t},
i.prototype.getTitle=function(t){return"__select__"==t.id?"[x]":t.name||t.toolTip||t.id},i.prototype.allowHide=function(t){return null==t.sourceItem||null==t.sourceItem.allowHide||t.sourceItem.allowHide},i.prototype.createLI=function(t){var e=this.allowHide(t);return $('\n<li data-key="'.concat(t.id,'" class="').concat(e?"":"cant-hide",'">\n<span class="drag-handle">☰</span>\n').concat(Ft(this.getTitle(t)),"\n").concat(e?'<i class="js-hide fa fa-eye-slash" title="'.concat(Ft(vt("Controls.ColumnPickerDialog.HideHint")),'"></i>'):"",'\n<i class="js-show fa fa-eye" title="').concat(Ft(vt("Controls.ColumnPickerDialog.ShowHint")),'"></i>\n</li>'))},i.prototype.updateListStates=function(){this.ulVisible.children().removeClass("bg-info").addClass("bg-success"),this.ulHidden.children().removeClass("bg-success").addClass("bg-info")},i.prototype.setupColumns=function(){var e=this;this.allColumns=this.allColumns||[],this.visibleColumns=this.visibleColumns||[]
;for(var n={},i=0,r=this.visibleColumns;i<r.length;i++){n[g=r[i]]=!0}this.colById={};for(var o=0,a=this.allColumns;o<a.length;o++){var l=a[o];this.colById[l.id]=l}null==this.defaultColumns&&(this.defaultColumns=this.visibleColumns.slice(0));for(var s=[],u=0,c=this.allColumns;u<c.length;u++){var d=c[u];n[d.id]||d.sourceItem&&(!0===d.sourceItem.filterOnly||null!=d.sourceItem.readPermission&&!t.Authorization.hasPermission(d.sourceItem.readPermission))||s.push(d)}for(var p=s.sort((function(t,n){return Re.stringCompare(e.getTitle(t),e.getTitle(n))})),h=0,f=this.visibleColumns;h<f.length;h++){var g=f[h],v=this.colById[g];v&&this.createLI(v).appendTo(this.ulVisible)}for(var y=0,m=p;y<m.length;y++){var _=m[y];this.createLI(_).appendTo(this.ulHidden)}this.updateListStates(),"undefined"!=typeof Sortable&&Sortable.create&&(Sortable.create(this.ulVisible[0],{group:this.uniqueName+"_group",filter:".js-hide",onFilter:function(t){$(t.item).appendTo(e.ulHidden),e.updateListStates()},
onMove:function(t){return!$(t.dragged).hasClass("cant-hide")||t.from!=e.ulVisible[0]||t.to===t.from},onEnd:function(t){return e.updateListStates()}}),Sortable.create(this.ulHidden[0],{group:this.uniqueName+"_group",sort:!1,filter:".js-show",onFilter:function(t){$(t.item).appendTo(e.ulVisible),e.updateListStates()},onEnd:function(){return e.updateListStates()}}))},i.prototype.onDialogOpen=function(){n.prototype.onDialogOpen.call(this),this.element.find("input").removeAttr("disabled"),this.element.closest(".ui-dialog").children(".ui-dialog-buttonpane").find("button").eq(0).addClass("restore-defaults").next().focus(),this.setupColumns(),Nn(this.element)},i.prototype.getTemplate=function(){
return'\n<div class="search"><input id="~_Search" type="text" disabled /></div>\n<div class="columns-container">\n<div class="column-list visible-list bg-success">\n<h5><i class="fa fa-eye"></i> '.concat(Ft(vt("Controls.ColumnPickerDialog.VisibleColumns")),'</h5>\n<ul id="~_VisibleCols"></ul>\n</div>\n<div class="column-list hidden-list bg-info">\n<h5><i class="fa fa-eye-slash"></i> ').concat(Ft(vt("Controls.ColumnPickerDialog.HiddenColumns")),'</h5>\n<ul id="~_HiddenCols"></ul>\n</div>\n</div>')},i=r=e.__decorate([t.Decorators.registerClass("Serenity.ColumnPickerDialog"),t.Decorators.resizable(),t.Decorators.responsive()],i)}(_r),Qo=function(){function e(n){this.options=n;var i=this.dataGrid=n.grid,r=i.getIdProperty(),o=this.getId=function(t){return t[r]};i.element.find(".grid-container").on("click",(function(e){if($(e.target).hasClass("s-TreeToggle")){var n=i.slickGrid.getCellFromEvent(e);n.cell>=0&&n.row>=0&&t.SlickTreeHelper.toggleClick(e,n.row,n.row,i.view,o)}}))
;var a=i.onViewFilter;i.onViewFilter=function(e){return!!a.apply(this,[e])&&t.SlickTreeHelper.filterById(e,i.view,n.getParentId)};var s=i.onViewProcessData;if(i.onViewProcessData=function(i){return(i=s.apply(this,[i])).Entities=e.applyTreeOrdering(i.Entities,o,n.getParentId),t.SlickTreeHelper.setIndents(i.Entities,o,n.getParentId,n.initialCollapse&&n.initialCollapse()||!1),i},n.toggleField){var u=l(i.allColumns||i.slickGrid.getColumns()||[],(function(t){return t.field==n.toggleField}));u&&(u.format=t.SlickFormatting.treeToggle((function(){return i.view}),o,u.format||function(t){return Ft(t.value)}))}}return e.prototype.toggleAll=function(){t.SlickTreeHelper.setCollapsed(this.dataGrid.view.getItems(),!this.dataGrid.view.getItems().every((function(t){return 1==t._collapsed}))),this.dataGrid.view.setItems(this.dataGrid.view.getItems(),!0)},e.prototype.collapseAll=function(){t.SlickTreeHelper.setCollapsed(this.dataGrid.view.getItems(),!0),
this.dataGrid.view.setItems(this.dataGrid.view.getItems(),!0)},e.prototype.expandAll=function(){t.SlickTreeHelper.setCollapsed(this.dataGrid.view.getItems(),!1),this.dataGrid.view.setItems(this.dataGrid.view.getItems(),!0)},e.applyTreeOrdering=function(t,e,n){var i=[],r=a(t,e),o=a(t,n),l={};function s(t){if(!l[t]){l[t]=!0;for(var n=0,r=o[t]||[];n<r.length;n++){var a=r[n];i.push(a),s(e(a))}}}for(var u=0,c=t;u<c.length;u++){var d=c[u],p=n(d);null!=p&&(r[p]||[]).length||(i.push(d),s(e(d)))}return i},e}(),Yo=function(n){function i(t,e){var i=n.call(this,t,e)||this;return t.addClass("s-CheckTreeEditor"),i.updateItems(),i}return e.__extends(i,n),i.prototype.getIdProperty=function(){return"id"},i.prototype.getTreeItems=function(){return[]},i.prototype.updateItems=function(){for(var t=this.getTreeItems(),e={},n=0;n<t.length;n++){var i=t[n];if(i.children=[],at(i.id)||(e[i.id]=i),!at(i.parentId)){var r=e[i.parentId];null!=r&&r.children.push(i)}}this.view.addData({Entities:t,Skip:0,Take:0,
TotalCount:t.length}),this.updateSelectAll(),this.updateFlags()},i.prototype.getEditValue=function(t,e){this.getDelimited()?e[t.name]=this.get_value().join(","):e[t.name]=this.get_value()},i.prototype.setEditValue=function(t,e){var n=t[e.name];this.set_value(n)},i.prototype.getButtons=function(){var e=this;if(at(this.getSelectAllText()))return null;var n=this,i=[];return i.push(t.GridSelectAllButtonHelper.define((function(){return n}),(function(t){return t.id}),(function(t){return t.isSelected}),(function(t,n){t.isSelected!==n&&(t.isSelected=n,e.itemSelectedChanged(t))}),null,(function(){e.updateFlags()}))),i},i.prototype.itemSelectedChanged=function(t){},i.prototype.getSelectAllText=function(){var t;return null!==(t=_t("Controls.CheckTreeEditor.SelectAll"))&&void 0!==t?t:"Select All"},i.prototype.isThreeStateHierarchy=function(){return!1},i.prototype.createSlickGrid=function(){this.element.addClass("slick-no-cell-border").addClass("slick-no-odd-even")
;var t=n.prototype.createSlickGrid.call(this);return this.element.addClass("slick-hide-header"),t.resizeCanvas(),t},i.prototype.onViewFilter=function(e){if(!n.prototype.onViewFilter.call(this,e))return!1;var i=this.view.getItems(),r=this;return t.SlickTreeHelper.filterCustom(e,(function(t){if(null==t.parentId)return null;if(null==r.byId){r.byId={};for(var e=0;e<i.length;e++){var n=i[e];null!=n.id&&(r.byId[n.id]=n)}}return r.byId[t.parentId]}))},i.prototype.getInitialCollapse=function(){return!1},i.prototype.onViewProcessData=function(e){return e=n.prototype.onViewProcessData.call(this,e),this.byId=null,t.SlickTreeHelper.setIndents(e.Entities,(function(t){return t.id}),(function(t){return t.parentId}),this.getInitialCollapse()),e},i.prototype.onClick=function(e,i,r){if(n.prototype.onClick.call(this,e,i,r),e.isDefaultPrevented()||t.SlickTreeHelper.toggleClick(e,i,r,this.view,(function(t){return t.id})),!e.isDefaultPrevented()){var o=$(e.target);if(o.hasClass("check-box")){
if(e.preventDefault(),this._readOnly)return;var a=o.hasClass("checked")||o.hasClass("partial"),l=this.itemAt(i),s=l.isSelected!==!a;this.view.beginUpdate();try{l.isSelected!==!a&&(l.isSelected=!a,this.view.updateItem(l.id,l),this.itemSelectedChanged(l)),s=this.setAllSubTreeSelected(l,l.isSelected)||s,this.updateSelectAll(),this.updateFlags()}finally{this.view.endUpdate()}s&&this.element.triggerHandler("change")}}},i.prototype.updateSelectAll=function(){t.GridSelectAllButtonHelper.update(this,(function(t){return t.isSelected}))},i.prototype.updateFlags=function(){var t=this.view,e=t.getItems();if(this.isThreeStateHierarchy()){t.beginUpdate();try{for(var n=0;n<e.length;n++){var i=e[n];if(null!=i.children&&0!==i.children.length){var r=this.allDescendantsSelected(i),o=r||this.anyDescendantsSelected(i);if(r!==i.isAllDescendantsSelected||o!==i.isSelected){var a=i.isSelected!==o;i.isAllDescendantsSelected=r,i.isSelected=o,t.updateItem(i.id,i),a&&this.itemSelectedChanged(i)}}else{
var l=this.getDescendantsSelected(i);l!==i.isAllDescendantsSelected&&(i.isAllDescendantsSelected=l,t.updateItem(i.id,i))}}}finally{t.endUpdate()}}},i.prototype.getDescendantsSelected=function(t){return!0},i.prototype.setAllSubTreeSelected=function(t,e){for(var n=!1,i=0;i<t.children.length;i++){var r=t.children[i];r.isSelected!==e&&(n=!0,r.isSelected=e,this.view.updateItem(r.id,r),this.itemSelectedChanged(r)),r.children.length>0&&(n=this.setAllSubTreeSelected(r,e)||n)}return n},i.prototype.allItemsSelected=function(){for(var t=0;t<this.rowCount();t++){if(!this.itemAt(t).isSelected)return!1}return this.rowCount()>0},i.prototype.allDescendantsSelected=function(t){if(t.children.length>0)for(var e=0;e<t.children.length;e++){var n=t.children[e];if(!n.isSelected)return!1;if(!this.allDescendantsSelected(n))return!1}return!0},i.prototype.getDelimited=function(){return!!this.options.delimited},i.prototype.anyDescendantsSelected=function(t){
if(t.children.length>0)for(var e=0;e<t.children.length;e++){var n=t.children[e];if(n.isSelected)return!0;if(this.anyDescendantsSelected(n))return!0}return!1},i.prototype.getColumns=function(){var e=this,n=this,i=[];return i.push({field:"text",name:"Kayıt",width:80,format:t.SlickFormatting.treeToggle((function(){return n.view}),(function(t){return t.id}),(function(t){var n="check-box",i=t.item;if(i.hideCheckBox)return e.getItemText(t);var r=e.isThreeStateHierarchy();return i.isSelected&&(r&&!i.isAllDescendantsSelected?n+=" partial":n+=" checked"),e._readOnly&&(n+=" readonly"),'<span class="'+n+'"></span>'+e.getItemText(t)}))}),i},i.prototype.getItemText=function(t){return Ft(t.value)},i.prototype.getSlickOptions=function(){var t=n.prototype.getSlickOptions.call(this);return t.forceFitColumns=!0,t},i.prototype.sortItems=function(){if(this.moveSelectedUp()){for(var t={},e=this.view.getItems(),n=0,i=0;i<e.length;i++){var r=e[i];t[r.id]=n++}e.sort((function(e,n){
if(e.isSelected&&!n.isSelected)return-1;if(n.isSelected&&!e.isSelected)return 1;var i=Re.stringCompare(e.text,n.text);return 0!==i?i:t[e.id]<t[n.id]?-1:t[e.id]>t[n.id]?1:0})),this.view.setItems(e,!0)}},i.prototype.moveSelectedUp=function(){return!1},i.prototype.get_readOnly=function(){return this._readOnly},i.prototype.set_readOnly=function(t){!!this._readOnly!=!!t&&(this._readOnly=!!t,this.view.refresh())},i.prototype.get_value=function(){for(var t=[],e=this.view.getItems(),n=0;n<e.length;n++)e[n].isSelected&&t.push(e[n].id);return t},Object.defineProperty(i.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),i.prototype.set_value=function(t){var e={};if(null!=t){"string"==typeof t&&(t=t.split(",").map((function(t){return ht(t)})).filter((function(t){return null!=t})));for(var n=0;n<t.length;n++)e[t[n]]=!0}this.view.beginUpdate();try{for(var i=this.view.getItems(),r=0;r<i.length;r++){var o=i[r],a=e[o.id]
;a!==o.isSelected&&(o.isSelected=a,this.view.updateItem(o.id,o))}this.updateSelectAll(),this.updateFlags(),this.sortItems()}finally{this.view.endUpdate()}},i=e.__decorate([t.Decorators.registerEditor("Serenity.CheckTreeEditor",[Zi,er,tr]),t.Decorators.element("<div/>")],i)}(Wo),Jo=function(n){function i(e,i){var r=n.call(this,e,i)||this;return r.enableUpdateItems=!0,r.setCascadeFrom(r.options.cascadeFrom),r.updateItems(),t.ScriptData.bindToChange("Lookup."+r.getLookupKey(),r.uniqueName,(function(){return r.updateItems()})),r}return e.__extends(i,n),i.prototype.updateItems=function(){this.enableUpdateItems&&n.prototype.updateItems.call(this)},i.prototype.getLookupKey=function(){return this.options.lookupKey},i.prototype.getButtons=function(){var t;return null!==(t=n.prototype.getButtons.call(this))&&void 0!==t?t:this.options.hideSearch?null:[]},i.prototype.createToolbarExtensions=function(){var e=this;n.prototype.createToolbarExtensions.call(this),
t.GridUtils.addQuickSearchInputCustom(this.toolbar.element,(function(t,n){e.searchText=Select2.util.stripDiacritics(n||"").toUpperCase(),e.view.setItems(e.view.getItems(),!0)}))},i.prototype.getSelectAllText=function(){return this.options.showSelectAll?n.prototype.getSelectAllText.call(this):null},i.prototype.cascadeItems=function(e){var n=this.get_cascadeValue();if(null==n||""===n)return at(this.get_cascadeField())?e:[];var i=n.toString(),r=this.get_cascadeField();return e.filter((function(e){var n,o=null!==(n=e[r])&&void 0!==n?n:t.ReflectionUtils.getPropertyValue(e,r);return!(null==o||o.toString()!==i)}))},i.prototype.filterItems=function(e){var n=this.get_filterValue();if(null==n||""===n)return e;var i=n.toString(),r=this.get_filterField();return e.filter((function(e){var n,o=null!==(n=e[r])&&void 0!==n?n:t.ReflectionUtils.getPropertyValue(e,r);return!(null==o||o.toString()!==i)}))},i.prototype.getLookupItems=function(t){return this.filterItems(this.cascadeItems(t.items))},
i.prototype.getTreeItems=function(){var t=sn(this.options.lookupKey);return this.getLookupItems(t).map((function(e){var n,i;return{id:(null!==(n=e[t.idField])&&void 0!==n?n:"").toString(),text:(null!==(i=e[t.textField])&&void 0!==i?i:"").toString(),source:e}}))},i.prototype.onViewFilter=function(t){return n.prototype.onViewFilter.call(this,t)&&(at(this.searchText)||Select2.util.stripDiacritics(t.text||"").toUpperCase().indexOf(this.searchText)>=0)},i.prototype.moveSelectedUp=function(){return this.options.checkedOnTop},i.prototype.get_cascadeFrom=function(){return this.options.cascadeFrom},Object.defineProperty(i.prototype,"cascadeFrom",{get:function(){return this.get_cascadeFrom()},set:function(t){this.set_cascadeFrom(t)},enumerable:!1,configurable:!0}),i.prototype.getCascadeFromValue=function(e){return t.EditorUtils.getValue(e)},i.prototype.setCascadeFrom=function(t){var e=this;if(at(t))return null!=this.cascadeLink&&(this.cascadeLink.set_parentID(null),this.cascadeLink=null),
void(this.options.cascadeFrom=null);this.cascadeLink=new Cr(lr,this,(function(t){e.set_cascadeValue(e.getCascadeFromValue(t))})),this.cascadeLink.set_parentID(t),this.options.cascadeFrom=t},i.prototype.set_cascadeFrom=function(t){t!==this.options.cascadeFrom&&(this.setCascadeFrom(t),this.updateItems())},i.prototype.get_cascadeField=function(){var t;return null!==(t=this.options.cascadeField)&&void 0!==t?t:this.options.cascadeFrom},Object.defineProperty(i.prototype,"cascadeField",{get:function(){return this.get_cascadeField()},set:function(t){this.set_cascadeField(t)},enumerable:!1,configurable:!0}),i.prototype.set_cascadeField=function(t){this.options.cascadeField=t},i.prototype.get_cascadeValue=function(){return this.options.cascadeValue},Object.defineProperty(i.prototype,"cascadeValue",{get:function(){return this.get_cascadeValue()},set:function(t){this.set_cascadeValue(t)},enumerable:!1,configurable:!0}),i.prototype.set_cascadeValue=function(t){
this.options.cascadeValue!==t&&(this.options.cascadeValue=t,this.value=[],this.updateItems())},i.prototype.get_filterField=function(){return this.options.filterField},Object.defineProperty(i.prototype,"filterField",{get:function(){return this.get_filterField()},set:function(t){this.set_filterField(t)},enumerable:!1,configurable:!0}),i.prototype.set_filterField=function(t){this.options.filterField=t},i.prototype.get_filterValue=function(){return this.options.filterValue},Object.defineProperty(i.prototype,"filterValue",{get:function(){return this.get_filterValue()},set:function(t){this.set_filterValue(t)},enumerable:!1,configurable:!0}),i.prototype.set_filterValue=function(t){this.options.filterValue!==t&&(this.options.filterValue=t,this.value=null,this.updateItems())},i=e.__decorate([t.Decorators.registerEditor("Serenity.CheckLookupEditor")],i)}(Yo),Xo=function(n){function i(t,e){var i=n.call(this,t,e)||this
;return i.element.addClass("route-handler").on("handleroute."+i.uniqueName,(function(t,e){return i.handleRoute(e)})),i}return e.__extends(i,n),i.prototype.handleRoute=function(e){if(!e.handled){if("new"===e.route)return e.handled=!0,void this.addButtonClick();var n=null==St?void 0:St.active,i=e.route.split("/");if(2===i.length&&"edit"===i[0])e.handled=!0,this.editItem(decodeURIComponent(i[1]));else if(2===i.length&&"new"===i[1])e.handled=!0,this.editItemOfType(i[0],null);else{if(3!==i.length||"edit"!==i[1])return;e.handled=!0,this.editItemOfType(i[0],decodeURIComponent(i[2]))}(null==St?void 0:St.active)>n&&e.handled&&e.index>=0&&e.index<e.parts.length-1&&St(document).one("ajaxStop",(function(){setTimeout((function(){return t.Router.resolve("#"+e.parts.join("/+/"))}),1)}))}},i.prototype.usePager=function(){return!0},i.prototype.createToolbarExtensions=function(){this.createIncludeDeletedButton(),this.createQuickSearchInput()},i.prototype.getInitialTitle=function(){
return this.getDisplayName()},i.prototype.getLocalTextPrefix=function(){var t=n.prototype.getLocalTextPrefix.call(this);return null!=t||this.getRowDefinition()?t:this.getEntityType()},i.prototype.getEntityType=function(){if(null!=this._entityType)return this._entityType;var t=this.attrs(bi);if(1===t.length)return this._entityType=t[0].value;var e=C(S(this)),n=e.indexOf(".");return n>=0&&(e=e.substring(n+1)),ot(e,"Grid")?e=e.substr(0,e.length-4):ot(e,"SubGrid")&&(e=e.substr(0,e.length-7)),this._entityType=e,this._entityType},i.prototype.getDisplayName=function(){if(null!=this._displayName)return this._displayName;var t=this.attrs(ci);return t.length>=1?(this._displayName=t[0].displayName,this._displayName=Ct.getDefault(this._displayName,this._displayName)):(this._displayName=_t(this.getLocalTextDbPrefix()+"EntityPlural"),null==this._displayName&&(this._displayName=this.getEntityType())),this._displayName},i.prototype.getItemName=function(){if(null!=this._itemName)return this._itemName
;var t=this.attrs(Pi);return t.length>=1?(this._itemName=t[0].value,this._itemName=Ct.getDefault(this._itemName,this._itemName)):(this._itemName=_t(this.getLocalTextDbPrefix()+"EntitySingular"),null==this._itemName&&(this._itemName=this.getEntityType())),this._itemName},i.prototype.getAddButtonCaption=function(){return qe(vt("Controls.EntityGrid.NewButton"),this.getItemName())},i.prototype.getButtons=function(){var t=this,e=[];return e.push({title:this.getAddButtonCaption(),action:"add",cssClass:"add-button",icon:"fa-plus-circle text-green",hotkey:"alt+n",onClick:function(){t.addButtonClick()},disabled:function(){return!t.hasInsertPermission()||t.readOnly}}),e.push(this.newRefreshButton(!0)),e.push(Ko.createToolButton(this)),e},i.prototype.newRefreshButton=function(t){var e=this;return{title:t?null:vt("Controls.EntityGrid.RefreshButton"),hint:t?vt("Controls.EntityGrid.RefreshButton"):null,icon:"fa-refresh text-blue",action:"refresh",cssClass:"refresh-button",onClick:function(){
e.refresh()}}},i.prototype.addButtonClick=function(){this.editItem(new Object)},i.prototype.editItem=function(t){var e=this;this.createEntityDialog(this.getItemType(),(function(n){var i=I(n,Xi);if(null==i)throw new Error(qe("{0} doesn't implement IEditDialog!",C(S(n))));i.load(t,(function(){i.dialogOpen(e.openDialogsAsPanel)}))}))},i.prototype.editItemOfType=function(t,e){var n=this;t!==this.getItemType()?this.createEntityDialog(t,(function(t){var i=I(t,Xi);if(null==i)throw new Error(qe("{0} doesn't implement IEditDialog!",C(S(t))));i.load(e,(function(){return i.dialogOpen(n.openDialogsAsPanel)}))})):this.editItem(e)},i.prototype.getService=function(){if(null!=this._service)return this._service;var t=this.attrs(zi);return t.length>=1?this._service=t[0].value:this._service=ft(this.getEntityType(),".","/"),this._service},i.prototype.getViewOptions=function(){var t=n.prototype.getViewOptions.call(this);return t.url=Ae("~/Services/"+this.getService()+"/List"),t},
i.prototype.getItemType=function(){return this.getEntityType()},i.prototype.routeDialog=function(e,n){var i=this;t.Router&&t.Router.dialog&&t.Router.dialog(this.element,n.element,(function(){var t="";return e!==i.getItemType()&&(t=e+"/"),null!=n&&null!=n.entityId?t+="edit/"+n.entityId.toString():t+="new",t}))},i.prototype.getInsertPermission=function(){var t;return null===(t=this.getRowDefinition())||void 0===t?void 0:t.insertPermission},i.prototype.hasInsertPermission=function(){return null==this.getInsertPermission()||t.Authorization.hasPermission(this.getInsertPermission())},i.prototype.transferDialogReadOnly=function(e){this.readOnly&&t.EditorUtils.setReadOnly(e,!0)},i.prototype.initDialog=function(e){var n=this;t.SubDialogHelper.bindToDataChange(e,this,(function(t,e){n.subDialogDataChange()}),!0),this.transferDialogReadOnly(e),this.routeDialog(this.getItemType(),e)},i.prototype.initEntityDialog=function(e,n){var i=this
;e!==this.getItemType()?(t.SubDialogHelper.bindToDataChange(n,this,(function(t,e){i.subDialogDataChange()}),!0),this.transferDialogReadOnly(n),this.routeDialog(e,n)):this.initDialog(n)},i.prototype.createEntityDialog=function(t,e){var n=this,i=this.getDialogTypeFor(t);return lr.create({type:i,options:this.getDialogOptionsFor(t),init:function(i){n.initEntityDialog(t,i),e&&e(i)}})},i.prototype.getDialogOptions=function(){return{}},i.prototype.getDialogOptionsFor=function(t){return t===this.getItemType()?this.getDialogOptions():{}},i.prototype.getDialogTypeFor=function(e){return e===this.getItemType()?this.getDialogType():t.DialogTypeRegistry.get(e)},i.prototype.getDialogType=function(){if(null!=this._dialogType)return this._dialogType;var e=this.attrs(gi);return e.length>=1?this._dialogType=e[0].value:this._dialogType=t.DialogTypeRegistry.get(this.getEntityType()),this._dialogType},i=e.__decorate([t.Decorators.registerClass("Serenity.EntityGrid")],i)}(Wo),Zo=function(n){function r(t){
var e=n.call(this,t)||this;return e.useAsync()?e.initAsync():e.initSync(),e}var o;return e.__extends(r,n),o=r,r.prototype.internalInit=function(){this.initPropertyGrid(),this.initLocalizationGrid()},r.prototype.initSync=function(){this.propertyItemsData=this.getPropertyItemsData(),this.internalInit(),this.afterInit()},r.prototype.initAsync=function(){return e.__awaiter(this,void 0,void 0,(function(){var t;return e.__generator(this,(function(e){switch(e.label){case 0:return t=this,[4,this.getPropertyItemsDataAsync()];case 1:return t.propertyItemsData=e.sent(),this.internalInit(),this.afterInit(),[2]}}))}))},r.prototype.afterInit=function(){},r.prototype.useAsync=function(){return!1},r.prototype.destroy=function(){this.propertyGrid&&(this.propertyGrid.destroy(),this.propertyGrid=null),this.localizationGrid&&(this.localizationGrid.destroy(),this.localizationGrid=null),this.undeleteButton=null,this.applyChangesButton=null,this.deleteButton=null,this.saveAndCloseButton=null,
this.editButton=null,this.cloneButton=null,this.toolbar=null,n.prototype.destroy.call(this)},r.prototype.get_entity=function(){return this.entity},r.prototype.set_entity=function(t){this.entity=t||new Object},r.prototype.get_entityId=function(){return this.entityId},r.prototype.set_entityId=function(t){this.entityId=t},r.prototype.getEntityNameFieldValue=function(){var t;return(null!==(t=this.get_entity()[this.getNameProperty()])&&void 0!==t?t:"").toString()},r.prototype.getEntityTitle=function(){var t;if(this.isEditMode()){var e=this.isViewMode()||this.readOnly||!this.hasSavePermission()?vt("Controls.EntityDialog.ViewRecordTitle"):vt("Controls.EntityDialog.EditRecordTitle"),n=null!==(t=this.getEntityNameFieldValue())&&void 0!==t?t:"";return qe(e,this.getEntitySingular(),at(n)?"":" ("+n+")")}return qe(vt("Controls.EntityDialog.NewRecordTitle"),this.getEntitySingular())},r.prototype.updateTitle=function(){this.dialogTitle=this.getEntityTitle()},r.prototype.isCloneMode=function(){
return!1},r.prototype.isEditMode=function(){return null!=this.get_entityId()&&!this.isCloneMode()},r.prototype.isDeleted=function(){if(null==this.get_entityId())return!1;var t=this.getIsDeletedProperty();if(t)return!!this.get_entity()[t];var e=this.get_entity()[this.getIsActiveProperty()];return null!=e&&e<0},r.prototype.isNew=function(){return null==this.get_entityId()},r.prototype.isNewOrDeleted=function(){return this.isNew()||this.isDeleted()},r.prototype.getDeleteOptions=function(t){return{}},r.prototype.deleteHandler=function(t,e){Pe(t)},r.prototype.doDelete=function(t){var e=this,n=this,i={EntityId:this.get_entityId()},r=d({service:this.getService()+"/Delete",request:i,onSuccess:function(r){n.onDeleteSuccess(r),null!=t&&t(r),n.element.triggerHandler("ondatachange",[{entityId:i.EntityId,entity:e.entity,type:"delete"}])}},this.getDeleteOptions(t));this.deleteHandler(r,t)},r.prototype.onDeleteSuccess=function(t){},r.prototype.attrs=function(t){return F(S(this),t,!0)},
r.prototype.getRowDefinition=function(){return null},r.prototype.getEntityType=function(){if(null!=this._entityType)return this._entityType;var t=this.attrs(bi);if(1===t.length)return this._entityType=t[0].value;var e=C(S(this)),n=e.indexOf(".");return n>=0&&(e=e.substring(n+1)),ot(e,"Dialog")||ot(e,"Control")?e=e.substr(0,e.length-6):ot(e,"Panel")&&(e=e.substr(0,e.length-5)),this._entityType=e},r.prototype.getFormKey=function(){if(null!=this._formKey)return this._formKey;var t=this.attrs(Si);return t.length>=1?this._formKey=t[0].value:this._formKey=this.getEntityType()},r.prototype.getLocalTextDbPrefix=function(){var t;return null!=this._localTextDbPrefix||(this._localTextDbPrefix=null!==(t=this.getLocalTextPrefix())&&void 0!==t?t:"",this._localTextDbPrefix.length>0&&!ot(this._localTextDbPrefix,".")&&(this._localTextDbPrefix="Db."+this._localTextDbPrefix+".")),this._localTextDbPrefix},r.prototype.getLocalTextPrefix=function(){var t=this.getRowDefinition();if(t)return t.localTextPrefix
;var e=this.attrs(Oi);return e.length>=1?e[0].value:this.getEntityType()},r.prototype.getEntitySingular=function(){if(null!=this._entitySingular)return this._entitySingular;var t=this.attrs(Pi);if(t.length>=1)this._entitySingular=t[0].value,this._entitySingular=Ct.getDefault(this._entitySingular,this._entitySingular);else{var e=_t(this.getLocalTextDbPrefix()+"EntitySingular");null==e&&(e=this.getEntityType()),this._entitySingular=e}return this._entitySingular},r.prototype.getNameProperty=function(){var t,e;if(null!=this._nameProperty)return this._nameProperty;var n=this.getRowDefinition();if(n)return this._nameProperty=null!==(t=n.nameProperty)&&void 0!==t?t:"";var i=this.attrs(Ni);return i.length>=1?this._nameProperty=null!==(e=i[0].value)&&void 0!==e?e:"":this._nameProperty="Name"},r.prototype.getIdProperty=function(){var t,e;if(null!=this._idProperty)return this._idProperty;var n=this.getRowDefinition();if(n)return this._idProperty=null!==(t=n.idProperty)&&void 0!==t?t:""
;var i=this.attrs(Ti);return 1===i.length?this._idProperty=null!==(e=i[0].value)&&void 0!==e?e:"":this._idProperty="ID"},r.prototype.getIsActiveProperty=function(){var t,e;if(null!=this._isActiveProperty)return this._isActiveProperty;var n=this.getRowDefinition();if(n)return this._isActiveProperty=null!==(t=n.isActiveProperty)&&void 0!==t?t:"";var i=this.attrs(Fi);return 1===i.length?this._isActiveProperty=null!==(e=i[0].value)&&void 0!==e?e:"":this._isActiveProperty=""},r.prototype.getIsDeletedProperty=function(){var t;return null===(t=this.getRowDefinition())||void 0===t?void 0:t.isDeletedProperty},r.prototype.getService=function(){if(null!=this._service)return this._service;var t=this.attrs(zi);return t.length>=1?this._service=t[0].value:this._service=ft(this.getEntityType(),".","/"),this._service},r.prototype.load=function(t,e,n){var i=this,r=function(){if(null==t)return i.loadResponse({}),void(e&&e());var n=typeof t;if("string"!==n&&"number"!==n){var r=t||new Object
;i.loadResponse({Entity:r}),e&&e()}else{var o=t;i.loadById(o,(function(t){e&&window.setTimeout(e,0)}),null)}};if(null!=n)try{r()}catch(t){n(nt.wrap(t))}else r()},r.prototype.loadNewAndOpenDialog=function(t){this.loadResponse({}),this.dialogOpen(t)},r.prototype.loadEntityAndOpenDialog=function(t,e){this.loadResponse({Entity:t}),this.dialogOpen(e)},r.prototype.loadResponse=function(t){t=t||{},this.onLoadingData(t);var e=t.Entity||new Object;this.beforeLoadEntity(e),this.loadEntity(e),this.set_entity(e),this.afterLoadEntity()},r.prototype.loadEntity=function(e){var n=this.getIdProperty();null!=n&&this.set_entityId(e[n]),this.set_entity(e),null!=this.propertyGrid&&(this.propertyGrid.set_mode(this.isEditMode()?t.PropertyGridMode.update:t.PropertyGridMode.insert),this.propertyGrid.load(e))},r.prototype.beforeLoadEntity=function(t){this.localizationPendingValue=null,this.localizationLastValue=null},r.prototype.afterLoadEntity=function(){this.updateInterface(),this.updateTitle()},
r.prototype.loadByIdAndOpenDialog=function(t,e){var n=this;this.loadById(t,(function(t){return window.setTimeout((function(){return n.dialogOpen(e)}),0)}),(function(){n.element.is(":visible")||n.element.remove()}))},r.prototype.onLoadingData=function(t){},r.prototype.getLoadByIdOptions=function(t,e){return{}},r.prototype.getLoadByIdRequest=function(t){var e={};return e.EntityId=t,e},r.prototype.reloadById=function(){this.loadById(this.get_entityId())},r.prototype.loadById=function(t,e,n){var i=this,r=d({service:this.getService()+"/Retrieve",blockUI:!0,request:this.getLoadByIdRequest(t),onSuccess:function(t){i.loadResponse(t),e&&e(t)},onCleanup:function(){null!=i.validator&&Jn(i.validator)}},this.getLoadByIdOptions(t,e));this.loadByIdHandler(r,e,n)},r.prototype.loadByIdHandler=function(t,e,n){var i=Pe(t);n&&i.fail(n)},r.prototype.initLocalizationGrid=function(){if(!(this.byId("PropertyGrid").length<=0)){var t=this.getPropertyGridOptions();this.initLocalizationGridCommon(t)}},
r.prototype.initLocalizationGridCommon=function(t){var e=this.byId("PropertyGrid");if(i(t.items,(function(t){return!0===t.localizable}))){var n=$("<div/>").attr("id",this.idPrefix+"LocalizationGrid").hide().insertAfter(e);t.idPrefix=this.idPrefix+"Localization_";for(var r=[],o=0,a=t.items;o<a.length;o++){var l=a[o],s=null;if(!0===l.localizable){var u=d({},l);u.oneWay=!0,u.readOnly=!0,u.required=!1,u.defaultValue=null,r.push(u),null==s&&(s=this.getLangs());for(var c=0,p=s;c<p.length;c++){var h=p[c];(u=d({},l)).name=h[0]+"$"+u.name,u.title=h[1],u.cssClass=[u.cssClass,"translation"].join(" "),u.insertable=!0,u.updatable=!0,u.oneWay=!1,u.required=!1,u.localizable=!1,u.defaultValue=null,r.push(u)}}}t.items=r,this.localizationGrid=new Sr(n,t).init(null),n.addClass("s-LocalizationGrid")}},r.prototype.isLocalizationMode=function(){return null!=this.localizationButton&&this.localizationButton.hasClass("pressed")},r.prototype.isLocalizationModeAndChanged=function(){
if(!this.isLocalizationMode())return!1;var t=this.getLocalizationGridValue();return JSON.stringify(this.localizationLastValue)!=JSON.stringify(t)},r.prototype.localizationButtonClick=function(){if(!this.isLocalizationMode()||this.validateForm()){if(this.isLocalizationModeAndChanged()){var t=this.getLocalizationGridValue();this.localizationLastValue=t,this.localizationPendingValue=t}this.localizationButton.toggleClass("pressed"),this.updateInterface(),this.isLocalizationMode()&&this.loadLocalization()}},r.prototype.getLanguages=function(){return null!=o.defaultLanguageList&&o.defaultLanguageList()||[]},r.prototype.getLangs=function(){var t=this.getLanguages(),e=I(t,Array);return null!=e&&0!==e.length&&null!=e[0]&&Array.isArray(e[0])||(e=Array.prototype.slice.call(t.map((function(t){return[t.item1,t.item2]})))),e},r.prototype.loadLocalization=function(){var t=this;if(null==this.localizationLastValue&&this.isNew())return this.localizationGrid.load({}),
this.setLocalizationGridCurrentValues(),void(this.localizationLastValue=this.getLocalizationGridValue());if(null!=this.localizationLastValue)return this.localizationGrid.load(this.localizationLastValue),void this.setLocalizationGridCurrentValues();var e={service:this.getService()+"/Retrieve",blockUI:!0,request:{EntityId:this.get_entityId(),ColumnSelection:"keyOnly",IncludeColumns:["Localizations"]},onSuccess:function(e){var n=d(new Object,t.get_entity());if(e.Localizations)for(var i=0,r=Object.keys(e.Localizations);i<r.length;i++)for(var o=r[i],a=e.Localizations[o],l=0,s=Object.keys(a);l<s.length;l++){var u=s[l];n[o+"$"+u]=a[u]}t.localizationGrid.load(n),t.setLocalizationGridCurrentValues(),t.localizationPendingValue=null,t.localizationLastValue=t.getLocalizationGridValue()}};Pe(e)},r.prototype.setLocalizationGridCurrentValues=function(){var t=this,e={};this.localizationGrid.enumerateItems((function(n,i){n.name.indexOf("$")<0&&i.element.is(":input")&&(e[n.name]=t.byId(n.name).val(),
i.element.val(e[n.name]))})),this.localizationGrid.enumerateItems((function(t,n){var i=t.name.indexOf("$");if(i>=0&&n.element.is(":input")){var r=e[t.name.substr(i+1)];null!=r&&r.length>0&&n.element.attr("title",r).attr("placeholder",r)}}))},r.prototype.getLocalizationGridValue=function(){var t={};this.localizationGrid.save(t);for(var e=0,n=Object.keys(t);e<n.length;e++){var i=n[e];i.indexOf("$")<0&&delete t[i]}return t},r.prototype.getPendingLocalizations=function(){if(null==this.localizationPendingValue)return null;for(var t={},e=this.getIdProperty(),n=0,i=this.getLangs();n<i.length;n++){var r=i[n][0],o={};null!=e&&(o[e]=this.get_entityId());for(var a=r+"$",l=0,s=Object.keys(this.localizationPendingValue);l<s.length;l++){var u=s[l];ut(u,a)&&(o[u.substr(a.length)]=this.localizationPendingValue[u])}t[r]=o}return t},r.prototype.initPropertyGrid=function(){var t=this.byId("PropertyGrid");if(!(t.length<=0)){var e=this.getPropertyGridOptions();this.propertyGrid=new Sr(t,e).init(null),
this.element.closest(".ui-dialog").hasClass("s-Flexify")&&this.propertyGrid.element.children(".categories").flexHeightOnly(1)}},r.prototype.getPropertyItems=function(){var t;return(null===(t=this.propertyItemsData)||void 0===t?void 0:t.items)||[]},r.prototype.getPropertyItemsData=function(){var e=this.getFormKey();return this.getFormKey!==o.prototype.getFormKey||this.getPropertyItems===o.prototype.getPropertyItems||t.ScriptData.canLoad("Form."+e)?at(e)?{items:[],additionalItems:[]}:yn(e):{items:this.getPropertyItems(),additionalItems:[]}},r.prototype.getPropertyItemsDataAsync=function(){return e.__awaiter(this,void 0,void 0,(function(){var t;return e.__generator(this,(function(e){switch(e.label){case 0:return at(t=this.getFormKey())?[3,2]:[4,_n(t)];case 1:return[2,e.sent()];case 2:return[2,{items:[],additionalItems:[]}]}}))}))},r.prototype.getPropertyGridOptions=function(){return{idPrefix:this.idPrefix,items:this.getPropertyItems(),mode:t.PropertyGridMode.insert,
localTextPrefix:"Forms."+this.getFormKey()+".",useCategories:!0}},r.prototype.validateBeforeSave=function(){return!0},r.prototype.getSaveOptions=function(t){var e=this,n={};return n.service=this.getService()+"/"+(this.isEditMode()?"Update":"Create"),n.onSuccess=function(i){e.onSaveSuccess(i),t&&t(i);var r={type:e.isEditMode()?"update":"create",entity:null==n.request?null:n.request.Entity,entityId:e.isEditMode()?e.get_entityId():null==i?null:i.EntityId};e.element.triggerHandler("ondatachange",[r])},n.onCleanup=function(){e.validator&&Jn(e.validator)},n.request=this.getSaveRequest(),n},r.prototype.getSaveEntity=function(){var t=new Object;if(null!=this.propertyGrid&&this.propertyGrid.save(t),this.isEditMode()){var e=this.getIdProperty();null!=e&&null==t[e]&&(t[e]=this.get_entityId())}return t},r.prototype.getSaveRequest=function(){var t=this.getSaveEntity(),e={};(e.Entity=t,this.isEditMode())&&(null!=this.getIdProperty()&&(e.EntityId=this.get_entityId()))
;return null!=this.localizationPendingValue&&(e.Localizations=this.getPendingLocalizations()),e},r.prototype.onSaveSuccess=function(t){},r.prototype.save_submitHandler=function(t){var e=this.getSaveOptions(t);this.saveHandler(e,t)},r.prototype.save=function(e){var n=this;return t.ValidationHelper.submit(this.byId("Form"),(function(){return n.validateBeforeSave()}),(function(){return n.save_submitHandler(e)}))},r.prototype.saveHandler=function(t,e){Pe(t)},r.prototype.initToolbar=function(){n.prototype.initToolbar.call(this),this.toolbar&&(this.saveAndCloseButton=this.toolbar.findButton("save-and-close-button"),this.applyChangesButton=this.toolbar.findButton("apply-changes-button"),this.deleteButton=this.toolbar.findButton("delete-button"),this.undeleteButton=this.toolbar.findButton("undo-delete-button"),this.editButton=this.toolbar.findButton("edit-button"),this.cloneButton=this.toolbar.findButton("clone-button"),this.localizationButton=this.toolbar.findButton("localization-button"))},
r.prototype.showSaveSuccessMessage=function(t){Vt(vt("Controls.EntityDialog.SaveSuccessMessage"),"",null)},r.prototype.getToolbarButtons=function(){var e=this,n=[];return n.push({title:vt("Controls.EntityDialog.SaveButton"),action:"save-and-close",cssClass:"save-and-close-button",icon:"fa-check-circle text-purple",hotkey:"alt+s",onClick:function(){e.save((function(t){e.dialogClose()}))},visible:function(){return!e.isDeleted()&&!e.isViewMode()},disabled:function(){return!e.hasSavePermission()||e.readOnly}}),n.push({title:"",hint:vt("Controls.EntityDialog.ApplyChangesButton"),action:"apply-changes",cssClass:"apply-changes-button",icon:"fa-clipboard-check text-purple",hotkey:"alt+a",onClick:function(){e.save((function(t){if(e.isEditMode()){var n=t.EntityId;null==n&&(n=e.get_entityId()),e.loadById(n)}else e.loadById(t.EntityId);e.showSaveSuccessMessage(t)}))},visible:function(){return!e.isDeleted()&&!e.isViewMode()},disabled:function(){return!e.hasSavePermission()||e.readOnly}}),n.push({
title:vt("Controls.EntityDialog.DeleteButton"),cssClass:"delete-button",icon:"fa-trash-o text-red",hotkey:"alt+x",onClick:function(){he(vt("Controls.EntityDialog.DeleteConfirmation"),(function(){e.doDelete((function(){return e.dialogClose()}))}))},visible:function(){return e.isEditMode()&&!e.isDeleted()&&!e.isViewMode()},disabled:function(){return!e.hasDeletePermission()||e.readOnly}}),n.push({title:vt("Controls.EntityDialog.UndeleteButton"),action:"undo-delete",cssClass:"undo-delete-button",onClick:function(){e.isDeleted()&&he(vt("Controls.EntityDialog.UndeleteConfirmation"),(function(){e.undelete((function(){return e.loadById(e.get_entityId())}))}))},visible:function(){return e.isEditMode()&&e.isDeleted()&&!e.isViewMode()},disabled:function(){return!e.hasDeletePermission()||e.readOnly}}),this.useViewMode()&&n.push({title:vt("Controls.EntityDialog.EditButton"),action:"delete",cssClass:"edit-button",icon:"fa-edit",onClick:function(){e.isEditMode()&&(e.editClicked=!0,
e.updateInterface(),e.updateTitle())},visible:function(){return e.isViewMode()},disabled:function(){return!e.hasSavePermission()||e.readOnly}}),n.push({title:vt("Controls.EntityDialog.LocalizationButton"),action:"localization",cssClass:"localization-button",onClick:function(){return e.localizationButtonClick()}}),n.push({title:vt("Controls.EntityDialog.CloneButton"),action:"clone",cssClass:"clone-button",icon:"fa-clone",onClick:function(){if(e.isEditMode()){var n=e.getCloningEntity();lr.create({type:S(e),init:function(i){return t.SubDialogHelper.bubbleDataChange(t.SubDialogHelper.cascade(i,e.element),e,!0).loadEntityAndOpenDialog(n,null)}})}},visible:function(){return!1},disabled:function(){return!e.hasInsertPermission()||e.readOnly}}),n},r.prototype.getCloningEntity=function(){var t=new Object;t=d(t,this.get_entity());var e=this.getIdProperty();at(e)||delete t[e];var n=this.getIsActiveProperty();at(n)||delete t[n];var i=this.getIsDeletedProperty();return at(i)||delete t[i],t},
r.prototype.updateInterface=function(){t.EditorUtils.setContainerReadOnly(this.byId("Form"),!1);var e=this.isLocalizationMode(),n=this.hasSavePermission(),i=this.isViewMode(),r=this.readOnly;if(this.toolbar.updateInterface(),null!=this.tabs&&t.TabsExtensions.setDisabled(this.tabs,"Log",this.isNewOrDeleted()),null!=this.propertyGrid&&this.propertyGrid.element.toggle(!e),null!=this.localizationGrid&&this.localizationGrid.element.toggle(e),null!=this.localizationButton&&(this.localizationButton.toggle(null!=this.localizationGrid),this.localizationButton.find(".button-inner").text(this.isLocalizationMode()?vt("Controls.EntityDialog.LocalizationBack"):vt("Controls.EntityDialog.LocalizationButton"))),e)return null!=this.toolbar&&this.toolbar.findButton("tool-button").not(".localization-hidden").addClass(".localization-hidden").hide(),void(this.localizationButton&&this.localizationButton.show());this.toolbar.findButton("localization-hidden").removeClass("localization-hidden").show(),
(!n||i||r)&&t.EditorUtils.setContainerReadOnly(this.byId("Form"),!0)},r.prototype.getUndeleteOptions=function(t){return{}},r.prototype.undeleteHandler=function(t,e){Pe(t)},r.prototype.undelete=function(t){var e=this,n={};n.service=this.getService()+"/Undelete";var i={};i.EntityId=this.get_entityId(),n.request=i,n.onSuccess=function(n){t&&t(n),e.element.triggerHandler("ondatachange",[{entityId:e.get_entityId(),entity:e.entity,type:"undelete"}])};var r=d(n,this.getUndeleteOptions(t));this.undeleteHandler(r,t)},Object.defineProperty(r.prototype,"readOnly",{get:function(){return this.get_readOnly()},set:function(t){this.set_readOnly(t)},enumerable:!1,configurable:!0}),r.prototype.get_readOnly=function(){return!!this._readonly},r.prototype.set_readOnly=function(t){!!this._readonly!=!!t&&(this._readonly=!!t,this.updateInterface(),this.updateTitle())},r.prototype.getInsertPermission=function(){var t;return null===(t=this.getRowDefinition())||void 0===t?void 0:t.insertPermission},
r.prototype.getUpdatePermission=function(){var t;return null===(t=this.getRowDefinition())||void 0===t?void 0:t.updatePermission},r.prototype.getDeletePermission=function(){var t;return null===(t=this.getRowDefinition())||void 0===t?void 0:t.deletePermission},r.prototype.hasDeletePermission=function(){var e=this.getDeletePermission();return null==e||t.Authorization.hasPermission(e)},r.prototype.hasInsertPermission=function(){var e=this.getInsertPermission();return null==e||t.Authorization.hasPermission(e)},r.prototype.hasUpdatePermission=function(){var e=this.getUpdatePermission();return null==e||t.Authorization.hasPermission(e)},r.prototype.hasSavePermission=function(){return this.isNew()?this.hasInsertPermission():this.hasUpdatePermission()},r.prototype.isViewMode=function(){return this.useViewMode()&&this.isEditMode()&&!this.editClicked},r.prototype.useViewMode=function(){return!1},r.prototype.getFallbackTemplate=function(){
return'<div class="s-DialogContent">\n    <div id="~_Toolbar" class="s-DialogToolbar">\n    </div>\n    <div class="s-Form">\n        <form id="~_Form" action="">\n            <div class="fieldset">\n                <div id="~_PropertyGrid"></div>\n                <div class="clear"></div>\n            </div>\n        </form> \n    </div>\n</div>'},r=o=e.__decorate([t.Decorators.registerClass("Serenity.EntityDialog",[Xi,tr])],r)}(_r);function ta(e){var n=lr.create({type:this,element:function(t){var n=t[0];null!=e.id&&(n.id=e.id),null!=e.name&&n.setAttribute("name",e.name),null!=e.placeholder&&n.setAttribute("placeholder",e.placeholder),null!=e.className?n.className=e.className:null!=e.class&&(n.className=e.class),e.oneWay&&(n.dataset.oneWay="1"),null!=e.maxLength?n.setAttribute("maxLength",e.maxLength||0):null!=e.maxlength&&n.setAttribute("maxLength",e.maxlength||0)}});return null!=e.required&&t.EditorUtils.setRequired(n,e.required),
null!==e.readOnly?t.EditorUtils.setReadOnly(n,e.readOnly):null!==e.readonly&&t.EditorUtils.setReadOnly(n,e.readonly),e.setOptions!=e.setOptions&&t.ReflectionOptionsSetter.set(n,e.setOptions),void 0!==e.value?t.EditorUtils.setValue(n,e.value):null!=e.initialValue&&t.EditorUtils.setValue(n,e.initialValue),null!=e.onChange?n.element.on("change",e.onChange):null!=e.onchange&&n.element.on("change",e.onchange),null!=e.onChangeSelect2&&n.changeSelect2(e.onChangeSelect2),e.ref&&e.ref(n),n.element[0]}t.Reporting=void 0,function(n){var i=function(n){function i(t){var e=n.call(this,t)||this;return t.reportKey&&e.loadReport(t.reportKey),e}return e.__extends(i,n),i.prototype.createPropertyGrid=function(){this.propertyGrid&&(this.byId("PropertyGrid").html("").attr("class",""),this.propertyGrid=null),this.propertyGrid=new Sr(this.byId("PropertyGrid"),{idPrefix:this.idPrefix,useCategories:!0,items:this.propertyItems}).init(null)},i.prototype.loadReport=function(t){var e=this;Pe({
service:"Report/Retrieve",request:{ReportKey:t},onSuccess:function(n){var i;e.reportKey=null!==(i=n.ReportKey)&&void 0!==i?i:t,e.propertyItems=n.Properties||[],e.dialogTitle=n.Title,e.createPropertyGrid();var r=n.InitialSettings;null==r&&(r=new Object),e.propertyGrid.load(r),e.toolbar.findButton("print-preview-button").toggle(!n.IsDataOnlyReport),e.toolbar.findButton("export-pdf-button").toggle(!n.IsDataOnlyReport),e.toolbar.findButton("export-docx-button").toggle(!n.IsDataOnlyReport),e.dialogOpen(null)}})},i.prototype.executeReport=function(t,e){if(this.validateForm()){var n=new Object;this.propertyGrid.save(n),Ee({service:"Report/Execute",request:{ReportKey:this.reportKey,DesignId:"Default",ExportType:e,Parameters:n},target:t})}},i.prototype.getToolbarButtons=function(){var t=this,e=[];return e.push({title:"Önizleme",cssClass:"print-preview-button",onClick:function(){t.executeReport("_blank",null)}}),e.push({title:"PDF",cssClass:"export-pdf-button",onClick:function(){
t.executeReport("","Pdf")}}),e.push({title:"Excel",cssClass:"export-xlsx-button",onClick:function(){t.executeReport("","Xlsx")}}),e.push({title:"Word",cssClass:"export-docx-button",onClick:function(){t.executeReport("","Docx")}}),e},i=e.__decorate([t.Decorators.registerClass("Serenity.Reporting.ReportDialog")],i)}(_r);n.ReportDialog=i;var r=function(n){function r(t){var e=n.call(this,t)||this;$(".report-link").click((function(t){return e.reportLinkClick(t)})),$("div.line").click((function(t){return e.categoryClick(t)}));var i=e;return new lo($("#QuickSearchInput"),{onSearch:function(t,e,n){i.updateMatchFlags(e),n(!0)}}),e}return e.__extends(r,n),r.prototype.updateMatchFlags=function(t){var e=$("#ReportList").find("li").removeClass("non-match");if(null==(t=ht(t)))return e.children("ul").hide(),void e.show().removeClass("expanded");for(var n=t.replace(","," ").split(" "),i=0;i<n.length;i++)n[i]=ht(Select2.util.stripDiacritics(n[i]).toUpperCase());var r=e.filter(".report-item")
;r.each((function(t,e){for(var i,r=$(e),o=Select2.util.stripDiacritics((null!==(i=r.text())&&void 0!==i?i:"").toUpperCase()),a=0;a<n.length;a++){var l=n[a];if(null!=l&&-1===o.indexOf(l)){r.addClass("non-match");break}}}));var o=r.not(".non-match"),a=o.parents("li").add(o);e.not(a).hide().addClass("non-match"),a.show(),a.length<=100&&(e.children("ul").show(),e.addClass("expanded"))},r.prototype.categoryClick=function(t){var e=$(t.target).closest("li");e.hasClass("expanded")?(e.find("ul").hide("fast"),e.removeClass("expanded"),e.find("li").removeClass("expanded")):(e.addClass("expanded"),e.children("ul").show("fast"),1!==e.children("ul").children("li").length||e.children("ul").children("li").hasClass("expanded")||e.children("ul").children("li").children(".line").click())},r.prototype.reportLinkClick=function(t){t.preventDefault(),new i({reportKey:$(t.target).data("key")})},r=e.__decorate([t.Decorators.registerClass("Serenity.Reporting.ReportPage")],r)}(lr);n.ReportPage=r
}(t.Reporting||(t.Reporting={}));var ea,na=function(){function n(){}return n=e.__decorate([t.Decorators.registerClass("Serenity.ScriptContext")],n)}(),ia=function(){function n(){}return n=e.__decorate([t.Decorators.registerInterface("Serenity.IAsyncInit")],n)}();t.WX=void 0,(ea=t.WX||(t.WX={})).getWidget=function(t,e){return t.getWidget(e)},ea.getWidgetName=lr.getWidgetName,ea.hasOriginalEvent=function(t){return!(void 0===t.originalEvent)},ea.change=function(t,e){t.change(e)},ea.changeSelect2=function(t,e){t.changeSelect2(e)},ea.getGridField=function(t){return t.getGridField()};var ra=function(n){function i(e,i){var r,o,a,l,u,c,d,p=this;p=n.call(this,e,i)||this;var h=null!==(r=new google.m)&&void 0!==r?r:s.LatLng(null!==(o=p.options.latitude)&&void 0!==o?o:0,null!==(a=p.options.longitude)&&void 0!==a?a:0),f=new Object;if(f.center=h,f.mapTypeId=null!==(l=p.options.mapTypeId)&&void 0!==l?l:"roadmap",f.zoom=null!==(u=p.options.zoom)&&void 0!==u?u:15,f.zoomControl=!0,
p.map=new google.maps.Map(e[0],f),null!=p.options.markerTitle){var g=new Object,v=p.options.markerLatitude;null==v&&(v=null!==(c=p.options.latitude)&&void 0!==c?c:0);var y=p.options.markerLongitude;null==y&&(y=null!==(d=p.options.longitude)&&void 0!==d?d:0),g.position=new google.maps.LatLng(v,y),g.map=p.map,g.title=p.options.markerTitle,g.animation=2,new google.maps.Marker(g)}return t.LazyLoadHelper.executeOnceWhenShown(e,(function(){google.maps.event.trigger(p.map,"resize",[]),p.map.setCenter(h)})),p}return e.__extends(i,n),i.prototype.get_map=function(){return this.map},i=e.__decorate([t.Decorators.registerEditor("Serenity.GoogleMap",[]),t.Decorators.element("<div/>")],i)}(lr),oa=function(n){function i(e,i){var r=n.call(this,e,i)||this;r.pageSize=50;var o=r.emptyItemText();return null!=o&&e.attr("placeholder",o),e.select2(r.getSelect2Options()),e.attr("type","text"),e.on("change."+r.uniqueName,(function(n,i){
!t.WX.hasOriginalEvent(n)&&i||null!=t.ValidationHelper.getValidator(e)&&e.valid()})),r}return e.__extends(i,n),i.prototype.emptyItemText=function(){var t=this.element.attr("placeholder");return null==t&&(t=vt("Controls.SelectEditor.EmptyItemText")),t},i.prototype.getService=function(){throw new Error("Not implemented!")},i.prototype.query=function(t,e){var n={blockUI:!1,service:this.getService()+"/List",request:t,onSuccess:function(t){e(t)}};this.executeQuery(n)},i.prototype.executeQuery=function(t){Pe(t)},i.prototype.queryByKey=function(t,e){var n={blockUI:!1,service:this.getService()+"/Retrieve",request:{EntityId:t},onSuccess:function(t){e(t.Entity)}};this.executeQueryByKey(n)},i.prototype.executeQueryByKey=function(t){Pe(t)},i.prototype.getItemKey=function(t){return null},i.prototype.getItemText=function(t){return null},i.prototype.getTypeDelay=function(){return 200},i.prototype.getSelect2Options=function(){var t=this,e=this.emptyItemText(),n=0;return{minimumResultsForSearch:10,
placeHolder:at(e)?null:e,allowClear:u(e),query:function(e){var i={ContainsText:ht(e.term),Skip:(e.page-1)*t.pageSize,Take:t.pageSize+1};0!==n&&window.clearTimeout(n);var r=$(t.element).data("select2");r&&r.search&&r.search.removeClass("select2-active").parent().removeClass("select2-active"),n=window.setTimeout((function(){r&&r.search.addClass("select2-active").parent().addClass("select2-active"),t.query(i,(function(n){e.callback({results:n.Entities.slice(0,t.pageSize).map((function(e){return{id:t.getItemKey(e),text:t.getItemText(e),source:e}})),more:n.Entities.length>=t.pageSize})}))}),t.getTypeDelay())},initSelection:function(e,n){var i=e.val();at(i)?n(null):t.queryByKey(i,(function(e){n(null==e?null:{id:t.getItemKey(e),text:t.getItemText(e),source:e})}))}}},i.prototype.addInplaceCreate=function(t){var e=this;$("<a><b/></a>").addClass("inplace-button inplace-create").attr("title",t).insertAfter(this.element).click((function(t){e.inplaceCreateClick(t)})),
this.get_select2Container().add(this.element).addClass("has-inplace-button")},i.prototype.inplaceCreateClick=function(t){},i.prototype.get_select2Container=function(){return this.element.prevAll(".select2-container")},i.prototype.get_value=function(){return I(this.element.select2("val"),String)},Object.defineProperty(i.prototype,"value",{get:function(){return this.get_value()},set:function(t){this.set_value(t)},enumerable:!1,configurable:!0}),i.prototype.set_value=function(t){if(t!==this.get_value()){var e=this.element;e.select2("val",t),e.data("select2-change-triggered",!0);try{e.triggerHandler("change",[!0])}finally{e.data("select2-change-triggered",!1)}}},i=e.__decorate([t.Decorators.registerEditor("Serenity.Select2AjaxEditor",[nr]),t.Decorators.element('<input type="hidden" />')],i)}(lr);t.ArgumentNullException=it,t.BaseEditorFiltering=fo,t.BaseFiltering=po,t.BooleanEditor=Fr,t.BooleanFiltering=vo,t.BooleanFormatter=Ao,t.CascadedWidgetLink=Cr,t.CategoryAttribute=di,
t.CheckLookupEditor=Jo,t.CheckTreeEditor=Yo,t.CheckboxFormatter=No,t.ColumnPickerDialog=Ko,t.ColumnsBase=Uo,t.ColumnsKeyAttribute=pi,t.Config=Gt,t.Criteria=ai,t.CriteriaBuilder=Zn,t.CssClassAttribute=hi,t.Culture=Re,t.DataGrid=Wo,t.DateEditor=Ar,t.DateFiltering=go,t.DateFormatter=Mo,t.DateTimeEditor=Mr,t.DateTimeFiltering=yo,t.DateTimeFormatter=Ro,t.DateYearEditor=zr,t.DecimalEditor=Pr,t.DecimalFiltering=mo,t.DefaultValueAttribute=fi,t.DialogTypeAttribute=gi,t.DisplayNameAttribute=ci,t.EditorAttribute=tt,t.EditorFiltering=_o,t.EditorOptionAttribute=vi,t.EditorTypeAttribute=mi,t.EditorTypeAttributeBase=yi,t.ElementAttribute=_i,t.EmailAddressEditor=Lr,t.EmailEditor=Br,t.EntityDialog=Zo,t.EntityGrid=Xo,t.EntityTypeAttribute=bi,t.EnumEditor=jr,t.EnumFiltering=bo,t.EnumFormatter=Bo,t.EnumKeyAttribute=ui,t.Exception=nt,t.FileDownloadFormatter=Lo,t.FileUploadEditor=no,t.FilterDialog=Fo,t.FilterDisplayBar=Po,t.FilterPanel=Do,t.FilterStore=so,t.FilterWidgetBase=xo,t.FilterableAttribute=Ci,
t.Flexify=vr,t.FlexifyAttribute=wi,t.FormKeyAttribute=Si,t.GeneratedCodeAttribute=ki,t.GoogleMap=ra,t.GridRadioSelectionMixin=jo,t.GridRowSelectionMixin=zo,t.HiddenAttribute=xi,t.HintAttribute=Ii,t.HtmlContentEditor=Yr,t.HtmlNoteContentEditor=Jr,t.HtmlReportContentEditor=Xr,t.IAsyncInit=ia,t.IBooleanValue=Qi,t.IDialog=Ji,t.IDoubleValue=Yi,t.IEditDialog=Xi,t.IFiltering=uo,t.IGetEditValue=Zi,t.IInitializeColumn=Eo,t.IQuickFiltering=co,t.IReadOnly=tr,t.ISetEditValue=er,t.ISlickFormatter=Z,t.IStringValue=nr,t.IValidateRequired=ir,t.IdPropertyAttribute=Ti,t.ImageUploadEditor=io,t.InsertableAttribute=Di,t.IntegerEditor=Or,t.IntegerFiltering=Co,t.InvalidCastException=rt,t.Invariant=Ne,t.IsActivePropertyAttribute=Fi,t.ItemNameAttribute=Pi,t.LT=Ct,t.LocalTextPrefixAttribute=Oi,t.Lookup=Ln,t.LookupEditor=Wr,t.LookupEditorBase=Ur,t.LookupFiltering=wo,t.MaskedEditor=Zr,t.MaxLengthAttribute=Ai,t.MaximizableAttribute=Ei,t.MinuteFormatter=$o,t.MultipleFileUploadEditor=ro,
t.MultipleImageUploadEditor=oo,t.NamePropertyAttribute=Ni,t.NumberFormatter=Vo,t.OneWayAttribute=Mi,t.OptionAttribute=Ri,t.OptionsTypeAttribute=Bi,t.PanelAttribute=Li,t.PasswordEditor=Tr,t.PlaceholderAttribute=$i,t.PopupMenuButton=ur,t.PopupToolButton=cr,t.PrefixedContext=sr,t.PropertyDialog=xr,t.PropertyGrid=Sr,t.PropertyPanel=kr,t.QuickFilterBar=ao,t.QuickSearchInput=lo,t.RadioButtonEditor=Vr,t.ReadOnlyAttribute=Vi,t.Recaptcha=to,t.RemoteView=li,t.RequiredAttribute=qi,t.ResizableAttribute=Hi,t.ResponsiveAttribute=Gi,t.ScriptContext=na,t.Select2AjaxEditor=oa,t.Select2Editor=Hr,t.SelectEditor=Gr,t.ServiceAttribute=zi,t.ServiceLookupEditor=Qr,t.ServiceLookupEditorBase=Kr,t.ServiceLookupFiltering=So,t.SlickPager=Oo,t.StringEditor=Ir,t.StringFiltering=ko,t.TemplatedDialog=_r,t.TemplatedPanel=br,t.TemplatedWidget=pr,t.TextAreaEditor=Dr,t.TimeEditor=Rr,t.Toastr=Nt,t.Toolbar=dr,t.TreeGridMixin=Qo,t.URLEditor=$r,t.UpdatableAttribute=ji,t.UrlFormatter=qo,t.Widget=lr,t.addAttribute=X,
t.addEmptyOption=function(t){kt(t,"",vt("Controls.SelectEditor.EmptyItemText"))},t.addOption=kt,t.addTypeMember=O,t.addValidationRule=Kn,t.alert=pe,t.alertDialog=de,t.any=i,t.attrEncode=xt,t.baseValidateOptions=Wn,t.blockUI=Te,t.blockUndo=De,t.bsModalMarkup=re,t.canLoadScriptData=wn,t.cast=T,t.centerDialog=Nn,t.clearKeys=A,t.clearOptions=function(t){t.html("")},t.closePanel=Se,t.coalesce=function(t,e){return null!=t?t:e},t.compareStringFactory=Me,t.confirm=fe,t.confirmDialog=he,t.count=function(t,e){for(var n=0,i=0,r=t;i<r.length;i++){e(r[i])&&n++}return n},t.datePickerIconSvg=Er,t.dbText=function(t){return function(e){return vt("Db."+t+"."+e)}},t.dbTryText=function(t){return function(e){return vt("Db."+t+"."+e)}},t.debounce=Tn,t.deepClone=p,t.defaultNotifyOptions=Rt,t.delegateCombine=N,t.delegateRemove=q,t.dialogButtonToBS=oe,t.dialogButtonToUI=ae,t.endsWith=ot,t.executeEverytimeWhenVisible=Fn,t.executeOnceWhenVisible=Dn,t.extend=d,t.fieldsProxy=function(){return z},
t.findElementWithRelativeId=It,t.first=function(t,e){for(var n=0,i=t;n<i.length;n++){var r=i[n];if(e(r))return r}throw new Error("first:No element satisfies the condition.!")},t.format=qe,t.formatDate=Qe,t.formatDayHourAndMin=function(t){if(null==t)return"";if(0===t)return"0";var e=Math.floor(t/24/60),n="";e>0&&(n+=e.toString());var i=gt(Math.floor(t%1440/60),2)+":"+gt(t%60,2);return"00:00"!=i&&(e>0&&(n+="."),n+=i),n},t.formatISODateTimeUTC=Ye,t.formatNumber=ze,t.getAttributes=F,t.getBaseType=D,t.getColumns=pn,t.getColumnsAsync=fn,t.getColumnsData=hn,t.getColumnsDataAsync=gn,t.getCookie=Fe,t.getForm=vn,t.getFormAsync=mn,t.getFormData=yn,t.getFormDataAsync=_n,t.getGlobalThis=y,t.getHighlightTarget=Un,t.getInstanceType=S,t.getLookup=sn,t.getLookupAsync=un,t.getMembers=P,t.getNested=f,t.getRemoteData=an,t.getRemoteDataAsync=ln,t.getStateStore=B,t.getTemplate=bn,t.getTemplateAsync=Cn,t.getType=m,t.getTypeFullName=C,t.getTypeNameProp=_,t.getTypeShortName=w,t.getTypes=E,
t.groupBy=function(t,e){for(var n,i={byKey:Object.create(null),inOrder:[]},r=0;r<t.length;r++){var o=t[r],a=null!==(n=e(o))&&void 0!==n?n:"",l=i.byKey[a];void 0===l?(l={order:i.inOrder.length,key:a,items:[o],start:r},i.byKey[a]=l,i.inOrder.push(l)):l.items.push(o)}return i},t.htmlEncode=Ft,t.iframeDialog=ge,t.indexOf=r,t.information=ye,t.informationDialog=ve,t.initFormType=function(t,e){for(var n=0;n<e.length-1;n+=2)!function(e,n){Object.defineProperty(t.prototype,e,{get:function(){return this.w(e,n)},enumerable:!0,configurable:!0})}(e[n],e[n+1])},t.initFullHeightGridPage=function(e,n){var i,r,o,a=St&&e instanceof St?e.get(0):e;document.documentElement.classList.add("full-height-page"),a.classList.add("responsive-height");var l=null!==(i=null==n?void 0:n.setHeight)&&void 0!==i?i:St&&!a.classList.contains("s-DataGrid")&&!a.classList.contains("s-Panel"),s=function(){l&&On(St(a)),St?St(a).triggerHandler("layout"):a.dispatchEvent(new Event("layout"))}
;document.body.classList.contains("has-layout-event")?St?St(document.body).on("layout",s):a.addEventListener("layout",s):(null===(r=window.Metronic)||void 0===r?void 0:r.addResizeHandler)?window.Metronic.addResizeHandler(s):St?St(window).resize(s):window.addEventListener("resize",s),s(),St&&St(a).one("remove",(function(){St(window).off("resize",s),St("body").off("layout",s)})),(null==n?void 0:n.noRoute)||"undefined"==typeof document||St(document.body).attr("data-fhrouteinit")||(St(document.body).attr("data-fhrouteinit","true"),void 0!==t.Router&&(null===(o=t.Router.resolve)||void 0===o||o.call(t.Router)))},t.initializeTypes=et,t.insert=function(t,e,n){if(t.insert)t.insert(e,n);else{if(!Array.isArray(t))throw new Error("Object does not support insert!");t.splice(e,0,n)}},t.isArray=o,t.isAssignableFrom=k,t.isBS3=Zt,t.isBS5Plus=te,t.isEmptyOrNull=at,t.isEnum=H,t.isInstanceOfType=x,t.isMobileView=En,t.isTrimmedEmpty=lt,t.isValue=u,t.jsxDomWidget=function(t){return ta.bind(t)},
t.keyOf=function(t){return t},t.layoutFillHeight=On,t.layoutFillHeightValue=Pn,t.loadValidationErrorMessages=zn,t.localText=vt,t.localeFormat=function(t,e){return Ve(e,t,arguments,2)},t.newBodyDiv=Pt,t.notifyError=qt,t.notifyInfo=function(t,e,n){Lt("info",t,e,Bt(n))},t.notifySuccess=Vt,t.notifyWarning=$t,t.openPanel=ke,t.outerHtml=function(t){return St("<i/>").append(t.eq(0).clone()).html()},t.padLeft=st,t.parseCriteria=oi,t.parseDate=en,t.parseDayHourAndMin=tn,t.parseDecimal=Ue,t.parseHourAndMin=Ze,t.parseISODateTime=Xe,t.parseInteger=je,t.parseQueryString=function(t){for(var e={},n=(void 0===t?location.search.substring(1,location.search.length):t||"").split("&"),i=0;i<n.length;i++){var r=n[i].split("="),o=decodeURIComponent(r[0]);e[o]=r.length>=2?decodeURIComponent(r[1]):o}return e},t.positionToastContainer=Ht,t.postToService=Ee,t.postToUrl=function(t){var e=$("<form/>").attr("method","POST").attr("action",Ae(t.url)).appendTo(document.body);t.target&&e.attr("target",t.target)
;var n=$("<div/>").appendTo(e);if(null!=t.params)for(var i in t.params)$("<input/>").attr("type","hidden").attr("name",i).val(t.params[i]).appendTo(n);var r=Fe("CSRF-TOKEN");r&&$("<input/>").attr("type","hidden").attr("name","__RequestVerificationToken").appendTo(n).val(r),$("<input/>").attr("type","submit").appendTo(n),e.submit(),window.setTimeout((function(){e.remove()}),0)},t.prefixedText=function(t){return function(e,n){if(null!=e&&!ut(e,"`")){var i=_t(e);if(null!=i)return i}if(null!=e&&ut(e,"`")&&(e=e.substr(1)),!at(t)){var r=_t("function"==typeof n?n(t):t+n);if(null!=r)return r}return e}},t.prop=function(t,e,n,i){n=n||"get_"+e,i=i||"set_"+e,Object.defineProperty(t.prototype,e,{get:function(){return this[n]()},set:function(t){return this[i](t)},configurable:!0,enumerable:!0})},t.proxyTexts=function t(e,n,i){if("undefined"!=typeof window&&window.Proxy)return new window.Proxy(e,{get:function(r,o){var a=i[o];if(null==a)return vt(n+o);var l=e[o]
;return null!=l||(e[o]=l=t({},n+o+".",a)),l},ownKeys:function(t){return Object.keys(i)}});for(var r=0,o=Object.keys(i);r<o.length;r++){var a=o[r];"number"==typeof i[a]?Object.defineProperty(e,a,{get:function(){return vt(n+a)}}):e[a]=t({},n+a+".",i[a])}return e},t.reactPatch=or,t.registerClass=K,t.registerEditor=Q,t.registerEnum=Y,t.registerInterface=J,t.reloadLookup=cn,t.reloadLookupAsync=dn,t.removeValidationRule=function(t,e){return t.unbind("customValidate."+e),t},t.replaceAll=ft,t.resolveUrl=Ae,t.round=He,t.safeCast=I,t.serviceCall=Pe,t.serviceRequest=function(t,e,n,i){return Pe(d({service:t,request:e,onSuccess:n},i))},t.setEquality=Oe,t.setTypeNameProp=b,t.single=function(t,e){for(var n,i=!1,r=0,o=t;r<o.length;r++){var a=o[r];if(e(a)){if(i)throw new Error("single:sequence contains more than one element.");i=!0,n=a}}if(!i)throw new Error("single:No element satisfies the condition.");return n},t.splitDateString=nn,t.startsWith=ut,t.success=_e,t.successDialog=me,t.text=yt,
t.toGrouping=a,t.toId=We,t.toSingleLine=function(t){return ft(ft(pt(t),"\r\n"," "),"\n"," ").trim()},t.today=c,t.toggleClass=Ot,t.triggerLayoutOnShow=function(t){Fn(t,(function(){t.triggerHandler("layout")}),!0)},t.trim=dt,t.trimEnd=ct,t.trimStart=function(t){var e,n,i;return null!==(i=null===(n=(e=null!=t?t:"").trimStart)||void 0===n?void 0:n.call(e))&&void 0!==i?i:t.replace(/^\s*/,"")},t.trimToEmpty=pt,t.trimToNull=ht,t.trunc=Ge,t.tryFirst=l,t.tryGetText=_t,t.turkishLocaleCompare=Be,t.turkishLocaleToLower=function(t){return t?t.replace(/i/g,"İ").replace(/ı/g,"I").toLowerCase():t},t.turkishLocaleToUpper=function(t){return t?t.replace(/i/g,"İ").replace(/ı/g,"I").toUpperCase():t},t.useIdPrefix=hr,t.validateForm=function(t,e){return t.validate(d(Wn(),e))},t.validateOptions=Xn,t.validatorAbortHandler=Jn,t.warning=we,t.warningDialog=be,t.zeroPad=gt,Object.defineProperty(t,"__esModule",{value:!0})}(this.Serenity=this.Serenity||{},this.window||this,this.Slick=this.Slick||{}),function(t){
t.Q?t.Q!==t.Serenity&&(Object.keys(t.Q).forEach((function(e){null!=t.Q[e]&&null==t.Serenity[e]&&(t.Serenity[e]=t.Q[e])})),t.Q=t.Serenity):t.Q=t.Serenity,t.Slick=t.Slick||{},["Aggregators","AggregateFormatting"].forEach((function(e){t.Slick[e]=t.Slick[e]||{},Object.assign(t.Slick[e],Serenity[e])})),["RemoteView"].forEach((function(e){t.Slick[e]=Serenity[e]}))}(this);
//# sourceMappingURL=Serenity.CoreLib.min.js.map