import{c as i,e as c,f as h,g as d}from"../../_chunks/chunk-ATNGMF2N.js";var l=c(d(),1),m=c(d(),1);var p=c(d(),1),g=c(d(),1);var s=c(d(),1);var x;(r=>{function f(t){return{title:(0,s.coalesce)(t.title,"Report"),cssClass:(0,s.coalesce)(t.cssClass,"print-button"),icon:t.icon,onClick:()=>{r.execute(t)}}}r.createToolButton=f,i(f,"createToolButton");function e(t){var o=t.getParams?t.getParams():t.params;(0,s.postToUrl)({url:"~/Serenity.Extensions/Report/"+(t.download?"Download":"Render"),params:{key:t.reportKey,ext:(0,s.coalesce)(t.extension,"pdf"),opt:o?$.toJSON(o):""},target:(0,s.coalesce)(t.target,"_blank")})}r.execute=e,i(e,"execute")})(x||(x={}));var a=class extends p.TemplatedDialog{constructor(r){super(r);this.updateInterface(),this.loadReport(this.options.reportKey)}getDialogButtons(){return null}createPropertyGrid(){this.propertyGrid&&this.byId("PropertyGrid").html("").attr("class",""),this.propertyGrid=new p.PropertyGrid(this.byId("PropertyGrid"),{idPrefix:this.idPrefix,useCategories:!0,items:this.report.Properties}).init(null)}loadReport(r){(0,g.serviceCall)({url:(0,g.resolveUrl)("~/Serenity.Extensions/Report/Retrieve"),request:{ReportKey:r},onSuccess:t=>{this.report=t,this.dialogTitle=this.report.Title,this.createPropertyGrid(),this.propertyGrid.load(this.report.InitialSettings||{}),this.updateInterface(),this.dialogOpen()}})}updateInterface(){this.toolbar.findButton("print-preview-button").toggle(this.report&&!this.report.IsDataOnlyReport&&!this.report.IsExternalReport),this.toolbar.findButton("run-button").toggle(this.report&&this.report.IsExternalReport),this.toolbar.findButton("export-pdf-button").toggle(this.report&&!this.report.IsDataOnlyReport&&!this.report.IsExternalReport),this.toolbar.findButton("export-xlsx-button").toggle(this.report&&this.report.IsDataOnlyReport&&!this.report.IsExternalReport)}executeReport(r,t,o){if(this.validateForm()){var n={};this.propertyGrid.save(n),x.execute({download:o,reportKey:this.report.ReportKey,extension:t,target:r,params:n})}}getToolbarButtons(){return[{title:"Preview",cssClass:"print-preview-button",onClick:()=>this.executeReport("_blank",null,!1)},{title:"Run",cssClass:"run-button",icon:"fa-print text-blue",onClick:()=>this.executeReport("_blank",null,!1)},{title:"PDF",cssClass:"export-pdf-button",onClick:()=>this.executeReport("_blank","pdf",!0)},{title:"Excel",cssClass:"export-xlsx-button",onClick:()=>this.executeReport("_blank","xlsx",!0)}]}getTemplate(){return`<div class="s-DialogContent">
<div id="~_Toolbar" class="s-DialogToolbar">
</div>
<div class="s-Form">
    <form id="~_Form" action="">
        <div class="fieldset ui-widget ui-widget-content ui-corner-all">
            <div id="~_PropertyGrid"></div>
            <div class="clear"></div>
        </div>
    </form>
</div>
</div>`}};i(a,"ReportDialog"),a=h([p.Decorators.registerClass("Serenity.Extensions.ReportDialog")],a);var u=class extends l.Widget{constructor(e){super(e),$(".report-link",e).click(r=>this.reportLinkClick(r)),new l.QuickSearchInput($(".s-QuickSearchBar input",e),{onSearch:(r,t,o)=>{this.updateMatchFlags(t),o(!0)}})}updateMatchFlags(e){var r=$(".report-list",this.element).find("li").removeClass("non-match");if(e=(0,m.trimToNull)(e),!!e){e=Select2.util.stripDiacritics(e).toUpperCase();var t=r.filter(".report-item");t.each(function(C,R){var v=$(R),b=Select2.util.stripDiacritics((0,m.coalesce)(v.text(),"").toUpperCase());b.indexOf(e)<0&&v.addClass("non-match")});var o=t.not(".non-match"),n=o.parents("li").add(o);n.children("[data-bs-toggle]:not([aria-expanded=true])").attr("aria-expanded","true").removeClass("collapsed"),n.parent(".collapse:not(.show)").addClass("show");var y=r.not(n);y.addClass("non-match")}}reportLinkClick(e){e.preventDefault(),new a({reportKey:$(e.target).data("key")}).dialogOpen()}};i(u,"ReportPage"),u=h([l.Decorators.registerClass("Serenity.Extensions.ReportPage")],u);export{u as ReportPage};
//# sourceMappingURL=ReportPage.js.map
